$("input.add_pane").on("change",function(){var c=$(this).attr("id").split("_")[2];var a={};a.backdrop="static";$(".adding_pane_modal").modal(a);var d=pathname;var b=pathname.split("right");if(b.length>1){d=b[0]}$.ajax({url:d+"right/add/"+c,type:"GET",success:function(e){console.log(e);setTimeout(function(){location=d+"right/"+e.template+"/"+e.id+"#config"},PANE_DELAY)},error:function(f,e){$(".adding_pane_modal").modal("hide");alert(lang.error_add_pane+": "+e)}})});var PANE_DELAY=3000;$(".delete_pane").on("click",function(f){f.preventDefault();var d=$(this).attr("id").split("_")[2];if(confirm($(this).attr("data-confirm"))){var a={};a.backdrop="static";$(".deleting_pane_modal").modal(a);var c=pathname;var b=pathname.split("right");if(b.length>1){c=b[0]}$.ajax({url:c+"right/delete/"+d,type:"GET",success:function(e){setTimeout(function(){location=c+"right/"},PANE_DELAY)},error:function(g,e){$(".deleting_pane_modal").modal("hide");alert(lang.error_delete_pane+": "+e)}})}});$(".pane-chooser .sortable").sortable({cursor:"pointer",update:sort_panes});function sort_panes(d,e){var a=$(".pane-chooser .sortable").sortable("toArray");for(var c=0;c<a.length;c++){a[c]=a[c].split("_")[1]}var f="";var b=pathname.split("right");if(b.length>1){f=b[0]+"right/sort"}$.ajax({url:f,type:"POST",data:{order:a},success:function(){},error:function(){}})}$(".turtle-chooser .draggable").draggable({revert:true,helper:function(a){helper=$(a.target).clone();helper.css("padding","30px");helper.css("min-width","100px");helper.css("line-height","0px");helper.css("display","block");return helper},stack:".turtle-chooser .turtle",connectToSortable:".turtle-area.sortable"});var current_pane_id=0;$("#pane-selector li").on("click",function(b){var a=$(this).attr("id").split("_")[1];if(!$(this).hasClass("active")){$("#pane-selector li").removeClass("active");$(this).addClass("active");$(".turtle-area").fadeOut(0);$("#pane_"+a).fadeIn();current_pane_id=a}});function bind_event_to_turtles(){$(".delijn-location").off().on("keydown.autocomplete",function(){$(this).autocomplete({minLength:4,source:function(d,c){$.ajax({url:"https://data.irail.be/DeLijn/Stations.json",type:"GET",dataType:"json",data:{name:d.term},success:function(g){if(g.Stations){var h={};for(var e in g.Stations){var f=g.Stations[e].name.camelcase();h[f]=true}c($.map(h,function(l,k){return{label:k,value:k}}))}}})}})});$(".nmbs-location").off().on("keydown.autocomplete",function(){$(this).autocomplete({minLength:3,source:function(d,c){$.ajax({url:"https://data.irail.be/NMBS/Stations.json",type:"GET",dataType:"json",data:{name:d.term},success:function(f){var e=new RegExp(d.term.toLowerCase());c($.map(f.Stations,function(g){if(g.name.toLowerCase().match(e)){return{label:g.name,value:g.name}}}))}})}})});function a(c){return c.split(/,\s*/)}function b(c){return a(c).pop()}$(".nmbs-via").off().on("keydown.autocomplete",function(){$(this).autocomplete({source:function(d,c){$.ajax({url:"https://data.irail.be/NMBS/Stations.json",type:"GET",dataType:"json",data:{name:b(d.term)},success:function(f){var e=new RegExp(b(d.term.toLowerCase()));c($.map(f.Stations,function(g){if(g.name.toLowerCase().match(e)){return{label:g.name,value:g.name}}}))}})},focus:function(d,e){var c=a(this.value);if(c[c.length-1]==""){c.pop()}c.pop();c.push(e.item.value);c.push("");this.value=c.join(", ");return false},select:function(d,e){var c=a(this.value);if(c[c.length-1]==""){c.pop()}c.pop();c.push(e.item.value);c.push("");this.value=c.join(", ");return false}})});$(".mivb-location").off().on("keydown.autocomplete",function(){$(this).autocomplete({minLength:3,source:function(d,c){$.ajax({url:"https://data.irail.be/MIVBSTIB/Stations.json",type:"GET",dataType:"json",data:{name:d.term},success:function(g){if(g.Stations){var h={};for(var e in g.Stations){var f=g.Stations[e].name.camelcase();h[f]=true}c($.map(h,function(l,k){return{label:k,value:k}}))}}})}})});$(".velo-name").off().on("keydown.autocomplete",function(){var c=$(this);$(this).autocomplete({minLength:3,autoFocus:true,autoSelect:true,source:function(e,d){$.ajax({url:"https://data.irail.be/Bikes/Velo.json",type:"GET",dataType:"json",data:{name:e.term},success:function(g){var f=new RegExp(e.term.toLowerCase());d($.map(g.Velo,function(h){if(h.name.toLowerCase().match(f)){return{label:h.name,value:h.name,location:h.latitude+","+h.longitude}}}))}})},select:function(f,d){$(".velo-location",c.parents(".turtle_instance")).val(d.item.location)},change:function(f,d){if(!d.item){c.val("")}}})});$(".villo-name").off().on("keydown.autocomplete",function(){var c=$(this);$(this).autocomplete({minLength:3,autoFocus:true,autoSelect:true,source:function(e,d){$.ajax({url:"https://data.irail.be/Bikes/Villo.json",type:"GET",dataType:"json",data:{name:e.term},success:function(g){var f=new RegExp(e.term.toLowerCase());d($.map(g.Villo,function(k){k.name=k.name.toLowerCase();var h=k.name.match(/^[0-9]+\s*-\s*((.*?)(?:[\/|:](.*))?)$/);console.log(h);if(h[1].match(f)){return{label:h[1].camelcase(),value:h[1].camelcase(),location:k.latitude+","+k.longitude}}}))}})},select:function(f,d){$(".villo-location",c.parents(".turtle_instance")).val(d.item.location)},change:function(f,d){if(!d.item){c.val("")}}})});$(".turtle_instance .title").off().on("click",function(){try{$(".autocomplete").autocomplete("close")}catch(c){}$(".edit_area",$(this).parent()).slideToggle(200)});$(".turtle_instance form").off().on("submit",function(c){c.preventDefault();$(".turtle_save",$(this)).click()});$(".turtle_instance .turtle_save").off().on("click",function(m){m.preventDefault();$(this).focus();var g=$(this).parents(".turtle_instance");var f=$(this);if(f.attr("disabled")!="disabled"){f.attr("disabled","disabled").addClass("disable");$(".loading",g).animate({opacity:1},200);var k=g.attr("id").split("_")[1];var d=new Object();var c=$("form :input",g);c.each(function(){if($(this).attr("name")){var e=$(this).attr("name").split(k+"-")[1];if(e){d[e]=$(this).val()}}});if(g.hasClass("turtle_mapbox")&&d.name!=""){$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?address="+encodeURIComponent(d.name)+"&sensor=false",type:"GET",success:function(n){if(n.results.length>0){var e=n.results[0].geometry.location;if(typeof e!="undefined"){d.location=e.lat+","+e.lng;updateTurtle(g,f,k,d)}}else{alert(lang.error_resolve_address);$(".loading",g).animate({opacity:0},200);f.removeAttr("disabled").removeClass("disable")}},error:function(n,e){alert(lang.error_resolve_address);$(".loading",g).animate({opacity:0},200);f.removeAttr("disabled").removeClass("disable")}})}else{if((g.hasClass("turtle_villo")|g.hasClass("turtle_velo"))&&d.location!=""){calculateWalkTime(d.location,g,f,k,d)}else{if(g.hasClass("turtle_nmbs")&&d.location!=""){$.ajax({url:"https://data.irail.be/NMBS/Stations.json",type:"GET",success:function(o){var n=new RegExp("^"+d.location.toLowerCase()+"$");var e=null;$.map(o.Stations,function(p){if(p.name.toLowerCase().match(n)){e=p.latitude+","+p.longitude}});if(e!=null){calculateWalkTime(e,g,f,k,d)}else{d.time_walk=-1;updateTurtle(g,f,k,d)}},error:function(n,e){d.time_walk=-1;updateTurtle(g,f,k,d)}})}else{if(g.hasClass("turtle_delijn")&&d.location!=""){$.ajax({url:"https://data.irail.be/DeLijn/Stations.json",type:"GET",dataType:"json",data:{name:d.location.toLowerCase()},success:function(o){var n=new RegExp(d.location.toLowerCase());var e=null;$.map(o.Stations,function(p){if(p.name.toLowerCase().match(n)){e=p.latitude+","+p.longitude}});if(e!=null){calculateWalkTime(e,g,f,k,d)}else{d.time_walk=-1;updateTurtle(g,f,k,d)}},error:function(n,e){d.time_walk=-1;updateTurtle(g,f,k,d)}})}else{if(g.hasClass("turtle_mivb")&&d.location!=""){$.ajax({url:"https://data.irail.be/MIVBSTIB/Stations.json",type:"GET",dataType:"json",data:{name:d.location.toLowerCase()},success:function(o){var n=new RegExp(d.location.toLowerCase());var e=null;$.map(o.Stations,function(p){if(p.name.toLowerCase().match(n)){e=p.latitude+","+p.longitude}});if(e!=null){calculateWalkTime(e,g,f,k,d)}else{d.time_walk=-1;updateTurtle(g,f,k,d)}},error:function(n,e){d.time_walk=-1;updateTurtle(g,f,k,d)}})}else{if(g.hasClass("turtle_navitia")&&d.location!=""&&d.region!=""){var l="application/json;charset=UTF-8";$.ajax({url:"https://data.flatturtle.com/navitia_proxy.php?https://api.navitia.io/v1/coverage/"+d.region+"/places?q="+d.location+"&type[]=stop_area&count=1",type:"GET",datatype:"x-javascript",beforeSend:function(e){if(e&&e.overrideMimeType){e.overrideMimeType(l)}},success:function(n){var e=null;if(typeof n.contents.places[0].stop_area.coord!=="undefined"){e=n.contents.places[0].stop_area.coord.lat+","+n.contents.places[0].stop_area.coord.lon}if(e!=null){calculateWalkTime(e,g,f,k,d)}else{d.time_walk=-1;updateTurtle(g,f,k,d)}},error:function(n,e){d.time_walk=-1;updateTurtle(g,f,k,d)}})}else{if(g.hasClass("turtle_rss")&&d.feed!=""){var h=new RegExp("^http(s?)://");if(!h.test(d.feed)){d.feed="http://"+d.feed}updateTurtle(g,f,k,d)}else{if(g.hasClass("turtle_signage")){d.data=saveSignage(g);updateTurtle(g,f,k,d)}else{if(g.hasClass("turtle_pricelist")){d.data=savePriceList(g);updateTurtle(g,f,k,d)}else{if(g.hasClass("turtle_weekmenu")){d.data=saveWeekMenu(g);updateTurtle(g,f,k,d)}else{if(g.hasClass("turtle_offers")){d.data=saveOffers(g);updateTurtle(g,f,k,d)}else{if(g.hasClass("turtle_image")){d.urls=saveSlideshow(g);updateTurtle(g,f,k,d)}else{updateTurtle(g,f,k,d)}}}}}}}}}}}}}});$(".turtle_instance .delete").off().on("click",function(f){f.preventDefault();if(confirm(lang.turtle_delete_note)){var c=$(this).parents(".turtle_instance");var d=c.attr("id").split("_")[1];$(this).off();$.ajax({url:pathname+"/delete",type:"POST",data:{id:d},success:function(e){c.slideUp(300,function(){c.remove()})},error:function(g,e){alert(lang.error_delete_turtle+": "+e)}})}});$(".turtle_rss .rss-feed-type").off().on("change",function(f){var c=$(f.target).parents(".turtle_rss");var d=$(f.target).val();if(d=="custom"){$(".rss-feed",c).val("").fadeIn()}else{$(".rss-feed",c).hide().val(d)}});$(".turtle_instance .make-larger").off().on("click",function(){$(".turtle_instance .size-field").val("");if($(this).is(":checked")){$(".turtle_instance .size-field").val("big")}});$(".turtle_instance .nodescription").off().on("click",function(){$(".turtle_instance .nodescription-field").val("0");if($(this).is(":checked")){$(".turtle_instance .nodescription-field").val("1")}});$(".turtle_instance .removeempty").off().on("click",function(){$(".turtle_instance .removeempty-field").val("0");if($(this).is(":checked")){$(".turtle_instance .removeempty-field").val("1")}});$(".turtle_map .map-location-type").off().on("change",changedMapType);$(".turtle_mapbox .map-location-type").off().on("change",changedMapType)}if($(".turtle_instance .size-field").val()=="big"){$(".turtle_instance .make-larger").attr("checked","checked")}if($(".turtle_instance .nodescription-field").val()=="1"){$(".turtle_instance .nodescription").attr("checked","checked")}if($(".turtle_instance .removeempty-field").val()=="1"){$(".turtle_instance .removeempty").attr("checked","checked")}function calculateWalkTime(e,c,b,d,a){if(from.hasOwnProperty("lat")&&from.hasOwnProperty("lon")){$.ajax({url:"https://data.flatturtle.com/Geo/Distance/"+from.lat+","+from.lon+"/"+e+".json",type:"GET",success:function(g){if(g.Distance.rows[0].elements[0].duration!=null){var f=g.Distance.rows[0].elements[0].duration;if(typeof f!="undefined"){a.time_walk=f.value/60;updateTurtle(c,b,d,a)}}else{alert(lang.error_resolve_time_walk);a.time_walk=-1;updateTurtle(c,b,d,a)}},error:function(g,f){alert(lang.error_resolve_time_walk);a.time_walk=-1;updateTurtle(c,b,d,a)}})}else{a.time_walk=-1;updateTurtle(c,b,d,a)}}function changedMapType(c){var a=$(c.target).parents(".turtle_instance");var b=$(c.target).val();console.log("j");if(b=="custom"){$(".location",a).val("").fadeIn()}else{$(".location",a).hide().val("")}}function updateTurtle(d,c,e,a){var f=pathname;var b=pathname.split("right");if(b.length>1){f=b[0]+"left"}$.ajax({url:f+"/update",type:"POST",data:{id:e,options:a},success:function(g){$(".loading",d).animate({opacity:0},200);c.removeAttr("disabled").removeClass("disable")},error:function(h,g){alert(lang.error_save+": "+g);$(".loading",d).animate({opacity:0},200);c.removeAttr("disabled").removeClass("disable")}})}bind_event_to_turtles();$("#slide-sorter").sortable().disableSelection();function buildImage(d,a){if(d&&d!=""){var e=JSON.parse(d);var b=$("#slide-sorter",a);for(var c in e){b.append(createSlide(e[c]))}}bindImageEvents()}function createSlide(d){var c=d.split("/");var e=c[c.length-1];var h=e.split("-")[0];var b=$("<li class='slide' data-id='"+h+"'></li>");var g=$("<div class='header'></div>");var f=$("<a href='#' class='btn remove-slide'>x</a>");g.append(f);b.append(g);var a=$("<img src='"+d+"'/> ");b.append(a);return b}function saveSlideshow(a){var b=[];$("#slide-sorter .slide",a).each(function(){var c=$(this).find("img").attr("src");b.push(c)});return JSON.stringify(b)}function clearUploadModal(){var f=$("#portrait");var e=$("#landscape");var b=$("#tall");f.find(".content .image-container").empty();e.find(".content .image-container").empty();b.find(".content .image-container").empty();var d=$("#slide-upload");var c=d.data("turtle-id");d.remove();var a=$("<form enctype='multipart/form-data' id='slide-upload-form'></form>");a.append("<input type='file' name='slide-upload' id='slide-upload' class='slide-image-file' data-turtle-id='"+c+"'/>");$("#upload-modal .header h1").after("<input type='file' name='slide-upload' id='slide-upload' class='slide-image-file' data-turtle-id='"+c+"'/>");$("#modal-finish").removeAttr("data-image-id");$("#modal-fade").hide();$("#upload-modal").hide().removeClass("wide");f.hide();e.hide();b.hide();bindImageEvents()}function bindImageEvents(){$("#add-slide").off().on("click",function(a){a.preventDefault();$("#modal-fade").show();$("#upload-modal").show()});$("#modal-fade").off().on("click",function(a){a.preventDefault();clearUploadModal()});$("#modal-finish").off().on("click",function(c){c.preventDefault();$(this).attr("disabled","disabled").addClass(".disable");var b=getNormalizedUrl();b+="slideshow/crop/";var a=$("#slide-upload").data("turtle-id");var k=$(this).data("data-image-id");$("#finish-slide-uploading").animate({opacity:100},200);var g={};var h={};h.x1=$("#port_x1").val();h.y1=$("#port_y1").val();h.x2=$("#port_x2").val();h.y2=$("#port_y2").val();g.portrait=h;var f={};f.x1=$("#land_x1").val();f.y1=$("#land_y1").val();f.x2=$("#land_x2").val();f.y2=$("#land_y2").val();g.landscape=f;var d={};d.x1=$("#tall_x1").val();d.y1=$("#tall_y1").val();d.x2=$("#tall_x2").val();d.y2=$("#tall_y2").val();g.tall=d;$.ajax({url:b+a+"/"+k,type:"POST",data:JSON.stringify(g),success:function(e){if(e){$("#slide-sorter").append(createSlide(e));$("#finish-slide-uploading").animate({opacity:0},200);clearUploadModal();bindImageEvents()}},error:function(e){console.log("Slideshow image crop error: ");console.log(e)},cache:false,contentType:false,processData:false})});$(".turtle_image #slide-upload").off().on("change",function(d){d.preventDefault();$("#portrait").find(".content .image-container").empty();$("#landscape").find(".content .image-container").empty();$("#tall").find(".content .image-container").empty();var c=new FormData($(this).parents("form")[0]);var b=getNormalizedUrl();b+="slideshow/upload/";var a=$(this).data("turtle-id");var f=Math.round((new Date()).getTime()/1000)+"_"+Math.round(Math.random()*10000);$("#slide-uploading").animate({opacity:100},200);$.ajax({url:b+a+"/"+f,type:"POST",data:c,success:function(e){if(e){$("#portrait").find(".content .image-container").append("<img src='"+e.url+"' id='portrait-cropBox'/>");$("#landscape").find(".content .image-container").append("<img src='"+e.url+"' id='landscape-cropBox'/>");$("#tall").find(".content .image-container").append("<img src='"+e.url+"' id='tall-cropBox'/>");$("#portrait-cropBox").Jcrop({minSize:[960,920],maxSize:[960,920],setSelect:[0,0,960,920],trueSize:[e.width,e.height],allowResize:false,onChange:function(g){$("#port_x1").val(g.x);$("#port_y1").val(g.y);$("#port_x2").val(g.x2);$("#port_y2").val(g.y2)}});$("#landscape-cropBox").Jcrop({minSize:[960,920],maxSize:[960,920],setSelect:[0,0,1920,920],trueSize:[e.width,e.height],allowResize:false,onChange:function(g){$("#land_x1").val(g.x);$("#land_y1").val(g.y);$("#land_x2").val(g.x2);$("#land_y2").val(g.y2)}});$("#tall-cropBox").Jcrop({minSize:[960,920],maxSize:[960,920],setSelect:[0,0,1080,1760],trueSize:[e.width,e.height],allowResize:false,onChange:function(g){$("#tall_x1").val(g.x);$("#tall_y1").val(g.y);$("#tall_x2").val(g.x2);$("#tall_y2").val(g.y2)}});$("#portrait").show();$("#landscape").show();$("#tall").show();$("#slide-uploading").animate({opacity:0},200);$("#modal-finish").data("data-image-id",f).removeAttr("disabled").removeClass("disable")}},error:function(e){console.log("Slideshow image logo upload error: ");console.log(e)},cache:false,contentType:false,processData:false})});$(".turtle_image .remove-slide").off().on("click",function(c){c.preventDefault();var a=$(this).parent().parent();var b=$("#slide-upload").data("turtle-id");var f=a.data("id");var d=getNormalizedUrl();d+="slideshow/delete/";$.ajax({url:d+b+"/"+f,type:"GET",success:function(){a.remove()},error:function(e){console.log("Slideshow slide delete error: ");console.log(e)},cache:false,contentType:false,processData:false})})}bindImageEvents();function buildPriceList(e,b){if(e&&e!=""){var f=JSON.parse(e);$("#title",b).prop("value",f.title);if(f.categories){for(var a in f.categories){var d=f.categories[a];var c=buildPriceListCategory(d.name);c=buildPriceListCategoryEntries(d,c);$(".categories",b).append(c)}}}bindPriceListEvents()}function buildPriceListCategory(d){if(typeof d==="undefined"){d=""}var a=$("<div class='control-group'></div>");a.append("<label class='control-label'>"+lang.turtle_pricelist_category_name+"</label>");var c=$("<div class='controls'></div>");var b=$("<input type='text' class='input name' placeholder=''/>").val(d);c.append(b);c.append("<button id='add-category-entry' class='btn btn-small'>"+lang.turtle_pricelist_add_entry+"</button>");c.append("<button id='delete-category' class='btn btn-small btn-warning pull-right'><i class='icon-trash'></i></button>");a.append(c);var e=$("<div class='listings'></div>");a.append(e);a.append("<hr/>");return a}function buildPriceListCategoryEntries(c,d){if(c.entries){var e=$(".listings",d);var g=c.entries;for(var f in g){var a=g[f].name;var k=g[f].description;var h=g[f].price;var b=g[f].id;var l=buildPriceListCategoryEntry(a,k,h,image,b);e.append(l)}}return d}function buildPriceListCategoryEntry(a,g,e,c,b){if(!a){a=""}if(!g){g=""}if(!e){e=0}if(!b){b=Math.round((new Date()).getTime()/1000)+"_"+Math.round(Math.random()*10000)}var d=$("<div id='listing-"+b+"' class='listing'></div>");var k=$("<div class='control-group'></div>");k.append("<label class='control-label'>"+lang.turtle_pricelist_category_entry_name+"</label>");var h=$("<div class='controls'></div>");var f=$("<input type='text' class='input name'/>").val(a);h.append(f);h.append("<button id='delete-item' class='btn btn-small pull-right'><i class='icon-trash'></i></button>");k.append(h);d.append(k);k=$("<div class='control-group'></div>");k.append("<label class='control-label'>"+lang.turtle_pricelist_category_entry_price+"</label>");h=$("<div class='controls'></div>");h.append("<input type='number' class='input price' step='0.05' pattern='^\\d+(\\.|\\,)\\d{2}$' value='"+e+"'/>");k.append(h);d.append(k);k=$("<div class='control-group'></div>");k.append("<label class='control-label'>"+lang.turtle_pricelist_category_entry_description+"</label>");h=$("<div class='controls'></div>");h.append("<textarea rows='2' cols='35' class='styled description'>"+g+"</textarea>");k.append(h);d.append(k);return d}function buildPriceListImage(c,b,d){var a=$("<span></span>");a.append("<img src='"+c+"' />");a.append("<a class='btn btn-small pricelist-image-delete' href='#' data-turtle-id='"+b+"' data-id='"+d+"'>&times;</a> ");return a}function savePriceList(a){var b={};b.title=$(".control-group .controls #title",a).val();b.categories=[];$(".categories .control-group",a).each(function(){var c={};c.name=$(".name",this).val();c.entries=[];$(".listing",this).each(function(){var d={};d.name=$(".name",this).val();d.price=$(".price",this).val();d.description=$(".description",this).val();var e=$(this).prop("id").split("-");d.id=e[1];if(d.name.length>0){c.entries.push(d)}});if(c.name&&c.name.length>0&&c.entries.length>0){b.categories.push(c)}});return JSON.stringify(b)}function bindPriceListEvents(){$(".turtle_pricelist #add-category").off().on("click",function(b){b.preventDefault();var c=$(this).parents(".turtle_pricelist");var a=buildPriceListCategory();$(".listings",a).append(buildPriceListCategoryEntry());$(".categories",c).append(a);bindPriceListEvents()});$(".turtle_pricelist #add-category-entry").off().on("click",function(c){c.preventDefault();var a=$(this).parents(".control-group");var b=buildPriceListCategoryEntry();$(".listings",a).append(b);bindPriceListEvents()});$(".turtle_pricelist #delete-category").off().on("click",function(b){b.preventDefault();if(confirm(lang.turtle_pricelist_delete_category_note)){var a=$(this).parents(".control-group");a.remove()}});$(".turtle_pricelist #delete-item").off().on("click",function(b){b.preventDefault();if(confirm(lang.turtle_pricelist_delete_item_note)){var a=$(this).parents(".listing");a.remove()}})}bindPriceListEvents();function buildSignage(f,m){var k=JSON.parse(f);if(k){for(i in k){var l=k[i].location;var c=makeSignageFloor(l,b);var e=$(".listings",c);if(k[i].floors){var g=k[i].floors;for(j in g){var a=g[j].name;if(typeof a==="undefined"){a=""}var b=g[j].id;var d=g[j].logo;var h=makeSignageFloorItem(a,b,d);e.append(h)}}$(".floors",m).append(c)}bindSignageEvents()}}function saveSignage(b){var a=[];$(".floors .control-group",b).each(function(){var c=new Object();c.location=$(".location",this).val();c.floors=[];$(".listing",this).each(function(){var e=new Object();e.name=$("input",this).val();var d=$(this).prop("id").split("-");e.id=d[1];if($(this).has("img")){e.image=$("img",$(this)).attr("src")}if(e.name.length>0){c.floors.push(e)}});a.push(c)});return JSON.stringify(a)}function makeSignageFloor(b){if(!b){b=""}var a=$("<div class='control-group floor'></div>");a.append("<label class='control-label'>"+lang.turtle_signage_floor_location+"</label>");var c=$("<div class='controls'></div>");c.append("<input type='text' class='input-small location' value='"+b+"' placeholder=''/>");c.append("<button id='add-floor-item' class='btn btn-small'>"+lang.turtle_signage_add_floor_listing+"</button>");c.append("<button id='delete-floor' class='btn btn-small btn-warning pull-right'><i class='icon-trash'></i></button>");a.append(c);var d=$("<div class='listings'></div>");a.append(d);a.append("<hr/>");return a}function makeSignageFloorItem(a,h,g){if(!a){a=""}if(!h){h=Math.round((new Date()).getTime()/1000)+"_"+Math.round(Math.random()*10000)}var f=$("<div id='listing-"+h+"' class='listing'></div>");f.append("<i class='icon-caret-right'></i>");f.append("<input type='text' placeholder='' class='input' value='"+a+"'/>");f.append("<button class='btn btn-small delete-floor-item'><i class='icon-trash'></i></button>");var e=lang.term_upload+" "+lang.term_logo.toLowerCase();if(g){e=lang.term_change+" "+lang.term_logo.toLowerCase()}var c=$("<div class='floor_logo_holder'></div>");var d=$(".turtle_signage").attr("id").split("_");var b=$("<a class='btn small-file-upload btn-small' href='javascript:;'><span>"+e+"</span><form enctype='multipart/form-data'><input type='file' name='file-"+h+"' class='signage_logo_file' data-turtle-id='"+d[1]+"' data-id='"+h+"'></form></a>");c.append(b);if(g){c.append(makeSignageLogoItem(g,d[1],h))}f.append(c);return f}function makeSignageLogoItem(c,b,d){var a=$("<span></span>");a.append('<img src="'+c+'"/>');a.append("<a class='btn btn-small signage_logo_delete' href='#' data-turtle-id='"+b+"' data-id='"+d+"'>&times;</a>");return a}function bindSignageEvents(){$(".turtle_signage #add-floor").off().on("click",function(c){c.preventDefault();var a=$(this).parents(".turtle_signage");var b=makeSignageFloor();$(".floors",a).append(b);bindSignageEvents()});$(".turtle_signage #add-floor-item").off().on("click",function(c){c.preventDefault();var a=$(this).parents(".control-group");var b=makeSignageFloorItem();$(".listings",a).append(b);bindSignageEvents()});$(".turtle_signage #delete-floor").off().on("click",function(b){b.preventDefault();if(confirm(lang.turtle_signage_delete_floor_note)){var a=$(this).parents(".control-group");$(".signage_logo_delete",a).click();a.remove()}});$(".turtle_signage .delete-floor-item").off().on("click",function(a){a.preventDefault();if(confirm(lang.turtle_signage_delete_entry_note)){var b=$(this).parents(".listing");$(".signage_logo_delete",b).click();b.remove()}});$(".signage_logo_file").off().on("change",function(h){h.preventDefault();var c=new FormData($(this).parents("form")[0]);var g=$(this).parents(".small-file-upload");var d=$("span",g);var f=$(this);if(!g.hasClass("disabled")){d.html(lang.term_uploading+"  ...");f.attr("disabled","disabled");g.attr("disabled","disabled").addClass("disable");var m=pathname;var k=pathname.split("right");if(k.length>1){m=k[0]}m+="signage/upload/";var l=$(this).data("turtle-id");var a=$(this).data("id");var b=$(this).parents(".floor_logo_holder");$.ajax({url:m+l+"/"+a,type:"POST",data:c,success:function(e){if(e){g.removeAttr("disabled").removeClass("disable");f.removeAttr("disabled");d.html(lang.term_change+" "+lang.term_logo.toLowerCase());b.append(makeSignageLogoItem(e,l,a));bindSignageEvents()}else{g.removeAttr("disabled").removeClass("disable");f.removeAttr("disabled");d.html(lang.term_upload+" "+lang.term_logo.toLowerCase())}},error:function(e){console.log("Signage logo upload error: ");console.log(e);g.removeAttr("disabled").removeClass("disable");f.removeAttr("disabled");d.html(lang.term_upload+" "+lang.term_logo.toLowerCase())},cache:false,contentType:false,processData:false})}});$(".signage_logo_delete").off().on("click",function(g){g.preventDefault();var d=pathname;var b=pathname.split("right");if(b.length>1){d=b[0]}d+="signage/delete/";var c=$(this).data("turtle-id");var k=$(this).data("id");var h=$(this).parents(".floor_logo_holder");var a=$(".small-file-upload",h);var f=$("span",a);$.ajax({url:d+c+"/"+k,type:"GET",success:function(e){$("img",h).remove();$(".signage_logo_delete",h).remove();f.html(lang.term_upload+" "+lang.term_logo.toLowerCase())},error:function(e){console.log("Signage logo delete error: ");console.log(e)},cache:false,contentType:false,processData:false})})}bindSignageEvents();var sortableIn=0;$(".turtle-area.sortable").sortable({cursor:"pointer",update:sort_turtles,distance:8,receive:function(b,c){if(sortableIn==1){var a=c.item;var e=$(this);var f=e.attr("id").split("_")[1];if(current_pane_id>0){e=$("#pane_"+current_pane_id+".turtle-area");f=current_pane_id}var d=a.attr("id");$(".turtle",e).html("<div style='padding:20px;'><i class='loading'></i> Adding turtle </div>");$.ajax({url:pathname+"/create",dataType:"html",type:"POST",data:{type:d,pane:f},success:function(k){var h=$(k);h.hide();$(".turtle",e).replaceWith(h);bind_event_to_turtles();h.slideDown(400);$(".turtle-area.sortable").sortable("refresh");var g=new Object();g.target=e[0];sort_turtles(g)},error:function(h,g){alert(lang.error_create_turtle+": "+g)}})}},over:function(a,b){sortableIn=1},out:function(a,b){sortableIn=0}});function sort_turtles(c,d){var a=$(c.target).sortable("toArray");for(var b=0;b<a.length;b++){a[b]=a[b].split("_")[1];if(isNaN(parseInt(a[b],10))){return}}$.ajax({url:pathname+"/sort",type:"POST",data:{order:a}})}var days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function buildWeekMenu(f,d){if(f&&f!=""){var b=JSON.parse(f);$("#weekmenu-title",d).val(b.weekmenu_title);$("#today-title",d).val(b.today_title);if(b.show_today){$("#show-today",d).button("toggle")}else{$("#show-weekmenu",d).button("toggle")}if(b.categories){for(var c in b.categories){var e=b.categories[c];var a=buildWeekMenuCategory(e.name,e.price);a=buildWeekMenuCategoryEntries(e,a);$(".categories",d).append(a)}}}bindWeekMenuEvents()}function buildWeekMenuCategory(e,f){if(typeof e==="undefined"){e=""}if(typeof f==="undefined"){f=0}var b=$("<div class='category'></div>");var a=$("<div class='control-group'></div>");a.append("<label class='control-label'>"+lang.turtle_pricelist_category_name+"</label> ");var d=$("<div class='controls'></div>");var c=$("<input type='text' class='input name' placeholder=''/>").val(e);d.append(c);d.append("<button id='delete-category' class='btn btn-small btn-warning pull-right'><i class='icon-trash'></i></button>");a.append(d);b.append(a);a=$("<div class='control-group'></div>");a.append("<label class='control-label'>"+lang.term_price+"</label>");d=$("<div class='controls'></div>");d.append("<input type='number' class='input price' step='0.05' pattern='^\\d+(\\.|\\,)\\d{2}$' value='"+f+"'/>");a.append(d);b.append(a);a=$("<div class='control-group'></div>");var g=$("<div class='listings'></div>");a.append(g);a.append("<hr/>");b.append(a);return b}function buildWeekMenuCategoryEntries(f,b){var a=[];if(f.meals){a=f.meals;var h=$(".listings",b);for(var c in days){var g=days[c];var e;if(a[c]){var d=a[c];e=buildWeekMenuCategoryEntry(g,d.name,d.image,d.id)}else{e=buildWeekMenuCategoryEntry(g,"","","")}h.append(e)}}return b}function buildWeekMenuCategoryEntry(l,b,e,c){if(!b){b=""}if(!c){c=Math.round((new Date()).getTime()/1000)+"_"+Math.round(Math.random()*10000)}var g=$("<div id='listing-"+c+"' class='listing control-group'></div>");g.append("<label class='control-label day'>"+l+"</label> ");var m=$("<div class='controls'></div>");var k=$("<input type='text' class='input name' />").val(b);m.append(k);var f=lang.term_upload+" "+lang.term_image.toLowerCase();if(e){f=lang.term_change+" "+lang.term_image.toLowerCase()}var a=$("<div class='entry_image_holder'></div>");var h=$(".turtle_weekmenu").attr("id").split("_");var d=$("<a class='btn small-file-upload btn-small' href='javascript:;'><span>"+f+"</span><form enctype='multipart/form-data'><input type='file' name='file-"+c+"' class='weekmenu-image-file' data-turtle-id='"+h[1]+"' data-id='"+c+"'></form></a>");a.append(d);if(e){a.append(buildWeekMenuImage(e,h[1],c))}m.append(a);g.append(m);return g}function buildWeekMenuImage(c,b,d){var a=$("<span></span>");a.append("<img src='"+c+"' />");a.append("<a class='btn btn-small weekmenu-image-delete' href='#' data-turtle-id='"+b+"' data-id='"+d+"'>&times;</a> ");return a}function bindWeekMenuEvents(){$(".turtle_weekmenu #add-category").off().on("click",function(f){f.preventDefault();var c=$(this).parents(".turtle_weekmenu");var a=buildWeekMenuCategory();for(var b in days){var d=days[b];$(".listings",a).append(buildWeekMenuCategoryEntry(d))}$(".categories",c).append(a);bindWeekMenuEvents()});$(".turtle_weekmenu #delete-category").off().on("click",function(b){b.preventDefault();if(confirm(lang.turtle_weekmenu_delete_category_note)){var a=$(this).parents(".category");$(".weekmenu-image-delete",a).click();a.remove()}});$(".weekmenu-image-file").off().on("change",function(k){k.preventDefault();var d=new FormData($(this).parents("form")[0]);var h=$(this).parents(".small-file-upload");var f=$("span",h);var g=$(this);if(!h.hasClass("disabled")){f.html(lang.term_uploading+"  ...");g.attr("disabled","disabled");h.attr("disabled","disabled").addClass("disable");var c=getNormalizedUrl();c+="menu-image/upload/";var l=$(this).data("turtle-id");var a=$(this).data("id");var b=$(this).parents(".entry_image_holder");$.ajax({url:c+l+"/"+a,type:"POST",data:d,success:function(e){if(e){h.removeAttr("disabled").removeClass("disable");g.removeAttr("disabled");f.html(lang.term_change+" "+lang.term_image.toLowerCase());b.append(buildPriceListImage(e,l,a));bindWeekMenuEvents()}else{h.removeAttr("disabled").removeClass("disable");g.removeAttr("disabled");f.html(lang.term_upload+" "+lang.term_image.toLowerCase())}},error:function(e){console.log("Weekenu image upload error: ");console.log(e);h.removeAttr("disabled").removeClass("disable");g.removeAttr("disabled");f.html(lang.term_upload+" "+lang.term_image.toLowerCase())},cache:false,contentType:false,processData:false})}});$(".weekmenu-image-delete").off().on("click",function(d){d.preventDefault();var h=getNormalizedUrl();h+="menu-image/delete/";var b=$(this).data("turtle-id");var g=$(this).data("id");var f=$(this).parents(".entry_image_holder");var a=$(".small-file-upload",f);var c=$("span",a);console.log(g);$.ajax({url:h+b+"/"+g,type:"GET",success:function(e){$("img",f).remove();$(".weekmenu-image-delete",f).remove();c.html(lang.term_upload+" "+lang.term_image.toLowerCase())},error:function(e){console.log("Weekmenu image delete error: ");console.log(e)},cache:false,contentType:false,processData:false})})}function saveWeekMenu(a){var b={};b.weekmenu_title=$(".control-group .controls #weekmenu-title",a).val();b.today_title=$(".control-group .controls #today-title",a).val();b.show_today=$("#show-today",a).hasClass("active");b.categories=[];$(".categories .category",a).each(function(){var c={};c.name=$(".name",this).val();c.price=$(".price",this).val();c.meals=[];$(".listing",this).each(function(e){var g={};var d={};d.day=$(".day",this).text();d.name=$(".name",this).val();var f=$(this).prop("id").split("-");d.id=f[1];if($(this).has("img")){d.image=$("img",$(this)).attr("src")}if(d.name.length>0){c.meals[e.toString()]=d}});b.categories.push(c)});return JSON.stringify(b)}bindWeekMenuEvents();function buildOffers(e,b){if(e&&e!=""){var f=JSON.parse(e);$("#title",b).prop("value",f.title);if(f.offers){for(var a in f.offers){var d=f.offers[a];var c=buildOffer(d.name,d.description,d.price,d.image,d.id);$(".offer-wrapper",b).append(c)}}}bindOfferEvents()}function buildOffer(b,m,h,f,d){if(!b){b=""}if(!m){m=""}if(!h){h=0}if(!f){f=""}if(!d){d=Math.round((new Date()).getTime()/1000)+"_"+Math.round(Math.random()*10000)}var c=$("<div id='offer-"+d+"' class='offer'></div>");var o=$("<div class='control-group'></div>");o.append("<label class='control-label'>"+lang.turtle_weekmenu_offer_name+"</label> ");var n=$("<div class='controls'></div>");var l=$("<input type='text' class='input name'/>").val(b);n.append(l);n.append("<button id='delete-offer' class='btn btn-small btn-warning pull-right'><i class='icon-trash'></i></button>");o.append(n);c.append(o);o=$("<div class='control-group'></div>");o.append("<label class='control-label'>"+lang.term_price+"</label> ");n=$("<div class='controls'></div>");n.append("<input type='number' class='input price' step='0.05' pattern='^\\d+(\\.|\\,)\\d{2}$' value='"+h+"'/>");o.append(n);c.append(o);o=$("<div class='control-group'></div>");n=$("<div class='controls'></div>");var g=lang.term_upload+" "+lang.term_image.toLowerCase();if(f){g=lang.term_change+" "+lang.term_image.toLowerCase()}var a=$("<div class='entry_image_holder'></div>");var k=$(".turtle_offers").attr("id").split("_");var e=$("<a class='btn small-file-upload btn-small' href='javascript:;'><span>"+g+"</span><form enctype='multipart/form-data'><input type='file' name='file-"+d+"' class='offer-image-file' data-turtle-id='"+k[1]+"' data-id='"+d+"'></form></a>");a.append(e);if(f){a.append(buildOfferImage(f,k[1],d))}n.append(a);o.append(n);c.append(o);o=$("<div class='control-group'></div>");o.append("<label class='control-label'>"+lang.term_description+"</label> ");n=$("<div class='controls'></div>");n.append("<textarea rows='2' cols='35' class='styled description'>"+m+"</textarea>");o.append(n);o.append("<hr/>");c.append(o);return c}function buildOfferImage(c,b,d){var a=$("<span></span>");a.append("<img src='"+c+"' />");a.append("<a class='btn btn-small offer-image-delete' href='#' data-turtle-id='"+b+"' data-id='"+d+"'>&times;</a> ");return a}function bindOfferEvents(){$(".turtle_offers #add-offer").off().on("click",function(c){c.preventDefault();var b=$(this).parents(".turtle_offers");var a=buildOffer();$(".offer-wrapper",b).append(a);bindOfferEvents()});$(".turtle_offers #delete-offer").off().on("click",function(b){b.preventDefault();if(confirm(lang.turtle_weekmenu_delete_offer_note)){var a=$(this).parents(".offer");$(".offer-image-delete",a).click();a.remove()}});$(".offer-image-file").off().on("change",function(k){k.preventDefault();var d=new FormData($(this).parents("form")[0]);var h=$(this).parents(".small-file-upload");var f=$("span",h);var g=$(this);if(!h.hasClass("disabled")){f.html(lang.term_uploading+"  ...");g.attr("disabled","disabled");h.attr("disabled","disabled").addClass("disable");var c=getNormalizedUrl();c+="menu-image/upload/";var l=$(this).data("turtle-id");var a=$(this).data("id");var b=$(this).parents(".entry_image_holder");$.ajax({url:c+l+"/"+a,type:"POST",data:d,success:function(e){if(e){h.removeAttr("disabled").removeClass("disable");g.removeAttr("disabled");f.html(lang.term_change+" "+lang.term_image.toLowerCase());b.append(buildPriceListImage(e,l,a));bindOfferEvents()}else{h.removeAttr("disabled").removeClass("disable");g.removeAttr("disabled");f.html(lang.term_upload+" "+lang.term_image.toLowerCase())}},error:function(e){console.log("offer image upload error: ");console.log(e);h.removeAttr("disabled").removeClass("disable");g.removeAttr("disabled");f.html(lang.term_upload+" "+lang.term_image.toLowerCase())},cache:false,contentType:false,processData:false})}});$(".offer-image-delete").off().on("click",function(d){d.preventDefault();var h=getNormalizedUrl();h+="menu-image/delete/";var b=$(this).data("turtle-id");var g=$(this).data("id");var f=$(this).parents(".entry_image_holder");var a=$(".small-file-upload",f);var c=$("span",a);console.log(g);$.ajax({url:h+b+"/"+g,type:"GET",success:function(e){$("img",f).remove();$(".offer-image-delete",f).remove();c.html(lang.term_upload+" "+lang.term_image.toLowerCase())},error:function(e){console.log("offer image delete error: ");console.log(e)},cache:false,contentType:false,processData:false})})}function saveOffers(a){var b={};b.title=$(".control-group .controls #title",a).val();b.offers=[];$(".offer-wrapper .offer",a).each(function(){var c={};c.name=$(".name",this).val();c.description=$(".description",this).val();c.price=$(".price",this).val();var d=$(this).prop("id").split("-");c.id=d[1];if($(this).has("img")){c.image=$("img",$(this)).attr("src")}if(c.name.length>0){b.offers.push(c)}});return JSON.stringify(b)}bindOfferEvents();!function(c){var a=function(e,d){this.element=c(e);this.format=b.parseFormat(d.format||this.element.data("date-format")||"mm/dd/yyyy");this.picker=c(b.template).appendTo("body").on({click:c.proxy(this.click,this)});this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;if(this.isInput){this.element.on({focus:c.proxy(this.show,this),keyup:c.proxy(this.update,this)})}else{if(this.component){this.component.on("click",c.proxy(this.show,this))}else{this.element.on("click",c.proxy(this.show,this))}}this.minViewMode=d.minViewMode||this.element.data("date-minviewmode")||0;if(typeof this.minViewMode==="string"){switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0;break}}this.viewMode=d.viewMode||this.element.data("date-viewmode")||0;if(typeof this.viewMode==="string"){switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0;break}}this.startViewMode=this.viewMode;this.weekStart=d.weekStart||this.element.data("date-weekstart")||0;this.weekEnd=this.weekStart===0?6:this.weekStart-1;this.onRender=d.onRender;this.fillDow();this.fillMonths();this.update();this.showMode()};a.prototype={constructor:a,show:function(f){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();c(window).on("resize",c.proxy(this.place,this));if(f){f.stopPropagation();f.preventDefault()}if(!this.isInput){}var d=this;c(document).on("mousedown",function(e){if(c(e.target).closest(".datepicker").length==0){d.hide()}});this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide();c(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){c(document).off("mousedown",this.hide)}this.element.trigger({type:"hide",date:this.date})},set:function(){var d=b.formatDate(this.date,this.format);if(!this.isInput){if(this.component){this.element.find("input").prop("value",d)}this.element.data("date",d)}else{this.element.prop("value",d)}},setValue:function(d){if(typeof d==="string"){this.date=b.parseDate(d,this.format)}else{this.date=new Date(d)}this.set();this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},place:function(){var d=this.component?this.component.offset():this.element.offset();this.picker.css({top:d.top+this.height,left:d.left})},update:function(d){this.date=b.parseDate(typeof d==="string"?d:(this.isInput?this.element.prop("value"):this.element.data("date")),this.format);this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},fillDow:function(){var d=this.weekStart;var e="<tr>";while(d<this.weekStart+7){e+='<th class="dow">'+b.dates.daysMin[(d++)%7]+"</th>"}e+="</tr>";this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){var e="";var d=0;while(d<12){e+='<span class="month">'+b.dates.monthsShort[d++]+"</span>"}this.picker.find(".datepicker-months td").append(e)},fill:function(){var s=new Date(this.viewDate),t=s.getFullYear(),r=s.getMonth(),g=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(b.dates.months[r]+" "+t);var l=new Date(t,r-1,28,0,0,0,0),u=b.getDaysInMonth(l.getFullYear(),l.getMonth());l.setDate(u);l.setDate(u-(l.getDay()-this.weekStart+7)%7);var o=new Date(l);o.setDate(o.getDate()+42);o=o.valueOf();var n=[];var k,q,e;while(l.valueOf()<o){if(l.getDay()===this.weekStart){n.push("<tr>")}k=this.onRender(l);q=l.getFullYear();e=l.getMonth();if((e<r&&q===t)||q<t){k+=" old"}else{if((e>r&&q===t)||q>t){k+=" new"}}if(l.valueOf()===g){k+=" active"}n.push('<td class="day '+k+'">'+l.getDate()+"</td>");if(l.getDay()===this.weekEnd){n.push("</tr>")}l.setDate(l.getDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(n.join(""));var p=this.date.getFullYear();var f=this.picker.find(".datepicker-months").find("th:eq(1)").text(t).end().find("span").removeClass("active");if(p===t){f.eq(this.date.getMonth()).addClass("active")}n="";t=parseInt(t/10,10)*10;var h=this.picker.find(".datepicker-years").find("th:eq(1)").text(t+"-"+(t+9)).end().find("td");t-=1;for(var m=-1;m<11;m++){n+='<span class="year'+(m===-1||m===10?" old":"")+(p===t?" active":"")+'">'+t+"</span>";t+=1}h.html(n)},click:function(k){k.stopPropagation();k.preventDefault();var h=c(k.target).closest("span, td, th");if(h.length===1){switch(h[0].nodeName.toLowerCase()){case"th":switch(h[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+b.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+b.modes[this.viewMode].navFnc].call(this.viewDate)+b.modes[this.viewMode].navStep*(h[0].className==="prev"?-1:1));this.fill();this.set();break}break;case"span":if(h.is(".month")){var g=h.parent().find("span").index(h);this.viewDate.setMonth(g)}else{var f=parseInt(h.text(),10)||0;this.viewDate.setFullYear(f)}if(this.viewMode!==0){this.date=new Date(this.viewDate);this.element.trigger({type:"changeDate",date:this.date,viewMode:b.modes[this.viewMode].clsName})}this.showMode(-1);this.fill();this.set();break;case"td":if(h.is(".day")&&!h.is(".disabled")){var d=parseInt(h.text(),10)||1;var g=this.viewDate.getMonth();if(h.is(".old")){g-=1}else{if(h.is(".new")){g+=1}}var f=this.viewDate.getFullYear();this.date=new Date(f,g,d,0,0,0,0);this.viewDate=new Date(f,g,Math.min(28,d),0,0,0,0);this.fill();this.set();this.element.trigger({type:"changeDate",date:this.date,viewMode:b.modes[this.viewMode].clsName})}break}}},mousedown:function(d){d.stopPropagation();d.preventDefault()},showMode:function(d){if(d){this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+d))}this.picker.find(">div").hide().filter(".datepicker-"+b.modes[this.viewMode].clsName).show()}};c.fn.datepicker=function(d,e){return this.each(function(){var h=c(this),g=h.data("datepicker"),f=typeof d==="object"&&d;if(!g){h.data("datepicker",(g=new a(this,c.extend({},c.fn.datepicker.defaults,f))))}if(typeof d==="string"){g[d](e)}})};c.fn.datepicker.defaults={onRender:function(d){return""}};c.fn.datepicker.Constructor=a;var b={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(d){return(((d%4===0)&&(d%100!==0))||(d%400===0))},getDaysInMonth:function(d,e){return[31,(b.isLeapYear(d)?29:28),31,30,31,30,31,31,30,31,30,31][e]},parseFormat:function(f){var e=f.match(/[.\/\-\s].*?/),d=f.split(/\W+/);if(!e||!d||d.length===0){throw new Error("Invalid date format.")}return{separator:e,parts:d}},parseDate:function(f,n){var g=f.split(n.separator),f=new Date(),e;f.setHours(0);f.setMinutes(0);f.setSeconds(0);f.setMilliseconds(0);if(g.length===n.parts.length){var l=f.getFullYear(),m=f.getDate(),k=f.getMonth();for(var h=0,d=n.parts.length;h<d;h++){e=parseInt(g[h],10)||1;switch(n.parts[h]){case"dd":case"d":m=e;f.setDate(e);break;case"mm":case"m":k=e-1;f.setMonth(e-1);break;case"yy":l=2000+e;f.setFullYear(2000+e);break;case"yyyy":l=e;f.setFullYear(e);break}}f=new Date(l,k,m,0,0,0)}return f},formatDate:function(d,g){var h={d:d.getDate(),m:d.getMonth()+1,yy:d.getFullYear().toString().substring(2),yyyy:d.getFullYear()};h.dd=(h.d<10?"0":"")+h.d;h.mm=(h.m<10?"0":"")+h.m;var d=[];for(var f=0,e=g.parts.length;f<e;f++){d.push(h[g.parts[f]])}return d.join(g.separator)},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};b.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+b.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+b.headTemplate+b.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+b.headTemplate+b.contTemplate+"</table></div></div>"}(window.jQuery);!function(b){var a=function(d,c,f){if(f){f.stopPropagation();f.preventDefault()}this.$element=b(d);this.$newElement=null;this.button=null;this.options=b.extend({},b.fn.selectpicker.defaults,this.$element.data(),typeof c=="object"&&c);if(this.options.title==null){this.options.title=this.$element.attr("title")}this.val=a.prototype.val;this.render=a.prototype.render;this.refresh=a.prototype.refresh;this.selectAll=a.prototype.selectAll;this.deselectAll=a.prototype.deselectAll;this.init()};a.prototype={constructor:a,init:function(d){if(!this.options.container){this.$element.hide()}else{this.$element.css("visibility","hidden")}this.multiple=this.$element.prop("multiple");var f=this.$element.attr("class")!==undefined?this.$element.attr("class").split(/\s+/):"";var g=this.$element.attr("id");this.$element.after(this.createView());this.$newElement=this.$element.next(".bootstrap-select");if(this.options.container){this.selectPosition()}this.button=this.$newElement.find("> button");if(g!==undefined){this.button.attr("id",g);b('label[for="'+g+'"]').click(b.proxy(this,function(){this.$newElement.find("button#"+g).focus()}))}for(var c=0;c<f.length;c++){if(f[c]!="selectpicker"){this.$newElement.addClass(f[c])}}if(this.multiple){this.$newElement.addClass("show-tick")}if(this.options){this.button.addClass(this.options.style)}this.checkDisabled();this.checkTabIndex();this.clickListener();this.$element.bind("DOMNodeInserted DOMNodeRemoved",b.proxy(this.refresh,this));this.render();this.setSize()},createDropdown:function(){var c="<div class='btn-group bootstrap-select'><button type='button' class='btn dropdown-toggle clearfix' data-toggle='dropdown'><span class='filter-option pull-left'></span>&nbsp;<span class='caret'></span></button><ul class='dropdown-menu' role='menu'></ul></div>";return b(c)},createView:function(){var c=this.createDropdown();var d=this.createLi();c.find("ul").append(d);return c},reloadLi:function(){this.destroyLi();$li=this.createLi();this.$newElement.find("ul").append($li)},destroyLi:function(){this.$newElement.find("li").remove()},createLi:function(){var h=this;var e=[];var g=[];var c="";this.$element.find("option").each(function(){e.push(b(this).text())});this.$element.find("option").each(function(m){var p=b(this).attr("class")!==undefined?b(this).attr("class"):"";var o=b(this).text();var n=b(this).data("subtext")!==undefined?'<small class="muted">'+b(this).data("subtext")+"</small>":"";o+=n;if(b(this).parent().is("optgroup")&&b(this).data("divider")!=true){if(b(this).index()==0){var l=b(this).parent().attr("label");var k=b(this).parent().data("subtext")!==undefined?'<small class="muted">'+b(this).parent().data("subtext")+"</small>":"";l+=k;if(b(this)[0].index!=0){g.push('<div class="div-contain"><div class="divider"></div></div><dt>'+l+"</dt>"+h.createA(o,"opt "+p))}else{g.push("<dt>"+l+"</dt>"+h.createA(o,"opt "+p))}}else{g.push(h.createA(o,"opt "+p))}}else{if(b(this).data("divider")==true){g.push('<div class="div-contain"><div class="divider"></div></div>')}else{g.push(h.createA(o,p))}}});if(e.length>0){for(var d=0;d<e.length;d++){var f=this.$element.find("option").eq(d);c+="<li rel="+d+">"+g[d]+"</li>"}}if(this.$element.find("option:selected").length==0&&!h.options.title){this.$element.find("option").eq(0).prop("selected",true).attr("selected","selected")}return b(c)},createA:function(d,c){return'<a tabindex="-1" href="#" class="'+c+'"><span class="pull-left">'+d+'</span><i class="icon-ok check-mark"></i></a>'},render:function(){var f=this;this.$element.find("option").each(function(g){f.setDisabled(g,b(this).is(":disabled")||b(this).parent().is(":disabled"));f.setSelected(g,b(this).is(":selected"))});var e=this.$element.find("option:selected").map(function(g,h){if(b(this).attr("title")!=undefined){return b(this).attr("title")}else{return b(this).text()}}).toArray();var d=e.join(", ");if(f.multiple&&f.options.selectedTextFormat.indexOf("count")>-1){var c=f.options.selectedTextFormat.split(">");if((c.length>1&&e.length>c[1])||(c.length==1&&e.length>=2)){d=e.length+" of "+this.$element.find("option").length+" selected"}}if(!d){d=f.options.title!=undefined?f.options.title:f.options.noneSelectedText}f.$newElement.find(".filter-option").html(d)},setSize:function(){var h=this;var d=this.$newElement.find(".dropdown-menu");var l=d.find("li > a");var o=this.$newElement.addClass("open").find(".dropdown-menu li > a").outerHeight();this.$newElement.removeClass("open");var f=d.find("li .divider").outerHeight(true);var e=this.$newElement.offset().top;var k=this.$newElement.outerHeight();var c=parseInt(d.css("padding-top"))+parseInt(d.css("padding-bottom"))+parseInt(d.css("border-top-width"))+parseInt(d.css("border-bottom-width"));if(this.options.size=="auto"){function p(){var q=e-b(window).scrollTop();var t=window.innerHeight;var r=c+parseInt(d.css("margin-top"))+parseInt(d.css("margin-bottom"))+2;var s=t-q-k-r;menuHeight=s;if(h.$newElement.hasClass("dropup")){menuHeight=q-r}if((d.find("li").length+d.find("dt").length)>3){minHeight=o*3+r-2}else{minHeight=0}d.css({"max-height":menuHeight+"px","overflow-y":"auto","min-height":minHeight+"px"})}p();b(window).resize(p);b(window).scroll(p)}else{if(this.options.size&&this.options.size!="auto"&&d.find("li").length>this.options.size){var n=d.find("li > *").filter(":not(.div-contain)").slice(0,this.options.size).last().parent().index();var m=d.find("li").slice(0,n+1).find(".div-contain").length;menuHeight=o*this.options.size+m*f+c;d.css({"max-height":menuHeight+"px","overflow-y":"auto"})}}if(this.options.width=="auto"){this.$newElement.find(".dropdown-menu").css("min-width","0");var g=this.$newElement.find(".dropdown-menu").css("width");this.$newElement.css("width",g);if(this.options.container){this.$element.css("width",g)}}else{if(this.options.width&&this.options.width!="auto"){this.$newElement.css("width",this.options.width);if(this.options.container){this.$element.css("width",this.options.width)}}}},selectPosition:function(){var d=this.$element.offset().top;var c=this.$element.offset().left;this.$newElement.appendTo(this.options.container);this.$newElement.css({position:"absolute",top:d+"px",left:c+"px"})},refresh:function(){this.reloadLi();this.render();this.setSize();this.checkDisabled();if(this.options.container){this.selectPosition()}},setSelected:function(c,d){if(d){this.$newElement.find("li").eq(c).addClass("selected")}else{this.$newElement.find("li").eq(c).removeClass("selected")}},setDisabled:function(c,d){if(d){this.$newElement.find("li").eq(c).addClass("disabled")}else{this.$newElement.find("li").eq(c).removeClass("disabled")}},checkDisabled:function(){if(this.$element.is(":disabled")){this.button.addClass("disabled");this.button.click(function(c){c.preventDefault()});this.button.on("focusin",function(){b(this).blur()})}else{if(!this.$element.is(":disabled")&&this.button.hasClass("disabled")){this.button.removeClass("disabled");this.button.click(function(){return true})}}},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var c=this.$element.attr("tabindex");this.button.attr("tabindex",c)}},clickListener:function(){var c=this;b("body").on("touchstart.dropdown",".dropdown-menu",function(d){d.stopPropagation()});this.$newElement.on("click","li a",function(l){var g=b(this).parent().index(),k=b(this).parent(),d=k.parents(".bootstrap-select"),h=c.$element.val();if(c.multiple){l.stopPropagation()}l.preventDefault();if(c.$element.not(":disabled")&&!b(this).parent().hasClass("disabled")){if(!c.multiple){c.$element.find("option").removeAttr("selected");c.$element.find("option").eq(g).prop("selected",true).attr("selected","selected")}else{var f=c.$element.find("option").eq(g).prop("selected");if(f){c.$element.find("option").eq(g).removeAttr("selected")}else{c.$element.find("option").eq(g).prop("selected",true).attr("selected","selected")}}d.find(".filter-option").html(k.text());d.find("button").focus();if(h!=c.$element.val()){c.$element.trigger("change")}c.render()}});this.$newElement.on("click","li.disabled a, li dt, li .div-contain",function(d){d.preventDefault();d.stopPropagation();$select=b(this).parent().parents(".bootstrap-select");$select.find("button").focus()});this.$element.on("change",function(d){c.render()})},val:function(c){if(c!=undefined){this.$element.val(c);this.$element.trigger("change");return this.$element}else{return this.$element.val()}},selectAll:function(){this.$element.find("option").prop("selected",true).attr("selected","selected");this.render()},deselectAll:function(){this.$element.find("option").prop("selected",false).removeAttr("selected");this.render()},};b.fn.selectpicker=function(e,f){var c=arguments;var g;var d=this.each(function(){if(b(this).is("select")){var m=b(this),l=m.data("selectpicker"),h=typeof e=="object"&&e;if(!l){m.data("selectpicker",(l=new a(this,h,f)))}else{if(h){for(var k in h){l.options[k]=h[k]}}}if(typeof e=="string"){property=e;if(l[property] instanceof Function){[].shift.apply(c);g=l[property].apply(l,c)}else{g=l.options[property]}}}});if(g!=undefined){return g}else{return d}};b.fn.selectpicker.defaults={style:null,size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",width:null,container:false}}(window.jQuery);!function(a){a(function(){a.support.transition=(function(){var b=(function(){var e=document.createElement("bootstrap"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c;for(c in d){if(e.style[c]!==undefined){return d[c]}}}());return b&&{end:b}})()})}(window.jQuery);!function(b){var a=function(d,c){this.options=c;this.$element=b(d).delegate('[data-dismiss="modal"]',"click.dismiss.modal",b.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};a.prototype={constructor:a,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var c=this,d=b.Event("show");this.$element.trigger(d);if(this.isShown||d.isDefaultPrevented()){return}this.isShown=true;this.escape();this.backdrop(function(){var e=b.support.transition&&c.$element.hasClass("fade");if(!c.$element.parent().length){c.$element.appendTo(document.body)}c.$element.show();if(e){c.$element[0].offsetWidth}c.$element.addClass("in").attr("aria-hidden",false);c.enforceFocus();e?c.$element.one(b.support.transition.end,function(){c.$element.focus().trigger("shown")}):c.$element.focus().trigger("shown")})},hide:function(d){d&&d.preventDefault();var c=this;d=b.Event("hide");this.$element.trigger(d);if(!this.isShown||d.isDefaultPrevented()){return}this.isShown=false;this.escape();b(document).off("focusin.modal");this.$element.removeClass("in").attr("aria-hidden",true);b.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var c=this;b(document).on("focusin.modal",function(d){if(c.$element[0]!==d.target&&!c.$element.has(d.target).length){c.$element.focus()}})},escape:function(){var c=this;if(this.isShown&&this.options.keyboard){this.$element.on("keyup.dismiss.modal",function(d){d.which==27&&c.hide()})}else{if(!this.isShown){this.$element.off("keyup.dismiss.modal")}}},hideWithTransition:function(){var c=this,d=setTimeout(function(){c.$element.off(b.support.transition.end);c.hideModal()},500);this.$element.one(b.support.transition.end,function(){clearTimeout(d);c.hideModal()})},hideModal:function(c){this.$element.hide().trigger("hidden");this.backdrop()},removeBackdrop:function(){this.$backdrop.remove();this.$backdrop=null},backdrop:function(f){var e=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var c=b.support.transition&&d;this.$backdrop=b('<div class="modal-backdrop '+d+'" />').appendTo(document.body);this.$backdrop.click(this.options.backdrop=="static"?b.proxy(this.$element[0].focus,this.$element[0]):b.proxy(this.hide,this));if(c){this.$backdrop[0].offsetWidth}this.$backdrop.addClass("in");c?this.$backdrop.one(b.support.transition.end,f):f()}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");b.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(b.support.transition.end,b.proxy(this.removeBackdrop,this)):this.removeBackdrop()}else{if(f){f()}}}}};b.fn.modal=function(c){return this.each(function(){var f=b(this),e=f.data("modal"),d=b.extend({},b.fn.modal.defaults,f.data(),typeof c=="object"&&c);if(!e){f.data("modal",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}else{if(d.show){e.show()}}})};b.fn.modal.defaults={backdrop:true,keyboard:true,show:true};b.fn.modal.Constructor=a;b(document).on("click.modal.data-api",'[data-toggle="modal"]',function(h){var g=b(this),d=g.attr("href"),c=b(g.attr("data-target")||(d&&d.replace(/.*(?=#[^\s]+$)/,""))),f=c.data("modal")?"toggle":b.extend({remote:!/#/.test(d)&&d},c.data(),g.data());h.preventDefault();c.modal(f).one("hide",function(){g.focus()})})}(window.jQuery);!function(e){var b="[data-toggle=dropdown]",a=function(g){var f=e(g).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){f.parent().removeClass("open")})};a.prototype={constructor:a,toggle:function(k){var h=e(this),g,f;if(h.is(".disabled, :disabled")){return}g=d(h);f=g.hasClass("open");c();if(!f){g.toggleClass("open");h.focus()}return false},keydown:function(m){var l,n,f,k,h,g;if(!/(38|40|27)/.test(m.keyCode)){return}l=e(this);m.preventDefault();m.stopPropagation();if(l.is(".disabled, :disabled")){return}k=d(l);h=k.hasClass("open");if(!h||(h&&m.keyCode==27)){return l.click()}n=e("[role=menu] li:not(.divider) a",k);if(!n.length){return}g=n.index(n.filter(":focus"));if(m.keyCode==38&&g>0){g--}if(m.keyCode==40&&g<n.length-1){g++}if(!~g){g=0}n.eq(g).focus()}};function c(){e(b).each(function(){d(e(this)).removeClass("open")})}function d(h){var f=h.attr("data-target"),g;if(!f){f=h.attr("href");f=f&&/#/.test(f)&&f.replace(/.*(?=#[^\s]*$)/,"")}g=e(f);g.length||(g=h.parent());return g}e.fn.dropdown=function(f){return this.each(function(){var h=e(this),g=h.data("dropdown");if(!g){h.data("dropdown",(g=new a(this)))}if(typeof f=="string"){g[f].call(h)}})};e.fn.dropdown.Constructor=a;e(document).on("click.dropdown.data-api touchstart.dropdown.data-api",c).on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(f){f.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",b,a.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",b+", [role=menu]",a.prototype.keydown)}(window.jQuery);!function(b){function a(f,e){var g=b.proxy(this.process,this),c=b(f).is("body")?b(window):b(f),d;this.options=b.extend({},b.fn.scrollspy.defaults,e);this.$scrollElement=c.on("scroll.scroll-spy.data-api",g);this.selector=(this.options.target||((d=b(f).attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""))||"")+" .nav li > a";this.$body=b("body");this.refresh();this.process()}a.prototype={constructor:a,refresh:function(){var c=this,d;this.offsets=b([]);this.targets=b([]);d=this.$body.find(this.selector).map(function(){var f=b(this),e=f.data("target")||f.attr("href"),g=/^#\w/.test(e)&&b(e);return(g&&g.length&&[[g.position().top,e]])||null}).sort(function(f,e){return f[0]-e[0]}).each(function(){c.offsets.push(this[0]);c.targets.push(this[1])})},process:function(){var h=this.$scrollElement.scrollTop()+this.options.offset,e=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,g=e-this.$scrollElement.height(),f=this.offsets,c=this.targets,k=this.activeTarget,d;if(h>=g){return k!=(d=c.last()[0])&&this.activate(d)}for(d=f.length;d--;){k!=c[d]&&h>=f[d]&&(!f[d+1]||h<=f[d+1])&&this.activate(c[d])}},activate:function(e){var d,c;this.activeTarget=e;b(this.selector).parent(".active").removeClass("active");c=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]';d=b(c).parent("li").addClass("active");if(d.parent(".dropdown-menu").length){d=d.closest("li.dropdown").addClass("active")}d.trigger("activate")}};b.fn.scrollspy=function(c){return this.each(function(){var f=b(this),e=f.data("scrollspy"),d=typeof c=="object"&&c;if(!e){f.data("scrollspy",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.scrollspy.Constructor=a;b.fn.scrollspy.defaults={offset:10};b(window).on("load",function(){b('[data-spy="scroll"]').each(function(){var c=b(this);c.scrollspy(c.data())})})}(window.jQuery);!function(b){var a=function(c){this.element=b(c)};a.prototype={constructor:a,show:function(){var k=this.element,f=k.closest("ul:not(.dropdown-menu)"),d=k.attr("data-target"),g,c,h;if(!d){d=k.attr("href");d=d&&d.replace(/.*(?=#[^\s]*$)/,"")}if(k.parent("li").hasClass("active")){return}g=f.find(".active:last a")[0];h=b.Event("show",{relatedTarget:g});k.trigger(h);if(h.isDefaultPrevented()){return}c=b(d);this.activate(k.parent("li"),f);this.activate(c,c.parent(),function(){k.trigger({type:"shown",relatedTarget:g})})},activate:function(e,d,h){var c=d.find("> .active"),g=h&&b.support.transition&&c.hasClass("fade");function f(){c.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");e.addClass("active");if(g){e[0].offsetWidth;e.addClass("in")}else{e.removeClass("fade")}if(e.parent(".dropdown-menu")){e.closest("li.dropdown").addClass("active")}h&&h()}g?c.one(b.support.transition.end,f):f();c.removeClass("in")}};b.fn.tab=function(c){return this.each(function(){var e=b(this),d=e.data("tab");if(!d){e.data("tab",(d=new a(this)))}if(typeof c=="string"){d[c]()}})};b.fn.tab.Constructor=a;b(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(c){c.preventDefault();b(this).tab("show")})}(window.jQuery);!function(b){var a=function(d,c){this.init("tooltip",d,c)};a.prototype={constructor:a,init:function(f,e,d){var g,c;this.type=f;this.$element=b(e);this.options=this.getOptions(d);this.enabled=true;if(this.options.trigger=="click"){this.$element.on("click."+this.type,this.options.selector,b.proxy(this.toggle,this))}else{if(this.options.trigger!="manual"){g=this.options.trigger=="hover"?"mouseenter":"focus";c=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(g+"."+this.type,this.options.selector,b.proxy(this.enter,this));this.$element.on(c+"."+this.type,this.options.selector,b.proxy(this.leave,this))}}this.options.selector?(this._options=b.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(c){c=b.extend({},b.fn[this.type].defaults,c,this.$element.data());if(c.delay&&typeof c.delay=="number"){c.delay={show:c.delay,hide:c.delay}}return c},enter:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show){return c.show()}clearTimeout(this.timeout);c.hoverState="in";this.timeout=setTimeout(function(){if(c.hoverState=="in"){c.show()}},c.options.delay.show)},leave:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(this.timeout){clearTimeout(this.timeout)}if(!c.options.delay||!c.options.delay.hide){return c.hide()}c.hoverState="out";this.timeout=setTimeout(function(){if(c.hoverState=="out"){c.hide()}},c.options.delay.hide)},show:function(){var g,c,k,e,h,d,f;if(this.hasContent()&&this.enabled){g=this.tip();this.setContent();if(this.options.animation){g.addClass("fade")}d=typeof this.options.placement=="function"?this.options.placement.call(this,g[0],this.$element[0]):this.options.placement;c=/in/.test(d);g.detach().css({top:0,left:0,display:"block"}).insertAfter(this.$element);k=this.getPosition(c);e=g[0].offsetWidth;h=g[0].offsetHeight;switch(c?d.split(" ")[1]:d){case"bottom":f={top:k.top+k.height,left:k.left+k.width/2-e/2};break;case"top":f={top:k.top-h,left:k.left+k.width/2-e/2};break;case"left":f={top:k.top+k.height/2-h/2,left:k.left-e};break;case"right":f={top:k.top+k.height/2-h/2,left:k.left+k.width};break}g.offset(f).addClass(d).addClass("in")}},setContent:function(){var d=this.tip(),c=this.getTitle();d.find(".tooltip-inner")[this.options.html?"html":"text"](c);d.removeClass("fade in top bottom left right")},hide:function(){var c=this,d=this.tip();d.removeClass("in");function e(){var f=setTimeout(function(){d.off(b.support.transition.end).detach()},500);d.one(b.support.transition.end,function(){clearTimeout(f);d.detach()})}b.support.transition&&this.$tip.hasClass("fade")?e():d.detach();return this},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof(c.attr("data-original-title"))!="string"){c.attr("data-original-title",c.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(c){return b.extend({},(c?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,c=this.$element,d=this.options;e=c.attr("data-original-title")||(typeof d.title=="function"?d.title.call(c[0]):d.title);return e},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);c[c.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};b.fn.tooltip=function(c){return this.each(function(){var f=b(this),e=f.data("tooltip"),d=typeof c=="object"&&c;if(!e){f.data("tooltip",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.tooltip.Constructor=a;b.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:false}}(window.jQuery);!function(b){var a=function(d,c){this.init("popover",d,c)};a.prototype=b.extend({},b.fn.tooltip.Constructor.prototype,{constructor:a,setContent:function(){var e=this.tip(),d=this.getTitle(),c=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](d);e.find(".popover-content > *")[this.options.html?"html":"text"](c);e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var d,c=this.$element,e=this.options;d=c.attr("data-content")||(typeof e.content=="function"?e.content.call(c[0]):e.content);return d},tip:function(){if(!this.$tip){this.$tip=b(this.options.template)}return this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});b.fn.popover=function(c){return this.each(function(){var f=b(this),e=f.data("popover"),d=typeof c=="object"&&c;if(!e){f.data("popover",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.popover.Constructor=a;b.fn.popover.defaults=b.extend({},b.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);!function(b){var a=function(d,c){this.options=b.extend({},b.fn.affix.defaults,c);this.$window=b(window).on("scroll.affix.data-api",b.proxy(this.checkPosition,this)).on("click.affix.data-api",b.proxy(function(){setTimeout(b.proxy(this.checkPosition,this),1)},this));this.$element=b(d);this.checkPosition()};a.prototype.checkPosition=function(){if(!this.$element.is(":visible")){return}var g=b(document).height(),k=this.$window.scrollTop(),c=this.$element.offset(),l=this.options.offset,e=l.bottom,f=l.top,h="affix affix-top affix-bottom",d;if(typeof l!="object"){e=f=l}if(typeof f=="function"){f=l.top()}if(typeof e=="function"){e=l.bottom()}d=this.unpin!=null&&(k+this.unpin<=c.top)?false:e!=null&&(c.top+this.$element.height()>=g-e)?"bottom":f!=null&&k<=f?"top":false;if(this.affixed===d){return}this.affixed=d;this.unpin=d=="bottom"?c.top-k:null;this.$element.removeClass(h).addClass("affix"+(d?"-"+d:""))};b.fn.affix=function(c){return this.each(function(){var f=b(this),e=f.data("affix"),d=typeof c=="object"&&c;if(!e){f.data("affix",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.affix.Constructor=a;b.fn.affix.defaults={offset:0};b(window).on("load",function(){b('[data-spy="affix"]').each(function(){var d=b(this),c=d.data();c.offset=c.offset||{};c.offsetBottom&&(c.offset.bottom=c.offsetBottom);c.offsetTop&&(c.offset.top=c.offsetTop);d.affix(c)})})}(window.jQuery);!function(c){var b='[data-dismiss="alert"]',a=function(d){c(d).on("click",b,this.close)};a.prototype.close=function(k){var h=c(this),f=h.attr("data-target"),g;if(!f){f=h.attr("href");f=f&&f.replace(/.*(?=#[^\s]*$)/,"")}g=c(f);k&&k.preventDefault();g.length||(g=h.hasClass("alert")?h:h.parent());g.trigger(k=c.Event("close"));if(k.isDefaultPrevented()){return}g.removeClass("in");function d(){g.trigger("closed").remove()}c.support.transition&&g.hasClass("fade")?g.on(c.support.transition.end,d):d()};c.fn.alert=function(d){return this.each(function(){var f=c(this),e=f.data("alert");if(!e){f.data("alert",(e=new a(this)))}if(typeof d=="string"){e[d].call(f)}})};c.fn.alert.Constructor=a;c(document).on("click.alert.data-api",b,a.prototype.close)}(window.jQuery);!function(b){var a=function(d,c){this.$element=b(d);this.options=b.extend({},b.fn.button.defaults,c)};a.prototype.setState=function(f){var h="disabled",c=this.$element,e=c.data(),g=c.is("input")?"val":"html";f=f+"Text";e.resetText||c.data("resetText",c[g]());c[g](e[f]||this.options[f]);setTimeout(function(){f=="loadingText"?c.addClass(h).attr(h,h):c.removeClass(h).removeAttr(h)},0)};a.prototype.toggle=function(){var c=this.$element.closest('[data-toggle="buttons-radio"]');c&&c.find(".active").removeClass("active");this.$element.toggleClass("active")};b.fn.button=function(c){return this.each(function(){var f=b(this),e=f.data("button"),d=typeof c=="object"&&c;if(!e){f.data("button",(e=new a(this,d)))}if(c=="toggle"){e.toggle()}else{if(c){e.setState(c)}}})};b.fn.button.defaults={loadingText:"loading..."};b.fn.button.Constructor=a;b(document).on("click.button.data-api","[data-toggle^=button]",function(d){var c=b(d.target);if(!c.hasClass("btn")){c=c.closest(".btn")}c.button("toggle")})}(window.jQuery);!function(a){var b=function(d,c){this.$element=a(d);this.options=a.extend({},a.fn.collapse.defaults,c);if(this.options.parent){this.$parent=a(this.options.parent)}this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var c=this.$element.hasClass("width");return c?"width":"height"},show:function(){var f,c,e,d;if(this.transitioning){return}f=this.dimension();c=a.camelCase(["scroll",f].join("-"));e=this.$parent&&this.$parent.find("> .accordion-group > .in");if(e&&e.length){d=e.data("collapse");if(d&&d.transitioning){return}e.collapse("hide");d||e.data("collapse",null)}this.$element[f](0);this.transition("addClass",a.Event("show"),"shown");a.support.transition&&this.$element[f](this.$element[0][c])},hide:function(){var c;if(this.transitioning){return}c=this.dimension();this.reset(this.$element[c]());this.transition("removeClass",a.Event("hide"),"hidden");this.$element[c](0)},reset:function(c){var d=this.dimension();this.$element.removeClass("collapse")[d](c||"auto")[0].offsetWidth;this.$element[c!==null?"addClass":"removeClass"]("collapse");return this},transition:function(g,d,e){var f=this,c=function(){if(d.type=="show"){f.reset()}f.transitioning=0;f.$element.trigger(e)};this.$element.trigger(d);if(d.isDefaultPrevented()){return}this.transitioning=1;this.$element[g]("in");a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,c):c()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};a.fn.collapse=function(c){return this.each(function(){var f=a(this),e=f.data("collapse"),d=typeof c=="object"&&c;if(!e){f.data("collapse",(e=new b(this,d)))}if(typeof c=="string"){e[c]()}})};a.fn.collapse.defaults={toggle:true};a.fn.collapse.Constructor=b;a(document).on("click.collapse.data-api","[data-toggle=collapse]",function(h){var g=a(this),c,f=g.attr("data-target")||h.preventDefault()||(c=g.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),d=a(f).data("collapse")?"toggle":g.data();g[a(f).hasClass("in")?"addClass":"removeClass"]("collapsed");a(f).collapse(d)})}(window.jQuery);!function(a){var b=function(d,c){this.$element=a(d);this.options=c;this.options.slide&&this.slide(this.options.slide);this.options.pause=="hover"&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.prototype={cycle:function(c){if(!c){this.paused=false}this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval));return this},to:function(g){var c=this.$element.find(".item.active"),d=c.parent().children(),e=d.index(c),f=this;if(g>(d.length-1)||g<0){return}if(this.sliding){return this.$element.one("slid",function(){f.to(g)})}if(e==g){return this.pause().cycle()}return this.slide(g>e?"next":"prev",a(d[g]))},pause:function(c){if(!c){this.paused=true}if(this.$element.find(".next, .prev").length&&a.support.transition.end){this.$element.trigger(a.support.transition.end);this.cycle()}clearInterval(this.interval);this.interval=null;return this},next:function(){if(this.sliding){return}return this.slide("next")},prev:function(){if(this.sliding){return}return this.slide("prev")},slide:function(l,d){var n=this.$element.find(".item.active"),c=d||n[l](),k=this.interval,m=l=="next"?"left":"right",f=l=="next"?"first":"last",g=this,h;this.sliding=true;k&&this.pause();c=c.length?c:this.$element.find(".item")[f]();h=a.Event("slide",{relatedTarget:c[0]});if(c.hasClass("active")){return}if(a.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(h);if(h.isDefaultPrevented()){return}c.addClass(l);c[0].offsetWidth;n.addClass(m);c.addClass(m);this.$element.one(a.support.transition.end,function(){c.removeClass([l,m].join(" ")).addClass("active");n.removeClass(["active",m].join(" "));g.sliding=false;setTimeout(function(){g.$element.trigger("slid")},0)})}else{this.$element.trigger(h);if(h.isDefaultPrevented()){return}n.removeClass("active");c.addClass("active");this.sliding=false;this.$element.trigger("slid")}k&&this.cycle();return this}};a.fn.carousel=function(c){return this.each(function(){var g=a(this),f=g.data("carousel"),d=a.extend({},a.fn.carousel.defaults,typeof c=="object"&&c),e=typeof c=="string"?c:d.slide;if(!f){g.data("carousel",(f=new b(this,d)))}if(typeof c=="number"){f.to(c)}else{if(e){f[e]()}else{if(d.interval){f.cycle()}}}})};a.fn.carousel.defaults={interval:5000,pause:"hover"};a.fn.carousel.Constructor=b;a(document).on("click.carousel.data-api","[data-slide]",function(h){var g=a(this),d,c=a(g.attr("data-target")||(d=g.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=a.extend({},c.data(),g.data());c.carousel(f);h.preventDefault()})}(window.jQuery);!function(a){var b=function(d,c){this.$element=a(d);this.options=a.extend({},a.fn.typeahead.defaults,c);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=a(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=false;this.listen()};b.prototype={constructor:b,select:function(){var c=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(c)).change();return this.hide()},updater:function(c){return c},show:function(){var c=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:c.top+c.height,left:c.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(d){var c;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this}c=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source;return c?this.process(c):this},process:function(c){var d=this;c=a.grep(c,function(e){return d.matcher(e)});c=this.sorter(c);if(!c.length){return this.shown?this.hide():this}return this.render(c.slice(0,this.options.items)).show()},matcher:function(c){return ~c.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var f=[],d=[],c=[],g;while(g=e.shift()){if(!g.toLowerCase().indexOf(this.query.toLowerCase())){f.push(g)}else{if(~g.indexOf(this.query)){d.push(g)}else{c.push(g)}}}return f.concat(d,c)},highlighter:function(c){var d=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return c.replace(new RegExp("("+d+")","ig"),function(e,f){return"<strong>"+f+"</strong>"})},render:function(c){var d=this;c=a(c).map(function(e,f){e=a(d.options.item).attr("data-value",f);e.find("a").html(d.highlighter(f));return e[0]});c.first().addClass("active");this.$menu.html(c);return this},next:function(d){var e=this.$menu.find(".active").removeClass("active"),c=e.next();if(!c.length){c=a(this.$menu.find("li")[0])}c.addClass("active")},prev:function(d){var e=this.$menu.find(".active").removeClass("active"),c=e.prev();if(!c.length){c=this.$menu.find("li").last()}c.addClass("active")},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this));if(this.eventSupported("keydown")){this.$element.on("keydown",a.proxy(this.keydown,this))}this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this))},eventSupported:function(c){var d=c in this.$element;if(!d){this.$element.setAttribute(c,"return;");d=typeof this.$element[c]==="function"}return d},move:function(c){if(!this.shown){return}switch(c.keyCode){case 9:case 13:case 27:c.preventDefault();break;case 38:c.preventDefault();this.prev();break;case 40:c.preventDefault();this.next();break}c.stopPropagation()},keydown:function(c){this.suppressKeyPressRepeat=!~a.inArray(c.keyCode,[40,38,9,13,27]);this.move(c)},keypress:function(c){if(this.suppressKeyPressRepeat){return}this.move(c)},keyup:function(c){switch(c.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:if(!this.shown){return}this.hide();break;default:this.lookup()}c.stopPropagation();c.preventDefault()},blur:function(d){var c=this;setTimeout(function(){c.hide()},150)},click:function(c){c.stopPropagation();c.preventDefault();this.select()},mouseenter:function(c){this.$menu.find(".active").removeClass("active");a(c.currentTarget).addClass("active")}};a.fn.typeahead=function(c){return this.each(function(){var f=a(this),e=f.data("typeahead"),d=typeof c=="object"&&c;if(!e){f.data("typeahead",(e=new b(this,d)))}if(typeof c=="string"){e[c]()}})};a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};a.fn.typeahead.Constructor=b;a(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(d){var c=a(this);if(c.data("typeahead")){return}d.preventDefault();c.typeahead(c.data())})}(window.jQuery);(function(a,b){if(typeof exports==="object"){b(exports)}else{if(typeof define==="function"&&define.amd){define(["exports"],b)}else{b(a)}}}(this,function(g){var r="0.3.0";function o(s){this._targetElement=s;this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",tooltipPosition:"bottom"}}function q(y){var w=y.querySelectorAll("*[data-intro]"),s=[],z=this;if(w.length<1){return false}for(var v=0,t=w.length;v<t;v++){var x=w[v];s.push({element:x,intro:x.getAttribute("data-intro"),step:parseInt(x.getAttribute("data-step"),10),position:x.getAttribute("data-position")||this._options.tooltipPosition})}s.sort(function(C,B){return C.step-B.step});z._introItems=s;if(a.call(z,y)){h.call(z);var A=y.querySelector(".introjs-skipbutton"),u=y.querySelector(".introjs-nextbutton");z._onKeyDown=function(B){if(B.keyCode===27){f.call(z,y)}else{if(B.keyCode===37){n.call(z)}else{if(B.keyCode===39||B.keyCode===13){h.call(z)}}}};if(window.addEventListener){window.addEventListener("keydown",z._onKeyDown,true)}else{if(document.attachEvent){document.attachEvent("onkeydown",z._onKeyDown)}}}return false}function k(s){this._currentStep=s-2;if(typeof(this._introItems)!=="undefined"){h.call(this)}}function h(){if(typeof(this._currentStep)==="undefined"){this._currentStep=0}else{++this._currentStep}if((this._introItems.length)<=this._currentStep){if(typeof(this._introCompleteCallback)==="function"){this._introCompleteCallback.call(this)}f.call(this,this._targetElement);return}m.call(this,this._introItems[this._currentStep].element)}function n(){if(this._currentStep===0){return false}m.call(this,this._introItems[--this._currentStep].element)}function f(u){var s=u.querySelector(".introjs-overlay");s.style.opacity=0;setTimeout(function(){if(s.parentNode){s.parentNode.removeChild(s)}},500);var t=u.querySelector(".introjs-helperLayer");if(t){t.parentNode.removeChild(t)}var v=document.querySelector(".introjs-showElement");if(v){v.className=v.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"")}if(window.removeEventListener){window.removeEventListener("keydown",this._onKeyDown,true)}else{if(document.detachEvent){document.detachEvent("onkeydown",this._onKeyDown)}}this._currentStep=undefined;if(this._introExitCallback!=undefined){this._introExitCallback.call(this)}}function d(u,v,s){var w=p(v);v.style.top=null;v.style.right=null;v.style.bottom=null;v.style.left=null;if(!this._introItems[this._currentStep]){return}var t=this._introItems[this._currentStep].position;switch(t){case"top":v.style.left="15px";v.style.top="-"+(w.height+10)+"px";s.className="introjs-arrow bottom";break;case"right":v.style.right="-"+(w.width+10)+"px";s.className="introjs-arrow left";break;case"left":v.style.top="15px";v.style.left="-"+(w.width+10)+"px";s.className="introjs-arrow right";break;case"bottom":default:v.style.bottom="-"+(w.height+10)+"px";s.className="introjs-arrow top";break}}function m(C){if(typeof(this._introChangeCallback)!=="undefined"){this._introChangeCallback.call(this,C)}var F=this,z=document.querySelector(".introjs-helperLayer"),D=p(C);if(z!=null){var K=z.querySelector(".introjs-helperNumberLayer"),w=z.querySelector(".introjs-tooltiptext"),v=z.querySelector(".introjs-arrow"),I=z.querySelector(".introjs-tooltip");I.style.opacity=0;z.setAttribute("style","width: "+(D.width+10)+"px; height:"+(D.height+10)+"px; top:"+(D.top-5)+"px;left: "+(D.left-5)+"px;");var H=document.querySelector(".introjs-showElement");H.className=H.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"");if(F._lastShowElementTimer){clearTimeout(F._lastShowElementTimer)}F._lastShowElementTimer=setTimeout(function(){K.innerHTML=C.getAttribute("data-step");w.innerHTML=C.getAttribute("data-intro");d.call(F,C,I,v);I.style.opacity=1},350)}else{var J=document.createElement("div"),G=document.createElement("span"),y=document.createElement("div"),x=document.createElement("div");J.className="introjs-helperLayer";J.setAttribute("style","width: "+(D.width+10)+"px; height:"+(D.height+10)+"px; top:"+(D.top-5)+"px;left: "+(D.left-5)+"px;");this._targetElement.appendChild(J);G.className="introjs-helperNumberLayer";y.className="introjs-arrow";x.className="introjs-tooltip";G.innerHTML=C.getAttribute("data-step");x.innerHTML='<div class="introjs-tooltiptext">'+C.getAttribute("data-intro")+'</div><div class="introjs-tooltipbuttons"></div>';J.appendChild(G);x.appendChild(y);J.appendChild(x);var B=document.createElement("a");B.onclick=function(){h.call(F)};B.className="introjs-button introjs-nextbutton";B.href="javascript:void(0);";B.innerHTML=this._options.nextLabel;var s=document.createElement("a");s.onclick=function(){n.call(F)};s.className="introjs-button introjs-prevbutton";s.href="javascript:void(0);";s.innerHTML=this._options.prevLabel;var M=document.createElement("a");M.className="introjs-button introjs-skipbutton";M.href="javascript:void(0);";M.innerHTML=this._options.skipLabel;M.onclick=function(){f.call(F,F._targetElement)};var L=x.querySelector(".introjs-tooltipbuttons");L.appendChild(M);L.appendChild(s);L.appendChild(B);d.call(F,C,x,y)}C.className+=" introjs-showElement";var u="";if(C.currentStyle){u=C.currentStyle.position}else{if(document.defaultView&&document.defaultView.getComputedStyle){u=document.defaultView.getComputedStyle(C,null).getPropertyValue("position")}}u=u.toLowerCase();if(u!=="absolute"&&u!=="relative"){C.className+=" introjs-relativePosition"}if(!c(C)){var t=C.getBoundingClientRect(),E=t.bottom-(t.bottom-t.top),A=t.bottom-l().height;if(E<0){window.scrollBy(0,E-30)}else{window.scrollBy(0,A+100)}}}function l(){if(window.innerWidth!=undefined){return{width:window.innerWidth,height:window.innerHeight}}else{var s=document.documentElement;return{width:s.clientWidth,height:s.clientHeight}}}function c(s){var t=s.getBoundingClientRect();return(t.top>=0&&t.left>=0&&(t.bottom+80)<=window.innerHeight&&t.right<=window.innerWidth)}function a(v){var s=document.createElement("div"),w="",t=this;s.className="introjs-overlay";if(v.tagName.toLowerCase()==="body"){w+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;";s.setAttribute("style",w)}else{var u=p(v);if(u){w+="width: "+u.width+"px; height:"+u.height+"px; top:"+u.top+"px;left: "+u.left+"px;";s.setAttribute("style",w)}}v.appendChild(s);s.onclick=function(){f.call(t,v)};setTimeout(function(){w+="opacity: .5;";s.setAttribute("style",w)},10);return true}function p(u){var v={};v.width=u.offsetWidth;v.height=u.offsetHeight;var t=0;var s=0;while(u&&!isNaN(u.offsetLeft)&&!isNaN(u.offsetTop)){t+=u.offsetLeft;s+=u.offsetTop;u=u.offsetParent}v.top=s;v.left=t;return v}function b(v,u){var t={};for(var s in v){t[s]=v[s]}for(var s in u){t[s]=u[s]}return t}var e=function(t){if(typeof(t)==="object"){return new o(t)}else{if(typeof(t)==="string"){var s=document.querySelector(t);if(s){return new o(s)}else{throw new Error("There is no element with given selector.")}}else{return new o(document.body)}}};e.version=r;e.fn=o.prototype={clone:function(){return new o(this)},setOption:function(s,t){this._options[s]=t;return this},setOptions:function(s){this._options=b(this._options,s);return this},start:function(){q.call(this,this._targetElement);return this},goToStep:function(s){k.call(this,s);return this},exit:function(){f.call(this,this._targetElement)},onchange:function(s){if(typeof(s)==="function"){this._introChangeCallback=s}else{throw new Error("Provided callback for onchange was not a function.")}return this},oncomplete:function(s){if(typeof(s)==="function"){this._introCompleteCallback=s}else{throw new Error("Provided callback for oncomplete was not a function.")}return this},onexit:function(s){if(typeof(s)==="function"){this._introExitCallback=s}else{throw new Error("Provided callback for onexit was not a function.")}return this}};g.introJs=e;return e}));
/*!
 * jQuery Color Animations v2.0pre
 * http://jquery.org/
 *
 * Copyright 2011 John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(q,c){var l="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),g=/^([\-+])=\s*(\d+\.?\d*)/,f=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(r){return[r[1],r[2],r[3],r[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(r){return[2.55*r[1],2.55*r[2],2.55*r[3],r[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(r){return[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(r){return[parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(r){return[r[1],r[2]/100,r[3]/100,r[4]]}}],d=q.Color=function(s,t,r,u){return new q.Color.fn.parse(s,t,r,u)},k={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:true},green:{idx:1,type:"byte",empty:true},blue:{idx:2,type:"byte",empty:true},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:true},saturation:{idx:1,type:"percent",empty:true},lightness:{idx:2,type:"percent",empty:true}}}},p={"byte":{floor:true,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:true}},n=k.rgba.props,o=d.support={},a,m=q.each;k.hsla.props.alpha=n.alpha;function h(t,v,s){var r=p[v.type]||{},u=v.empty||s;if(u&&t==null){return null}if(v.def&&t==null){return v.def}if(r.floor){t=~~t}else{t=parseFloat(t)}if(t==null||isNaN(t)){return v.def}if(r.mod){t=t%r.mod;return t<0?r.mod+t:t}return r.min>t?r.min:r.max<t?r.max:t}function e(r){var t=d(),s=t._rgba=[];r=r.toLowerCase();m(f,function(z,A){var y=A.re.exec(r),x=y&&A.parse(y),w,v=A.space||"rgba",u=k[v].cache;if(x){w=t[v](x);t[u]=w[u];s=t._rgba=w._rgba;return false}});if(s.length!==0){if(Math.max.apply(Math,s)===0){q.extend(s,a.transparent)}return t}if(r=a[r]){return r}}d.fn=d.prototype={constructor:d,parse:function(y,w,r,x){if(y===c){this._rgba=[null,null,null,null];return this}if(y instanceof q||y.nodeType){y=y instanceof q?y.css(w):q(y).css(w);w=c}var v=this,t=q.type(y),s=this._rgba=[],u;if(w!==c){y=[y,w,r,x];t="array"}if(t==="string"){return this.parse(e(y)||a._default)}if(t==="array"){m(n,function(z,A){s[A.idx]=h(y[A.idx],A)});return this}if(t==="object"){if(y instanceof d){m(k,function(z,A){if(y[A.cache]){v[A.cache]=y[A.cache].slice()}})}else{m(k,function(z,A){m(A.props,function(C,D){var B=A.cache;if(!v[B]&&A.to){if(y[C]==null||C==="alpha"){return}v[B]=A.to(v._rgba)}v[B][D.idx]=h(y[C],D,true)})})}return this}},is:function(t){var s=d(t),u=true,r=this;m(k,function(v,x){var w=s[x.cache],y;if(w){y=r[x.cache]||x.to&&x.to(r._rgba)||[];m(x.props,function(z,A){if(w[A.idx]!=null){u=(w[A.idx]===y[A.idx]);return u}})}return u});return u},_space:function(){var r=[],s=this;m(k,function(t,u){if(s[u.cache]){r.push(t)}});return r.pop()},transition:function(s,x){var t=d(s),u=t._space(),v=k[u],w=this[v.cache]||v.to(this._rgba),r=w.slice();t=t[v.cache];m(v.props,function(B,D){var A=D.idx,z=w[A],y=t[A],C=p[D.type]||{};if(y===null){return}if(z===null){r[A]=y}else{if(C.mod){if(y-z>C.mod/2){z+=C.mod}else{if(z-y>C.mod/2){z-=C.mod}}}r[D.idx]=h((y-z)*x+z,D)}});return this[u](r)},blend:function(u){if(this._rgba[3]===1){return this}var t=this._rgba.slice(),s=t.pop(),r=d(u)._rgba;return d(q.map(t,function(w,x){return(1-s)*r[x]+s*w}))},toRgbaString:function(){var s="rgba(",r=q.map(this._rgba,function(t,u){return t==null?(u>2?1:0):t});if(r[3]===1){r.pop();s="rgb("}return s+r.join(",")+")"},toHslaString:function(){var s="hsla(",r=q.map(this.hsla(),function(t,u){if(t==null){t=u>2?1:0}if(u&&u<3){t=Math.round(t*100)+"%"}return t});if(r[3]===1){r.pop();s="hsl("}return s+r.join(",")+")"},toHexString:function(r){var s=this._rgba.slice(),t=s.pop();if(r){s.push(~~(t*255))}return"#"+q.map(s,function(u,w){u=(u||0).toString(16);return u.length===1?"0"+u:u}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}};d.fn.parse.prototype=d.fn;function b(t,s,r){r=(r+1)%1;if(r*6<1){return t+(s-t)*6*r}if(r*2<1){return s}if(r*3<2){return t+(s-t)*((2/3)-r)*6}return t}k.hsla.to=function(v){if(v[0]==null||v[1]==null||v[2]==null){return[null,null,null,v[3]]}var t=v[0]/255,y=v[1]/255,z=v[2]/255,B=v[3],A=Math.max(t,y,z),w=Math.min(t,y,z),C=A-w,D=A+w,u=D*0.5,x,E;if(w===A){x=0}else{if(t===A){x=(60*(y-z)/C)+360}else{if(y===A){x=(60*(z-t)/C)+120}else{x=(60*(t-y)/C)+240}}}if(u===0||u===1){E=u}else{if(u<=0.5){E=C/D}else{E=C/(2-D)}}return[Math.round(x)%360,E,u,B==null?1:B]};k.hsla.from=function(v){if(v[0]==null||v[1]==null||v[2]==null){return[null,null,null,v[3]]}var y=v[0]/360,C=v[1],x=v[2],B=v[3],u=x<=0.5?x*(1+C):x+C-x*C,w=2*x-u,t,z,A;return[Math.round(b(w,u,y+(1/3))*255),Math.round(b(w,u,y)*255),Math.round(b(w,u,y-(1/3))*255),B]};m(k,function(s,u){var t=u.props,r=u.cache,w=u.to,v=u.from;d.fn[s]=function(B){if(w&&!this[r]){this[r]=w(this._rgba)}if(B===c){return this[r].slice()}var A=q.type(B),x=(A==="array"||A==="object")?B:arguments,z=this[r].slice(),y;m(t,function(C,E){var D=x[A==="object"?C:E.idx];if(D==null){D=z[E.idx]}z[E.idx]=h(D,E)});if(v){y=d(v(z));y[r]=z;return y}else{return d(z)}};m(t,function(x,y){if(d.fn[x]){return}d.fn[x]=function(C){var E=q.type(C),B=(x==="alpha"?(this._hsla?"hsla":"rgba"):s),A=this[B](),D=A[y.idx],z;if(E==="undefined"){return D}if(E==="function"){C=C.call(this,D);E=q.type(C)}if(C==null&&y.empty){return this}if(E==="string"){z=g.exec(C);if(z){C=D+parseFloat(z[2])*(z[1]==="+"?1:-1)}}A[y.idx]=C;return this[B](A)}})});m(l,function(r,s){q.cssHooks[s]={set:function(w,x){var u,t,v;if(q.type(x)!=="string"||(u=e(x))){x=d(u||x);if(!o.rgba&&x._rgba[3]!==1){v=s==="backgroundColor"?w.parentNode:w;do{t=q.curCSS(v,"backgroundColor")}while((t===""||t==="transparent")&&(v=v.parentNode)&&v.style);x=x.blend(t&&t!=="transparent"?t:"_default")}x=x.toRgbaString()}w.style[s]=x}};q.fx.step[s]=function(t){if(!t.colorInit){t.start=d(t.elem,s);t.end=d(t.end);t.colorInit=true}q.cssHooks[s].set(t.elem,t.start.transition(t.end,t.pos))}});q(function(){var s=document.createElement("div"),r=s.style;r.cssText="background-color:rgba(1,1,1,.5)";o.rgba=r.backgroundColor.indexOf("rgba")>-1});a=q.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(a){a.Jcrop=function(e,E){var L=a.extend({},a.Jcrop.defaults),ai,al=navigator.userAgent.toLowerCase(),af=/msie/.test(al),ak=/msie [1-6]\./.test(al);function p(ax){return Math.round(ax)+"px"}function G(ax){return L.baseClass+"-"+ax}function H(){return a.fx.step.hasOwnProperty("backgroundColor")}function I(ax){var ay=a(ax).offset();return[ay.left,ay.top]}function J(ax){return[(ax.pageX-ai[0]),(ax.pageY-ai[1])]}function D(ax){if(typeof(ax)!=="object"){ax={}}L=a.extend(L,ax);a.each(["onChange","onSelect","onRelease","onDblClick"],function(ay,az){if(typeof(L[az])!=="function"){L[az]=function(){}}})}function g(az,aC,aB){ai=I(av);S.setCursor(az==="move"?az:az+"-resize");if(az==="move"){return S.activateHandlers(U(aC),t,aB)}var ax=ad.getFixed();var ay=v(az);var aA=ad.getCorner(v(ay));ad.setPressed(ad.getCorner(ay));ad.setCurrent(aA);S.activateHandlers(K(az,ax),t,aB)}function K(ay,ax){return function(az){if(!L.aspectRatio){switch(ay){case"e":az[1]=ax.y2;break;case"w":az[1]=ax.y2;break;case"n":az[0]=ax.x2;break;case"s":az[0]=ax.x2;break}}else{switch(ay){case"e":az[1]=ax.y+1;break;case"w":az[1]=ax.y+1;break;case"n":az[0]=ax.x+1;break;case"s":az[0]=ax.x+1;break}}ad.setCurrent(az);Z.update()}}function U(ay){var ax=ay;au.watchKeys();return function(az){ad.moveOffset([az[0]-ax[0],az[1]-ax[1]]);ax=az;Z.update()}}function v(ax){switch(ax){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function c(ax){return function(ay){if(L.disabled){return false}if((ax==="move")&&!L.allowMove){return false}ai=I(av);u=true;g(ax,J(ay));ay.stopPropagation();ay.preventDefault();return false}}function X(aB,ay,aA){var ax=aB.width(),az=aB.height();if((ax>ay)&&ay>0){ax=ay;az=(ay/aB.width())*aB.height()}if((az>aA)&&aA>0){az=aA;ax=(aA/aB.height())*aB.width()}P=aB.width()/ax;f=aB.height()/az;aB.width(ax).height(az)}function ab(ax){return{x:ax.x*P,y:ax.y*f,x2:ax.x2*P,y2:ax.y2*f,w:ax.w*P,h:ax.h*f}}function t(ay){var ax=ad.getFixed();if((ax.w>L.minSelect[0])&&(ax.h>L.minSelect[1])){Z.enableHandles();Z.done()}else{Z.release()}S.setCursor(L.allowSelect?"crosshair":"default")}function ah(ax){if(L.disabled){return false}if(!L.allowSelect){return false}u=true;ai=I(av);Z.disableHandles();S.setCursor("crosshair");var ay=J(ax);ad.setPressed(ay);Z.update();S.activateHandlers(at,t,ax.type.substring(0,5)==="touch");au.watchKeys();ax.stopPropagation();ax.preventDefault();return false}function at(ax){ad.setCurrent(ax);Z.update()}function aj(){var ax=a("<div></div>").addClass(G("tracker"));if(af){ax.css({opacity:0,backgroundColor:"white"})}return ax}if(typeof(e)!=="object"){e=a(e)[0]}if(typeof(E)!=="object"){E={}}D(E);var l={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0};var aa=a(e),an=true;if(e.tagName=="IMG"){if(aa[0].width!=0&&aa[0].height!=0){aa.width(aa[0].width);aa.height(aa[0].height)}else{var y=new Image();y.src=aa[0].src;aa.width(y.width);aa.height(y.height)}var av=aa.clone().removeAttr("id").css(l).show();av.width(aa.width());av.height(aa.height());aa.after(av).hide()}else{av=aa.css(l).show();an=false;if(L.shade===null){L.shade=true}}X(av,L.boxWidth,L.boxHeight);var T=av.width(),R=av.height(),ac=a("<div />").width(T).height(R).addClass(G("holder")).css({position:"relative",backgroundColor:L.bgColor}).insertAfter(aa).append(av);if(L.addClass){ac.addClass(L.addClass)}var M=a("<div />"),o=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),O=a("<div />").width("100%").height("100%").css("zIndex",320),C=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var ax=ad.getFixed();L.onDblClick.call(k,ax)}).insertBefore(av).append(o,O);if(an){M=a("<img />").attr("src",av.attr("src")).css(l).width(T).height(R),o.append(M)}if(ak){C.css({overflowY:"hidden"})}var x=L.boundary;var b=aj().width(T+(x*2)).height(R+(x*2)).css({position:"absolute",top:p(-x),left:p(-x),zIndex:290}).mousedown(ah);var ar=L.bgColor,ae=L.bgOpacity,B,ap,s,W,P,f,r=true,u,F,ag;ai=I(av);var V=(function(){function ax(){var aE={},aC=["touchstart","touchmove","touchend"],aD=document.createElement("div"),aB;try{for(aB=0;aB<aC.length;aB++){var az=aC[aB];az="on"+az;var aA=(az in aD);if(!aA){aD.setAttribute(az,"return;");aA=typeof aD[az]=="function"}aE[aC[aB]]=aA}return aE.touchstart&&aE.touchend&&aE.touchmove}catch(aF){return false}}function ay(){if((L.touchSupport===true)||(L.touchSupport===false)){return L.touchSupport}else{return ax()}}return{createDragger:function(az){return function(aA){if(L.disabled){return false}if((az==="move")&&!L.allowMove){return false}ai=I(av);u=true;g(az,J(V.cfilter(aA)),true);aA.stopPropagation();aA.preventDefault();return false}},newSelection:function(az){return ah(V.cfilter(az))},cfilter:function(az){az.pageX=az.originalEvent.changedTouches[0].pageX;az.pageY=az.originalEvent.changedTouches[0].pageY;return az},isSupported:ax,support:ay()}}());var ad=(function(){var az=0,aK=0,ay=0,aJ=0,aC,aA;function aE(aN){aN=aB(aN);ay=az=aN[0];aJ=aK=aN[1]}function aD(aN){aN=aB(aN);aC=aN[0]-ay;aA=aN[1]-aJ;ay=aN[0];aJ=aN[1]}function aM(){return[aC,aA]}function ax(aP){var aO=aP[0],aN=aP[1];if(0>az+aO){aO-=aO+az}if(0>aK+aN){aN-=aN+aK}if(R<aJ+aN){aN+=R-(aJ+aN)}if(T<ay+aO){aO+=T-(ay+aO)}az+=aO;ay+=aO;aK+=aN;aJ+=aN}function aF(aN){var aO=aL();switch(aN){case"ne":return[aO.x2,aO.y];case"nw":return[aO.x,aO.y];case"se":return[aO.x2,aO.y2];case"sw":return[aO.x,aO.y2]}}function aL(){if(!L.aspectRatio){return aI()}var aP=L.aspectRatio,aW=L.minSize[0]/P,aO=L.maxSize[0]/P,aZ=L.maxSize[1]/f,aQ=ay-az,aY=aJ-aK,aR=Math.abs(aQ),aS=Math.abs(aY),aU=aR/aS,aN,aV,aX,aT;if(aO===0){aO=T*10}if(aZ===0){aZ=R*10}if(aU<aP){aV=aJ;aX=aS*aP;aN=aQ<0?az-aX:aX+az;if(aN<0){aN=0;aT=Math.abs((aN-az)/aP);aV=aY<0?aK-aT:aT+aK}else{if(aN>T){aN=T;aT=Math.abs((aN-az)/aP);aV=aY<0?aK-aT:aT+aK}}}else{aN=ay;aT=aR/aP;aV=aY<0?aK-aT:aK+aT;if(aV<0){aV=0;aX=Math.abs((aV-aK)*aP);aN=aQ<0?az-aX:aX+az}else{if(aV>R){aV=R;aX=Math.abs(aV-aK)*aP;aN=aQ<0?az-aX:aX+az}}}if(aN>az){if(aN-az<aW){aN=az+aW}else{if(aN-az>aO){aN=az+aO}}if(aV>aK){aV=aK+(aN-az)/aP}else{aV=aK-(aN-az)/aP}}else{if(aN<az){if(az-aN<aW){aN=az-aW}else{if(az-aN>aO){aN=az-aO}}if(aV>aK){aV=aK+(az-aN)/aP}else{aV=aK-(az-aN)/aP}}}if(aN<0){az-=aN;aN=0}else{if(aN>T){az-=aN-T;aN=T}}if(aV<0){aK-=aV;aV=0}else{if(aV>R){aK-=aV-R;aV=R}}return aH(aG(az,aK,aN,aV))}function aB(aN){if(aN[0]<0){aN[0]=0}if(aN[1]<0){aN[1]=0}if(aN[0]>T){aN[0]=T}if(aN[1]>R){aN[1]=R}return[Math.round(aN[0]),Math.round(aN[1])]}function aG(aQ,aS,aP,aR){var aU=aQ,aT=aP,aO=aS,aN=aR;if(aP<aQ){aU=aP;aT=aQ}if(aR<aS){aO=aR;aN=aS}return[aU,aO,aT,aN]}function aI(){var aO=ay-az,aN=aJ-aK,aP;if(B&&(Math.abs(aO)>B)){ay=(aO>0)?(az+B):(az-B)}if(ap&&(Math.abs(aN)>ap)){aJ=(aN>0)?(aK+ap):(aK-ap)}if(W/f&&(Math.abs(aN)<W/f)){aJ=(aN>0)?(aK+W/f):(aK-W/f)}if(s/P&&(Math.abs(aO)<s/P)){ay=(aO>0)?(az+s/P):(az-s/P)}if(az<0){ay-=az;az-=az}if(aK<0){aJ-=aK;aK-=aK}if(ay<0){az-=ay;ay-=ay}if(aJ<0){aK-=aJ;aJ-=aJ}if(ay>T){aP=ay-T;az-=aP;ay-=aP}if(aJ>R){aP=aJ-R;aK-=aP;aJ-=aP}if(az>T){aP=az-R;aJ-=aP;aK-=aP}if(aK>R){aP=aK-R;aJ-=aP;aK-=aP}return aH(aG(az,aK,ay,aJ))}function aH(aN){return{x:aN[0],y:aN[1],x2:aN[2],y2:aN[3],w:aN[2]-aN[0],h:aN[3]-aN[1]}}return{flipCoords:aG,setPressed:aE,setCurrent:aD,getOffset:aM,moveOffset:ax,getCorner:aF,getFixed:aL}}());var d=(function(){var aC=false,aH=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),aB={top:aD(),left:aD().height(R),right:aD().height(R),bottom:aD()};function aJ(aK,aL){aB.left.css({height:p(aL)});aB.right.css({height:p(aL)})}function az(){return aE(ad.getFixed())}function aE(aK){aB.top.css({left:p(aK.x),width:p(aK.w),height:p(aK.y)});aB.bottom.css({top:p(aK.y2),left:p(aK.x),width:p(aK.w),height:p(R-aK.y2)});aB.right.css({left:p(aK.x2),width:p(T-aK.x2)});aB.left.css({width:p(aK.x)})}function aD(){return a("<div />").css({position:"absolute",backgroundColor:L.shadeColor||L.bgColor}).appendTo(aH)}function aA(){if(!aC){aC=true;aH.insertBefore(av);az();Z.setBgOpacity(1,0,1);M.hide();aG(L.shadeColor||L.bgColor,1);if(Z.isAwake()){ay(L.bgOpacity,1)}else{ay(1,1)}}}function aG(aK,aL){h(ax(),aK,aL)}function aI(){if(aC){aH.remove();M.show();aC=false;if(Z.isAwake()){Z.setBgOpacity(L.bgOpacity,1,1)}else{Z.setBgOpacity(1,1,1);Z.disableHandles()}h(ac,0,1)}}function ay(aL,aK){if(aC){if(L.bgFade&&!aK){aH.animate({opacity:1-aL},{queue:false,duration:L.fadeTime})}else{aH.css({opacity:1-aL})}}}function aF(){L.shade?aA():aI();if(Z.isAwake()){ay(L.bgOpacity)}}function ax(){return aH.children()}return{update:az,updateRaw:aE,getShades:ax,setBgColor:aG,enable:aA,disable:aI,resize:aJ,refresh:aF,opacity:ay}}());var Z=(function(){var aI,aR=370,aE={},aU={},az={},aB=false;function aF(aY){var aZ=a("<div />").css({position:"absolute",opacity:L.borderOpacity}).addClass(G(aY));o.append(aZ);return aZ}function aA(aY,aZ){var a0=a("<div />").mousedown(c(aY)).css({cursor:aY+"-resize",position:"absolute",zIndex:aZ}).addClass("ord-"+aY);if(V.support){a0.bind("touchstart.jcrop",V.createDragger(aY))}O.append(a0);return a0}function aJ(aY){var aZ=L.handleSize,a0=aA(aY,aR++).css({opacity:L.handleOpacity}).addClass(G("handle"));if(aZ){a0.width(aZ).height(aZ)}return a0}function aP(aY){return aA(aY,aR++).addClass("jcrop-dragbar")}function aM(aY){var aZ;for(aZ=0;aZ<aY.length;aZ++){az[aY[aZ]]=aP(aY[aZ])}}function aQ(aY){var aZ,a0;for(a0=0;a0<aY.length;a0++){switch(aY[a0]){case"n":aZ="hline";break;case"s":aZ="hline bottom";break;case"e":aZ="vline right";break;case"w":aZ="vline";break}aE[aY[a0]]=aF(aZ)}}function aL(aY){var aZ;for(aZ=0;aZ<aY.length;aZ++){aU[aY[aZ]]=aJ(aY[aZ])}}function aH(aY,aZ){if(!L.shade){M.css({top:p(-aZ),left:p(-aY)})}C.css({top:p(aZ),left:p(aY)})}function aX(aY,aZ){C.width(Math.round(aY)).height(Math.round(aZ))}function aC(){var aY=ad.getFixed();ad.setPressed([aY.x,aY.y]);ad.setCurrent([aY.x2,aY.y2]);aV()}function aV(aY){if(aI){return aG(aY)}}function aG(aY){var aZ=ad.getFixed();aX(aZ.w,aZ.h);aH(aZ.x,aZ.y);if(L.shade){d.updateRaw(aZ)}aI||aW();if(aY){L.onSelect.call(k,ab(aZ))}else{L.onChange.call(k,ab(aZ))}}function ay(aZ,a0,aY){if(!aI&&!a0){return}if(L.bgFade&&!aY){av.animate({opacity:aZ},{queue:false,duration:L.fadeTime})}else{av.css("opacity",aZ)}}function aW(){C.show();if(L.shade){d.opacity(ae)}else{ay(ae,true)}aI=true}function aS(){aT();C.hide();if(L.shade){d.opacity(1)}else{ay(1)}aI=false;L.onRelease.call(k)}function ax(){if(aB){O.show()}}function aN(){aB=true;if(L.allowResize){O.show();return true}}function aT(){aB=false;O.hide()}function aO(aY){if(aY){F=true;aT()}else{F=false;aN()}}function aK(){aO(false);aC()}if(L.dragEdges&&a.isArray(L.createDragbars)){aM(L.createDragbars)}if(a.isArray(L.createHandles)){aL(L.createHandles)}if(L.drawBorders&&a.isArray(L.createBorders)){aQ(L.createBorders)}a(document).bind("touchstart.jcrop-ios",function(aY){if(a(aY.currentTarget).hasClass("jcrop-tracker")){aY.stopPropagation()}});var aD=aj().mousedown(c("move")).css({cursor:"move",position:"absolute",zIndex:360});if(V.support){aD.bind("touchstart.jcrop",V.createDragger("move"))}o.append(aD);aT();return{updateVisible:aV,update:aG,release:aS,refresh:aC,isAwake:function(){return aI},setCursor:function(aY){aD.css("cursor",aY)},enableHandles:aN,enableOnly:function(){aB=true},showHandles:ax,disableHandles:aT,animMode:aO,setBgOpacity:ay,done:aK}}());var S=(function(){var ay=function(){},aA=function(){},az=L.trackDocument;function aH(aI){b.css({zIndex:450});if(aI){a(document).bind("touchmove.jcrop",aG).bind("touchend.jcrop",aD)}else{if(az){a(document).bind("mousemove.jcrop",ax).bind("mouseup.jcrop",aB)}}}function aF(){b.css({zIndex:290});a(document).unbind(".jcrop")}function ax(aI){ay(J(aI));return false}function aB(aI){aI.preventDefault();aI.stopPropagation();if(u){u=false;aA(J(aI));if(Z.isAwake()){L.onSelect.call(k,ab(ad.getFixed()))}aF();ay=function(){};aA=function(){}}return false}function aC(aJ,aI,aK){u=true;ay=aJ;aA=aI;aH(aK);return false}function aG(aI){ay(J(V.cfilter(aI)));return false}function aD(aI){return aB(V.cfilter(aI))}function aE(aI){b.css("cursor",aI)}if(!az){b.mousemove(ax).mouseup(aB).mouseout(aB)}av.before(b);return{activateHandlers:aC,setCursor:aE}}());var au=(function(){var aA=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),aC=a("<div />").css({position:"absolute",overflow:"hidden"}).append(aA);function ay(){if(L.keySupport){aA.show();aA.focus()}}function aB(aD){aA.hide()}function az(aE,aD,aF){if(L.allowMove){ad.moveOffset([aD,aF]);Z.updateVisible(true)}aE.preventDefault();aE.stopPropagation()}function ax(aE){if(aE.ctrlKey||aE.metaKey){return true}ag=aE.shiftKey?true:false;var aD=ag?10:1;switch(aE.keyCode){case 37:az(aE,-aD,0);break;case 39:az(aE,aD,0);break;case 38:az(aE,0,-aD);break;case 40:az(aE,0,aD);break;case 27:if(L.allowSelect){Z.release()}break;case 9:return true}return false}if(L.keySupport){aA.keydown(ax).blur(aB);if(ak||!L.fixedSupport){aA.css({position:"absolute",left:"-20px"});aC.append(aA).insertBefore(av)}else{aA.insertBefore(av)}}return{watchKeys:ay}}());function n(ax){ac.removeClass().addClass(G("holder")).addClass(ax)}function w(aQ,aE){var aK=aQ[0]/P,az=aQ[1]/f,aJ=aQ[2]/P,ay=aQ[3]/f;if(F){return}var aI=ad.flipCoords(aK,az,aJ,ay),aO=ad.getFixed(),aL=[aO.x,aO.y,aO.x2,aO.y2],aB=aL,aA=L.animationDelay,aN=aI[0]-aL[0],aD=aI[1]-aL[1],aM=aI[2]-aL[2],aC=aI[3]-aL[3],aH=0,aF=L.swingSpeed;aK=aB[0];az=aB[1];aJ=aB[2];ay=aB[3];Z.animMode(true);var ax;function aG(){window.setTimeout(aP,aA)}var aP=(function(){return function(){aH+=(100-aH)/aF;aB[0]=Math.round(aK+((aH/100)*aN));aB[1]=Math.round(az+((aH/100)*aD));aB[2]=Math.round(aJ+((aH/100)*aM));aB[3]=Math.round(ay+((aH/100)*aC));if(aH>=99.8){aH=100}if(aH<100){aq(aB);aG()}else{Z.done();Z.animMode(false);if(typeof(aE)==="function"){aE.call(k)}}}}());aG()}function N(ax){aq([ax[0]/P,ax[1]/f,ax[2]/P,ax[3]/f]);L.onSelect.call(k,ab(ad.getFixed()));Z.enableHandles()}function aq(ax){ad.setPressed([ax[0],ax[1]]);ad.setCurrent([ax[2],ax[3]]);Z.update()}function m(){return ab(ad.getFixed())}function ao(){return ad.getFixed()}function z(ax){D(ax);Q()}function A(){L.disabled=true;Z.disableHandles();Z.setCursor("default");S.setCursor("default")}function Y(){L.disabled=false;Q()}function q(){Z.done();S.activateHandlers(null,null)}function am(){ac.remove();aa.show();aa.css("visibility","visible");a(e).removeData("Jcrop")}function aw(ay,az){Z.release();A();var ax=new Image();ax.onload=function(){var aA=ax.width;var aC=ax.height;var aD=L.boxWidth;var aB=L.boxHeight;av.width(aA).height(aC);av.attr("src",ay);M.attr("src",ay);X(av,aD,aB);T=av.width();R=av.height();M.width(T).height(R);b.width(T+(x*2)).height(R+(x*2));ac.width(T).height(R);d.resize(T,R);Y();if(typeof(az)==="function"){az.call(k)}};ax.src=ay}function h(aA,ax,ay){var az=ax||L.bgColor;if(L.bgFade&&H()&&L.fadeTime&&!ay){aA.animate({backgroundColor:az},{queue:false,duration:L.fadeTime})}else{aA.css("backgroundColor",az)}}function Q(ax){if(L.allowResize){if(ax){Z.enableOnly()}else{Z.enableHandles()}}else{Z.disableHandles()}S.setCursor(L.allowSelect?"crosshair":"default");Z.setCursor(L.allowMove?"move":"default");if(L.hasOwnProperty("trueSize")){P=L.trueSize[0]/T;f=L.trueSize[1]/R}if(L.hasOwnProperty("setSelect")){N(L.setSelect);Z.done();delete (L.setSelect)}d.refresh();if(L.bgColor!=ar){h(L.shade?d.getShades():ac,L.shade?(L.shadeColor||L.bgColor):L.bgColor);ar=L.bgColor}if(ae!=L.bgOpacity){ae=L.bgOpacity;if(L.shade){d.refresh()}else{Z.setBgOpacity(ae)}}B=L.maxSize[0]||0;ap=L.maxSize[1]||0;s=L.minSize[0]||0;W=L.minSize[1]||0;if(L.hasOwnProperty("outerImage")){av.attr("src",L.outerImage);delete (L.outerImage)}Z.refresh()}if(V.support){b.bind("touchstart.jcrop",V.newSelection)}O.hide();Q(true);var k={setImage:aw,animateTo:w,setSelect:N,setOptions:z,tellSelect:m,tellScaled:ao,setClass:n,disable:A,enable:Y,cancel:q,release:Z.release,destroy:am,focus:au.watchKeys,getBounds:function(){return[T*P,R*f]},getWidgetSize:function(){return[T,R]},getScaleFactor:function(){return[P,f]},getOptions:function(){return L},ui:{holder:ac,selection:C}};if(af){ac.bind("selectstart",function(){return false})}aa.data("Jcrop",k);return k};a.fn.Jcrop=function(b,d){var c;this.each(function(){if(a(this).data("Jcrop")){if(b==="api"){return a(this).data("Jcrop")}else{a(this).data("Jcrop").setOptions(b)}}else{if(this.tagName=="IMG"){a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"});c=a.Jcrop(this,b);if(a.isFunction(d)){d.call(c)}})}else{a(this).css({display:"block",visibility:"hidden"});c=a.Jcrop(this,b);if(a.isFunction(d)){d.call(c)}}}});return this};a.Jcrop.Loader=function(f,g,c){var d=a(f),b=d[0];function e(){if(b.complete){d.unbind(".jcloader");if(a.isFunction(g)){g.call(b)}}else{window.setTimeout(e,50)}}d.bind("load.jcloader",e).bind("error.jcloader",function(h){d.unbind(".jcloader");if(a.isFunction(c)){c.call(b)}});if(b.complete&&a.isFunction(g)){d.unbind(".jcloader");g.call(b)}};a.Jcrop.defaults={allowSelect:true,allowMove:true,allowResize:true,trackDocument:true,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,bgFade:false,borderOpacity:0.4,handleOpacity:0.5,handleSize:null,aspectRatio:0,keySupport:true,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:true,dragEdges:true,fixedSupport:true,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery));var wysihtml5={version:"0.3.0",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\uFEFF",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};window.rangy=(function(){var l="object",g="function",B="undefined";var m=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"];var c=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"];var t=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"];var q=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"];function k(E,D){var C=typeof E[D];return C==g||(!!(C==l&&E[D]))||C=="unknown"}function d(D,C){return !!(typeof D[C]==l&&D[C])}function r(D,C){return typeof D[C]!=B}function n(C){return function(F,E){var D=E.length;while(D--){if(!C(F,E[D])){return false}}return true}}var p=n(k);var s=n(d);var A=n(r);function w(C){return C&&p(C,q)&&A(C,t)}var o={version:"1.2.2",initialized:false,supported:true,util:{isHostMethod:k,isHostObject:d,isHostProperty:r,areHostMethods:p,areHostObjects:s,areHostProperties:A,isTextRange:w},features:{},modules:{},config:{alertOnWarn:false,preferTextRange:false}};function f(C){window.alert("Rangy not supported in your browser. Reason: "+C);o.initialized=true;o.supported=false}o.fail=f;function v(D){var C="Rangy warning: "+D;if(o.config.alertOnWarn){window.alert(C)}else{if(typeof window.console!=B&&typeof window.console.log!=B){window.console.log(C)}}}o.warn=v;if({}.hasOwnProperty){o.util.extend=function(E,D){for(var C in D){if(D.hasOwnProperty(C)){E[C]=D[C]}}}}else{f("hasOwnProperty not supported")}var x=[];var a=[];function u(){if(o.initialized){return}var E;var I=false,J=false;if(k(document,"createRange")){E=document.createRange();if(p(E,c)&&A(E,m)){I=true}E.detach()}var D=d(document,"body")?document.body:document.getElementsByTagName("body")[0];if(D&&k(D,"createTextRange")){E=D.createTextRange();if(w(E)){J=true}}if(!I&&!J){f("Neither Range nor TextRange are implemented")}o.initialized=true;o.features={implementsDomRange:I,implementsTextRange:J};var H=a.concat(x);for(var G=0,C=H.length;G<C;++G){try{H[G](o)}catch(F){if(d(window,"console")&&k(window.console,"log")){window.console.log("Init listener threw an exception. Continuing.",F)}}}}o.init=u;o.addInitListener=function(C){if(o.initialized){C(o)}else{x.push(C)}};var y=[];o.addCreateMissingNativeApiListener=function(C){y.push(C)};function e(E){E=E||window;u();for(var D=0,C=y.length;D<C;++D){y[D](E)}}o.createMissingNativeApi=e;function z(C){this.name=C;this.initialized=false;this.supported=false}z.prototype.fail=function(C){this.initialized=true;this.supported=false;throw new Error("Module '"+this.name+"' failed to load: "+C)};z.prototype.warn=function(C){o.warn("Module "+this.name+": "+C)};z.prototype.createError=function(C){return new Error("Error in Rangy "+this.name+" module: "+C)};o.createModule=function(C,E){var D=new z(C);o.modules[C]=D;a.push(function(F){E(F,D);D.initialized=true;D.supported=true})};o.requireModules=function(E){for(var G=0,C=E.length,F,D;G<C;++G){D=E[G];F=o.modules[D];if(!F||!(F instanceof z)){throw new Error("Module '"+D+"' not found")}if(!F.supported){throw new Error("Module '"+D+"' not supported")}}};var b=false;var h=function(C){if(!b){b=true;if(!o.initialized){u()}}};if(typeof window==B){f("No window found");return}if(typeof document==B){f("No document found");return}if(k(document,"addEventListener")){document.addEventListener("DOMContentLoaded",h,false)}if(k(window,"addEventListener")){window.addEventListener("load",h,false)}else{if(k(window,"attachEvent")){window.attachEvent("onload",h)}else{f("Window does not have required addEventListener or attachEvent method")}}return o})();rangy.createModule("DomUtil",function(r,d){var v="undefined";var b=r.util;if(!b.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])){d.fail("document missing a Node creation method")}if(!b.isHostMethod(document,"getElementsByTagName")){d.fail("document missing getElementsByTagName method")}var e=document.createElement("div");if(!b.areHostMethods(e,["insertBefore","appendChild","cloneNode"]||!b.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"]))){d.fail("Incomplete Element implementation")}if(!b.isHostProperty(e,"innerHTML")){d.fail("Element is missing innerHTML property")}var u=document.createTextNode("test");if(!b.areHostMethods(u,["splitText","deleteData","insertData","appendData","cloneNode"]||!b.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"])||!b.areHostProperties(u,["data"]))){d.fail("Incomplete Text Node implementation")}var A=function(G,I){var H=G.length;while(H--){if(G[H]===I){return true}}return false};function k(H){var G;return typeof H.namespaceURI==v||((G=H.namespaceURI)===null||G=="http://www.w3.org/1999/xhtml")}function l(H){var G=H.parentNode;return(G.nodeType==1)?G:null}function a(H){var G=0;while((H=H.previousSibling)){G++}return G}function g(G){var H;return o(G)?G.length:((H=G.childNodes)?H.length:0)}function z(H,G){var I=[],J;for(J=H;J;J=J.parentNode){I.push(J)}for(J=G;J;J=J.parentNode){if(A(I,J)){return J}}return null}function E(G,H,J){var I=J?H:H.parentNode;while(I){if(I===G){return true}else{I=I.parentNode}}return false}function B(H,G,K){var I,J=K?H:H.parentNode;while(J){I=J.parentNode;if(I===G){return J}J=I}return null}function o(H){var G=H.nodeType;return G==3||G==4||G==8}function x(J,H){var G=H.nextSibling,I=H.parentNode;if(G){I.insertBefore(J,G)}else{I.appendChild(J)}return J}function y(I,G){var H=I.cloneNode(false);H.deleteData(0,G);I.deleteData(G,I.length-G);x(H,I);return H}function s(G){if(G.nodeType==9){return G}else{if(typeof G.ownerDocument!=v){return G.ownerDocument}else{if(typeof G.document!=v){return G.document}else{if(G.parentNode){return s(G.parentNode)}else{throw new Error("getDocument: no document found for node")}}}}}function n(G){var H=s(G);if(typeof H.defaultView!=v){return H.defaultView}else{if(typeof H.parentWindow!=v){return H.parentWindow}else{throw new Error("Cannot get a window object for node")}}}function D(G){if(typeof G.contentDocument!=v){return G.contentDocument}else{if(typeof G.contentWindow!=v){return G.contentWindow.document}else{throw new Error("getIframeWindow: No Document object found for iframe element")}}}function f(G){if(typeof G.contentWindow!=v){return G.contentWindow}else{if(typeof G.contentDocument!=v){return G.contentDocument.defaultView}else{throw new Error("getIframeWindow: No Window object found for iframe element")}}}function F(G){return b.isHostObject(G,"body")?G.body:G.getElementsByTagName("body")[0]}function c(H){var G;while((G=H.parentNode)){H=G}return H}function t(J,L,I,K){var G,M,O,N,H;if(J==I){return L===K?0:(L<K)?-1:1}else{if((G=B(I,J,true))){return L<=a(G)?-1:1}else{if((G=B(J,I,true))){return a(G)<K?-1:1}else{M=z(J,I);O=(J===M)?M:B(J,M,true);N=(I===M)?M:B(I,M,true);if(O===N){throw new Error("comparePoints got to case 4 and childA and childB are the same!")}else{H=M.firstChild;while(H){if(H===O){return -1}else{if(H===N){return 1}}H=H.nextSibling}throw new Error("Should not be here!")}}}}}function C(H){var G=s(H).createDocumentFragment(),I;while((I=H.firstChild)){G.appendChild(I)}return G}function q(G){if(!G){return"[No node]"}if(o(G)){return'"'+G.data+'"'}else{if(G.nodeType==1){var H=G.id?' id="'+G.id+'"':"";return"<"+G.nodeName+H+">["+G.childNodes.length+"]"}else{return G.nodeName}}}function p(G){this.root=G;this._next=G}p.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){var I=this._current=this._next;var H,G;if(this._current){H=I.firstChild;if(H){this._next=H}else{G=null;while((I!==this.root)&&!(G=I.nextSibling)){I=I.parentNode}this._next=G}}return this._current},detach:function(){this._current=this._next=this.root=null}};function h(G){return new p(G)}function m(G,H){this.node=G;this.offset=H}m.prototype={equals:function(G){return this.node===G.node&this.offset==G.offset},inspect:function(){return"[DomPosition("+q(this.node)+":"+this.offset+")]"}};function w(G){this.code=this[G];this.codeName=G;this.message="DOMException: "+this.codeName}w.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};w.prototype.toString=function(){return this.message};r.dom={arrayContains:A,isHtmlNamespace:k,parentElement:l,getNodeIndex:a,getNodeLength:g,getCommonAncestor:z,isAncestorOf:E,getClosestAncestorIn:B,isCharacterDataNode:o,insertAfter:x,splitDataNode:y,getDocument:s,getWindow:n,getIframeWindow:f,getIframeDocument:D,getBody:F,getRootContainer:c,comparePoints:t,inspectNode:q,fragmentFromNodeChildren:C,createIterator:h,DomPosition:m};r.DOMException=w});rangy.createModule("DomRange",function(k,f){k.requireModules(["DomUtil"]);var b=k.dom;var G=b.DomPosition;var V=k.DOMException;function z(an,e){return(an.nodeType!=3)&&(b.isAncestorOf(an,e.startContainer,true)||b.isAncestorOf(an,e.endContainer,true))}function o(e){return b.getDocument(e.startContainer)}function w(an,ar,ao){var aq=an._listeners[ar];if(aq){for(var ap=0,e=aq.length;ap<e;++ap){aq[ap].call(an,{target:an,args:ao})}}}function C(e){return new G(e.parentNode,b.getNodeIndex(e))}function Y(e){return new G(e.parentNode,b.getNodeIndex(e)+1)}function l(an,ap,ao){var e=an.nodeType==11?an.firstChild:an;if(b.isCharacterDataNode(ap)){if(ao==ap.length){b.insertAfter(an,ap)}else{ap.parentNode.insertBefore(an,ao==0?ap:b.splitDataNode(ap,ao))}}else{if(ao>=ap.childNodes.length){ap.appendChild(an)}else{ap.insertBefore(an,ap.childNodes[ao])}}return e}function J(ao){var an;for(var ap,aq=o(ao.range).createDocumentFragment(),e;ap=ao.next();){an=ao.isPartiallySelectedSubtree();ap=ap.cloneNode(!an);if(an){e=ao.getSubtreeIterator();ap.appendChild(J(e));e.detach(true)}if(ap.nodeType==10){throw new V("HIERARCHY_REQUEST_ERR")}aq.appendChild(ap)}return aq}function X(an,aq,e){var ao,at;e=e||{stop:false};for(var ap,ar;ap=an.next();){if(an.isPartiallySelectedSubtree()){if(aq(ap)===false){e.stop=true;return}else{ar=an.getSubtreeIterator();X(ar,aq,e);ar.detach(true);if(e.stop){return}}}else{ao=b.createIterator(ap);while((at=ao.next())){if(aq(at)===false){e.stop=true;return}}}}}function p(an){var e;while(an.next()){if(an.isPartiallySelectedSubtree()){e=an.getSubtreeIterator();p(e);e.detach(true)}else{an.remove()}}}function S(an){for(var ao,ap=o(an.range).createDocumentFragment(),e;ao=an.next();){if(an.isPartiallySelectedSubtree()){ao=ao.cloneNode(false);e=an.getSubtreeIterator();ao.appendChild(S(e));e.detach(true)}else{an.remove()}if(ao.nodeType==10){throw new V("HIERARCHY_REQUEST_ERR")}ap.appendChild(ao)}return ap}function r(ao,e,ap){var ar=!!(e&&e.length),aq;var at=!!ap;if(ar){aq=new RegExp("^("+e.join("|")+")$")}var an=[];X(new g(ao,false),function(au){if((!ar||aq.test(au.nodeType))&&(!at||ap(au))){an.push(au)}});return an}function B(e){var an=(typeof e.getName=="undefined")?"Range":e.getName();return"["+an+"("+b.inspectNode(e.startContainer)+":"+e.startOffset+", "+b.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function g(ao,an){this.range=ao;this.clonePartiallySelectedTextNodes=an;if(!ao.collapsed){this.sc=ao.startContainer;this.so=ao.startOffset;this.ec=ao.endContainer;this.eo=ao.endOffset;var e=ao.commonAncestorContainer;if(this.sc===this.ec&&b.isCharacterDataNode(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=(this.sc===e&&!b.isCharacterDataNode(this.sc))?this.sc.childNodes[this.so]:b.getClosestAncestorIn(this.sc,e,true);this._last=(this.ec===e&&!b.isCharacterDataNode(this.ec))?this.ec.childNodes[this.eo-1]:b.getClosestAncestorIn(this.ec,e,true)}}}g.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return !!this._next},next:function(){var e=this._current=this._next;if(e){this._next=(e!==this._last)?e.nextSibling:null;if(b.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes){if(e===this.ec){(e=e.cloneNode(true)).deleteData(this.eo,e.length-this.eo)}if(this._current===this.sc){(e=e.cloneNode(true)).deleteData(0,this.so)}}}return e},remove:function(){var an=this._current,ao,e;if(b.isCharacterDataNode(an)&&(an===this.sc||an===this.ec)){ao=(an===this.sc)?this.so:0;e=(an===this.ec)?this.eo:an.length;if(ao!=e){an.deleteData(ao,e-ao)}}else{if(an.parentNode){an.parentNode.removeChild(an)}else{}}},isPartiallySelectedSubtree:function(){var e=this._current;return z(e,this.range)},getSubtreeIterator:function(){var an;if(this.isSingleCharacterDataNode){an=this.range.cloneRange();an.collapse()}else{an=new al(o(this.range));var ar=this._current;var ap=ar,e=0,aq=ar,ao=b.getNodeLength(ar);if(b.isAncestorOf(ar,this.sc,true)){ap=this.sc;e=this.so}if(b.isAncestorOf(ar,this.ec,true)){aq=this.ec;ao=this.eo}F(an,ap,e,aq,ao)}return new g(an,this.clonePartiallySelectedTextNodes)},detach:function(e){if(e){this.range.detach()}this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};function Q(e){this.code=this[e];this.codeName=e;this.message="RangeException: "+this.codeName}Q.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};Q.prototype.toString=function(){return this.message};function y(an,e,ao){this.nodes=r(an,e,ao);this._next=this.nodes[0];this._position=0}y.prototype={_current:null,hasNext:function(){return !!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var ag=[1,3,4,5,7,8,10];var ae=[2,9,11];var D=[5,6,10,12];var O=[1,3,4,5,7,8,10,11];var H=[1,3,4,5,7,8];function aa(e){return function(ao,aq){var an,ap=aq?ao:ao.parentNode;while(ap){an=ap.nodeType;if(b.arrayContains(e,an)){return ap}ap=ap.parentNode}return null}}var v=b.getRootContainer;var K=aa([9,11]);var M=aa(D);var c=aa([6,10,12]);function t(an,e){if(c(an,e)){throw new Q("INVALID_NODE_TYPE_ERR")}}function E(e){if(!e.startContainer){throw new V("INVALID_STATE_ERR")}}function W(e,an){if(!b.arrayContains(an,e.nodeType)){throw new Q("INVALID_NODE_TYPE_ERR")}}function af(e,an){if(an<0||an>(b.isCharacterDataNode(e)?e.length:e.childNodes.length)){throw new V("INDEX_SIZE_ERR")}}function d(an,e){if(K(an,true)!==K(e,true)){throw new V("WRONG_DOCUMENT_ERR")}}function ac(e){if(M(e,true)){throw new V("NO_MODIFICATION_ALLOWED_ERR")}}function aj(an,e){if(!an){throw new V(e)}}function q(e){return !b.arrayContains(ae,e.nodeType)&&!K(e,true)}function am(e,an){return an<=(b.isCharacterDataNode(e)?e.length:e.childNodes.length)}function h(e){E(e);if(q(e.startContainer)||q(e.endContainer)||!am(e.startContainer,e.startOffset)||!am(e.endContainer,e.endOffset)){throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}}var a=document.createElement("style");var R=false;try{a.innerHTML="<b>x</b>";R=(a.firstChild.nodeType==3)}catch(ai){}k.features.htmlParsingConforms=R;var T=R?function(ao){var an=this.startContainer;var ap=b.getDocument(an);if(!an){throw new V("INVALID_STATE_ERR")}var e=null;if(an.nodeType==1){e=an}else{if(b.isCharacterDataNode(an)){e=b.parentElement(an)}}if(e===null||(e.nodeName=="HTML"&&b.isHtmlNamespace(b.getDocument(e).documentElement)&&b.isHtmlNamespace(e))){e=ap.createElement("body")}else{e=e.cloneNode(false)}e.innerHTML=ao;return b.fragmentFromNodeChildren(e)}:function(an){E(this);var ao=o(this);var e=ao.createElement("body");e.innerHTML=an;return b.fragmentFromNodeChildren(e)};var N=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var n=0,A=1,ah=2,ab=3;var u=0,x=1,L=2,m=3;function ad(){}ad.prototype={attachListener:function(e,an){this._listeners[e].push(an)},compareBoundaryPoints:function(ar,ao){h(this);d(this.startContainer,ao.startContainer);var au,an,at,e;var aq=(ar==ab||ar==n)?"start":"end";var ap=(ar==A||ar==n)?"start":"end";au=this[aq+"Container"];an=this[aq+"Offset"];at=ao[ap+"Container"];e=ao[ap+"Offset"];return b.comparePoints(au,an,at,e)},insertNode:function(an){h(this);W(an,O);ac(this.startContainer);if(b.isAncestorOf(an,this.startContainer,true)){throw new V("HIERARCHY_REQUEST_ERR")}var e=l(an,this.startContainer,this.startOffset);this.setStartBefore(e)},cloneContents:function(){h(this);var ao,an;if(this.collapsed){return o(this).createDocumentFragment()}else{if(this.startContainer===this.endContainer&&b.isCharacterDataNode(this.startContainer)){ao=this.startContainer.cloneNode(true);ao.data=ao.data.slice(this.startOffset,this.endOffset);an=o(this).createDocumentFragment();an.appendChild(ao);return an}else{var e=new g(this,true);ao=J(e);e.detach()}return ao}},canSurroundContents:function(){h(this);ac(this.startContainer);ac(this.endContainer);var e=new g(this,true);var an=(e._first&&(z(e._first,this))||(e._last&&z(e._last,this)));e.detach();return !an},surroundContents:function(an){W(an,H);if(!this.canSurroundContents()){throw new Q("BAD_BOUNDARYPOINTS_ERR")}var e=this.extractContents();if(an.hasChildNodes()){while(an.lastChild){an.removeChild(an.lastChild)}}l(an,this.startContainer,this.startOffset);an.appendChild(e);this.selectNode(an)},cloneRange:function(){h(this);var e=new al(o(this));var an=N.length,ao;while(an--){ao=N[an];e[ao]=this[ao]}return e},toString:function(){h(this);var an=this.startContainer;if(an===this.endContainer&&b.isCharacterDataNode(an)){return(an.nodeType==3||an.nodeType==4)?an.data.slice(this.startOffset,this.endOffset):""}else{var ao=[],e=new g(this,true);X(e,function(ap){if(ap.nodeType==3||ap.nodeType==4){ao.push(ap.data)}});e.detach();return ao.join("")}},compareNode:function(ao){h(this);var an=ao.parentNode;var aq=b.getNodeIndex(ao);if(!an){throw new V("NOT_FOUND_ERR")}var ap=this.comparePoint(an,aq),e=this.comparePoint(an,aq+1);if(ap<0){return(e>0)?L:u}else{return(e>0)?x:m}},comparePoint:function(e,an){h(this);aj(e,"HIERARCHY_REQUEST_ERR");d(e,this.startContainer);if(b.comparePoints(e,an,this.startContainer,this.startOffset)<0){return -1}else{if(b.comparePoints(e,an,this.endContainer,this.endOffset)>0){return 1}}return 0},createContextualFragment:T,toHtml:function(){h(this);var e=o(this).createElement("div");e.appendChild(this.cloneContents());return e.innerHTML},intersectsNode:function(ap,e){h(this);aj(ap,"NOT_FOUND_ERR");if(b.getDocument(ap)!==o(this)){return false}var ao=ap.parentNode,ar=b.getNodeIndex(ap);aj(ao,"NOT_FOUND_ERR");var aq=b.comparePoints(ao,ar,this.endContainer,this.endOffset),an=b.comparePoints(ao,ar+1,this.startContainer,this.startOffset);return e?aq<=0&&an>=0:aq<0&&an>0},isPointInRange:function(e,an){h(this);aj(e,"HIERARCHY_REQUEST_ERR");d(e,this.startContainer);return(b.comparePoints(e,an,this.startContainer,this.startOffset)>=0)&&(b.comparePoints(e,an,this.endContainer,this.endOffset)<=0)},intersectsRange:function(an,e){h(this);if(o(an)!=o(this)){throw new V("WRONG_DOCUMENT_ERR")}var ap=b.comparePoints(this.startContainer,this.startOffset,an.endContainer,an.endOffset),ao=b.comparePoints(this.endContainer,this.endOffset,an.startContainer,an.startOffset);return e?ap<=0&&ao>=0:ap<0&&ao>0},intersection:function(e){if(this.intersectsRange(e)){var ap=b.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),an=b.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset);var ao=this.cloneRange();if(ap==-1){ao.setStart(e.startContainer,e.startOffset)}if(an==1){ao.setEnd(e.endContainer,e.endOffset)}return ao}return null},union:function(e){if(this.intersectsRange(e,true)){var an=this.cloneRange();if(b.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1){an.setStart(e.startContainer,e.startOffset)}if(b.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1){an.setEnd(e.endContainer,e.endOffset)}return an}else{throw new Q("Ranges do not intersect")}},containsNode:function(an,e){if(e){return this.intersectsNode(an,false)}else{return this.compareNode(an)==m}},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,b.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(ap){var aq=this.cloneRange();aq.selectNode(ap);var ao=aq.getNodes([3]);if(ao.length>0){aq.setStart(ao[0],0);var e=ao.pop();aq.setEnd(e,e.length);var an=this.containsRange(aq);aq.detach();return an}else{return this.containsNodeContents(ap)}},createNodeIterator:function(e,an){h(this);return new y(this,e,an)},getNodes:function(e,an){h(this);return r(this,e,an)},getDocument:function(){return o(this)},collapseBefore:function(e){E(this);this.setEndBefore(e);this.collapse(false)},collapseAfter:function(e){E(this);this.setStartAfter(e);this.collapse(true)},getName:function(){return"DomRange"},equals:function(e){return al.rangesEqual(this,e)},inspect:function(){return B(this)}};function U(e){e.START_TO_START=n;e.START_TO_END=A;e.END_TO_END=ah;e.END_TO_START=ab;e.NODE_BEFORE=u;e.NODE_AFTER=x;e.NODE_BEFORE_AND_AFTER=L;e.NODE_INSIDE=m}function I(e){U(e);U(e.prototype)}function s(e,an){return function(){h(this);var au=this.startContainer,at=this.startOffset,ao=this.commonAncestorContainer;var aq=new g(this,true);var ar,av;if(au!==ao){ar=b.getClosestAncestorIn(au,ao,true);av=Y(ar);au=av.node;at=av.offset}X(aq,ac);aq.reset();var ap=e(aq);aq.detach();an(this,au,at,au,at);return ap}}function Z(ap,at,e){function ar(av,au){return function(aw){E(this);W(aw,ag);W(v(aw),ae);var ax=(av?C:Y)(aw);(au?ao:aq)(this,ax.node,ax.offset)}}function ao(av,ax,ay){var aw=av.endContainer,au=av.endOffset;if(ax!==av.startContainer||ay!==av.startOffset){if(v(ax)!=v(aw)||b.comparePoints(ax,ay,aw,au)==1){aw=ax;au=ay}at(av,ax,ay,aw,au)}}function aq(au,av,ay){var ax=au.startContainer,aw=au.startOffset;if(av!==au.endContainer||ay!==au.endOffset){if(v(av)!=v(ax)||b.comparePoints(av,ay,ax,aw)==-1){ax=av;aw=ay}at(au,ax,aw,av,ay)}}function an(au,av,aw){if(av!==au.startContainer||aw!==au.startOffset||av!==au.endContainer||aw!==au.endOffset){at(au,av,aw,av,aw)}}ap.prototype=new ad();k.util.extend(ap.prototype,{setStart:function(au,av){E(this);t(au,true);af(au,av);ao(this,au,av)},setEnd:function(au,av){E(this);t(au,true);af(au,av);aq(this,au,av)},setStartBefore:ar(true,true),setStartAfter:ar(false,true),setEndBefore:ar(true,false),setEndAfter:ar(false,false),collapse:function(au){h(this);if(au){at(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset)}else{at(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)}},selectNodeContents:function(au){E(this);t(au,true);at(this,au,0,au,b.getNodeLength(au))},selectNode:function(av){E(this);t(av,false);W(av,ag);var aw=C(av),au=Y(av);at(this,aw.node,aw.offset,au.node,au.offset)},extractContents:s(S,at),deleteContents:s(p,at),canSurroundContents:function(){h(this);ac(this.startContainer);ac(this.endContainer);var au=new g(this,true);var av=(au._first&&(z(au._first,this))||(au._last&&z(au._last,this)));au.detach();return !av},detach:function(){e(this)},splitBoundaries:function(){h(this);var ay=this.startContainer,ax=this.startOffset,av=this.endContainer,au=this.endOffset;var aw=(ay===av);if(b.isCharacterDataNode(av)&&au>0&&au<av.length){b.splitDataNode(av,au)}if(b.isCharacterDataNode(ay)&&ax>0&&ax<ay.length){ay=b.splitDataNode(ay,ax);if(aw){au-=ax;av=ay}else{if(av==ay.parentNode&&au>=b.getNodeIndex(ay)){au++}}ax=0}at(this,ay,ax,av,au)},normalizeBoundaries:function(){h(this);var aB=this.startContainer,aw=this.startOffset,aA=this.endContainer,au=this.endOffset;var ax=function(aE){var aD=aE.nextSibling;if(aD&&aD.nodeType==aE.nodeType){aA=aE;au=aE.length;aE.appendData(aD.data);aD.parentNode.removeChild(aD)}};var aC=function(aF){var aE=aF.previousSibling;if(aE&&aE.nodeType==aF.nodeType){aB=aF;var aD=aF.length;aw=aE.length;aF.insertData(0,aE.data);aE.parentNode.removeChild(aE);if(aB==aA){au+=aw;aA=aB}else{if(aA==aF.parentNode){var aG=b.getNodeIndex(aF);if(au==aG){aA=aF;au=aD}else{if(au>aG){au--}}}}}};var az=true;if(b.isCharacterDataNode(aA)){if(aA.length==au){ax(aA)}}else{if(au>0){var ay=aA.childNodes[au-1];if(ay&&b.isCharacterDataNode(ay)){ax(ay)}}az=!this.collapsed}if(az){if(b.isCharacterDataNode(aB)){if(aw==0){aC(aB)}}else{if(aw<aB.childNodes.length){var av=aB.childNodes[aw];if(av&&b.isCharacterDataNode(av)){aC(av)}}}}else{aB=aA;aw=au}at(this,aB,aw,aA,au)},collapseToPoint:function(au,av){E(this);t(au,true);af(au,av);an(this,au,av)}});I(ap)}function P(e){e.collapsed=(e.startContainer===e.endContainer&&e.startOffset===e.endOffset);e.commonAncestorContainer=e.collapsed?e.startContainer:b.getCommonAncestor(e.startContainer,e.endContainer)}function F(ao,aq,an,ar,ap){var e=(ao.startContainer!==aq||ao.startOffset!==an);var at=(ao.endContainer!==ar||ao.endOffset!==ap);ao.startContainer=aq;ao.startOffset=an;ao.endContainer=ar;ao.endOffset=ap;P(ao);w(ao,"boundarychange",{startMoved:e,endMoved:at})}function ak(e){E(e);e.startContainer=e.startOffset=e.endContainer=e.endOffset=null;e.collapsed=e.commonAncestorContainer=null;w(e,"detach",null);e._listeners=null}function al(e){this.startContainer=e;this.startOffset=0;this.endContainer=e;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};P(this)}Z(al,F,ak);k.rangePrototype=ad.prototype;al.rangeProperties=N;al.RangeIterator=g;al.copyComparisonConstants=I;al.createPrototypeRange=Z;al.inspect=B;al.getRangeDocument=o;al.rangesEqual=function(an,e){return an.startContainer===e.startContainer&&an.startOffset===e.startOffset&&an.endContainer===e.endContainer&&an.endOffset===e.endOffset};k.DomRange=al;k.RangeException=Q});rangy.createModule("WrappedRange",function(k,d){k.requireModules(["DomUtil","DomRange"]);var a;var h=k.dom;var b=h.DomPosition;var l=k.DomRange;function e(s){var q=s.parentElement();var o=s.duplicate();o.collapse(true);var r=o.parentElement();o=s.duplicate();o.collapse(false);var p=o.parentElement();var n=(r==p)?r:h.getCommonAncestor(r,p);return n==q?n:h.getCommonAncestor(q,n)}function c(n){return n.compareEndPoints("StartToEnd",n)==0}function f(B,y,p,u){var C=B.duplicate();C.collapse(p);var A=C.parentElement();if(!h.isAncestorOf(y,A,true)){A=y}if(!A.canHaveHTML){return new b(A.parentNode,h.getNodeIndex(A))}var o=h.getDocument(A).createElement("span");var z,w=p?"StartToStart":"StartToEnd";var x,s,n,q;do{A.insertBefore(o,o.previousSibling);C.moveToElementText(o)}while((z=C.compareEndPoints(w,B))>0&&o.previousSibling);q=o.nextSibling;if(z==-1&&q&&h.isCharacterDataNode(q)){C.setEndPoint(p?"EndToStart":"EndToEnd",B);var t;if(/[\r\n]/.test(q.data)){var v=C.duplicate();var r=v.text.replace(/\r\n/g,"\r").length;t=v.moveStart("character",r);while((z=v.compareEndPoints("StartToEnd",v))==-1){t++;v.moveStart("character",1)}}else{t=C.text.length}n=new b(q,t)}else{x=(u||!p)&&o.previousSibling;s=(u||p)&&o.nextSibling;if(s&&h.isCharacterDataNode(s)){n=new b(s,0)}else{if(x&&h.isCharacterDataNode(x)){n=new b(x,x.length)}else{n=new b(A,h.getNodeIndex(o))}}}o.parentNode.removeChild(o);return n}function m(n,p){var q,t,r=n.offset;var u=h.getDocument(n.node);var o,v,w=u.body.createTextRange();var s=h.isCharacterDataNode(n.node);if(s){q=n.node;t=q.parentNode}else{v=n.node.childNodes;q=(r<v.length)?v[r]:null;t=n.node}o=u.createElement("span");o.innerHTML="&#feff;";if(q){t.insertBefore(o,q)}else{t.appendChild(o)}w.moveToElementText(o);w.collapse(!p);t.removeChild(o);if(s){w[p?"moveStart":"moveEnd"]("character",r)}return w}if(k.features.implementsDomRange&&(!k.features.implementsTextRange||!k.config.preferTextRange)){(function(){var p;var u=l.rangeProperties;var x;function n(y){var z=u.length,A;while(z--){A=u[z];y[A]=y.nativeRange[A]}}function q(A,C,z,D,B){var y=(A.startContainer!==C||A.startOffset!=z);var E=(A.endContainer!==D||A.endOffset!=B);if(y||E){A.setEnd(D,B);A.setStart(C,z)}}function v(y){y.nativeRange.detach();y.detached=true;var z=u.length,A;while(z--){A=u[z];y[A]=null}}var o;a=function(y){if(!y){throw new Error("Range must be specified")}this.nativeRange=y;n(this)};l.createPrototypeRange(a,q,v);p=a.prototype;p.selectNode=function(y){this.nativeRange.selectNode(y);n(this)};p.deleteContents=function(){this.nativeRange.deleteContents();n(this)};p.extractContents=function(){var y=this.nativeRange.extractContents();n(this);return y};p.cloneContents=function(){return this.nativeRange.cloneContents()};p.surroundContents=function(y){this.nativeRange.surroundContents(y);n(this)};p.collapse=function(y){this.nativeRange.collapse(y);n(this)};p.cloneRange=function(){return new a(this.nativeRange.cloneRange())};p.refresh=function(){n(this)};p.toString=function(){return this.nativeRange.toString()};var t=document.createTextNode("test");h.getBody(document).appendChild(t);var r=document.createRange();r.setStart(t,0);r.setEnd(t,0);try{r.setStart(t,1);x=true;p.setStart=function(y,z){this.nativeRange.setStart(y,z);n(this)};p.setEnd=function(y,z){this.nativeRange.setEnd(y,z);n(this)};o=function(y){return function(z){this.nativeRange[y](z);n(this)}}}catch(s){x=false;p.setStart=function(z,A){try{this.nativeRange.setStart(z,A)}catch(y){this.nativeRange.setEnd(z,A);this.nativeRange.setStart(z,A)}n(this)};p.setEnd=function(z,A){try{this.nativeRange.setEnd(z,A)}catch(y){this.nativeRange.setStart(z,A);this.nativeRange.setEnd(z,A)}n(this)};o=function(y,z){return function(B){try{this.nativeRange[y](B)}catch(A){this.nativeRange[z](B);this.nativeRange[y](B)}n(this)}}}p.setStartBefore=o("setStartBefore","setEndBefore");p.setStartAfter=o("setStartAfter","setEndAfter");p.setEndBefore=o("setEndBefore","setStartBefore");p.setEndAfter=o("setEndAfter","setStartAfter");r.selectNodeContents(t);if(r.startContainer==t&&r.endContainer==t&&r.startOffset==0&&r.endOffset==t.length){p.selectNodeContents=function(y){this.nativeRange.selectNodeContents(y);n(this)}}else{p.selectNodeContents=function(y){this.setStart(y,0);this.setEnd(y,l.getEndOffset(y))}}r.selectNodeContents(t);r.setEnd(t,3);var w=document.createRange();w.selectNodeContents(t);w.setEnd(t,4);w.setStart(t,2);if(r.compareBoundaryPoints(r.START_TO_END,w)==-1&r.compareBoundaryPoints(r.END_TO_START,w)==1){p.compareBoundaryPoints=function(z,y){y=y.nativeRange||y;if(z==y.START_TO_END){z=y.END_TO_START}else{if(z==y.END_TO_START){z=y.START_TO_END}}return this.nativeRange.compareBoundaryPoints(z,y)}}else{p.compareBoundaryPoints=function(z,y){return this.nativeRange.compareBoundaryPoints(z,y.nativeRange||y)}}if(k.util.isHostMethod(r,"createContextualFragment")){p.createContextualFragment=function(y){return this.nativeRange.createContextualFragment(y)}}h.getBody(document).removeChild(t);r.detach();w.detach()})();k.createNativeRange=function(n){n=n||document;return n.createRange()}}else{if(k.features.implementsTextRange){a=function(n){this.textRange=n;this.refresh()};a.prototype=new l(document);a.prototype.refresh=function(){var p,n;var o=e(this.textRange);if(c(this.textRange)){n=p=f(this.textRange,o,true,true)}else{p=f(this.textRange,o,true,false);n=f(this.textRange,o,false,false)}this.setStart(p.node,p.offset);this.setEnd(n.node,n.offset)};l.copyComparisonConstants(a);var g=(function(){return this})();if(typeof g.Range=="undefined"){g.Range=a}k.createNativeRange=function(n){n=n||document;return n.body.createTextRange()}}}if(k.features.implementsTextRange){a.rangeToTextRange=function(n){if(n.collapsed){var q=m(new b(n.startContainer,n.startOffset),true);return q}else{var r=m(new b(n.startContainer,n.startOffset),true);var p=m(new b(n.endContainer,n.endOffset),false);var o=h.getDocument(n.startContainer).body.createTextRange();o.setEndPoint("StartToStart",r);o.setEndPoint("EndToEnd",p);return o}}}a.prototype.getName=function(){return"WrappedRange"};k.WrappedRange=a;k.createRange=function(n){n=n||document;return new a(k.createNativeRange(n))};k.createRangyRange=function(n){n=n||document;return new l(n)};k.createIframeRange=function(n){return k.createRange(h.getIframeDocument(n))};k.createIframeRangyRange=function(n){return k.createRangyRange(h.getIframeDocument(n))};k.addCreateMissingNativeApiListener(function(o){var n=o.document;if(typeof n.createRange=="undefined"){n.createRange=function(){return k.createRange(this)}}n=o=null})});rangy.createModule("WrappedSelection",function(g,d){g.requireModules(["DomUtil","DomRange","WrappedRange"]);g.config.checkSelectionRanges=true;var F="boolean",V="_rangySelection",c=g.dom,n=g.util,S=g.DomRange,e=g.WrappedRange,P=g.DOMException,A=c.DomPosition,y,p,W="Control";function o(Y){return(Y||window).getSelection()}function s(Y){return(Y||window).document.selection}var U=g.util.isHostMethod(window,"getSelection"),O=g.util.isHostObject(document,"selection");var w=O&&(!U||g.config.preferTextRange);if(w){y=s;g.isSelectionValid=function(Z){var aa=(Z||window).document,Y=aa.selection;return(Y.type!="None"||c.getDocument(Y.createRange().parentElement())==aa)}}else{if(U){y=o;g.isSelectionValid=function(){return true}}else{d.fail("Neither document.selection or window.getSelection() detected.")}}g.getNativeSelection=y;var N=y();var D=g.createNativeRange(document);var E=c.getBody(document);var L=n.areHostObjects(N,["anchorNode","focusNode"]&&n.areHostProperties(N,["anchorOffset","focusOffset"]));g.features.selectionHasAnchorAndFocus=L;var r=n.isHostMethod(N,"extend");g.features.selectionHasExtend=r;var X=(typeof N.rangeCount=="number");g.features.selectionHasRangeCount=X;var R=false;var Q=true;if(n.areHostMethods(N,["addRange","getRangeAt","removeAllRanges"])&&typeof N.rangeCount=="number"&&g.features.implementsDomRange){(function(){var aa=document.createElement("iframe");E.appendChild(aa);var ae=c.getIframeDocument(aa);ae.open();ae.write("<html><head></head><body>12</body></html>");ae.close();var ac=c.getIframeWindow(aa).getSelection();var af=ae.documentElement;var ab=af.lastChild,ad=ab.firstChild;var Z=ae.createRange();Z.setStart(ad,1);Z.collapse(true);ac.addRange(Z);Q=(ac.rangeCount==1);ac.removeAllRanges();var Y=Z.cloneRange();Z.setStart(ad,0);Y.setEnd(ad,2);ac.addRange(Z);ac.addRange(Y);R=(ac.rangeCount==2);Z.detach();Y.detach();E.removeChild(aa)})()}g.features.selectionSupportsMultipleRanges=R;g.features.collapsedNonEditableSelectionsSupported=Q;var f=false,l;if(E&&n.isHostMethod(E,"createControlRange")){l=E.createControlRange();if(n.areHostProperties(l,["item","add"])){f=true}}g.features.implementsControlRange=f;if(L){p=function(Y){return Y.anchorNode===Y.focusNode&&Y.anchorOffset===Y.focusOffset}}else{p=function(Y){return Y.rangeCount?Y.getRangeAt(Y.rangeCount-1).collapsed:false}}function b(ab,Z,Y){var aa=Y?"end":"start",ac=Y?"start":"end";ab.anchorNode=Z[aa+"Container"];ab.anchorOffset=Z[aa+"Offset"];ab.focusNode=Z[ac+"Container"];ab.focusOffset=Z[ac+"Offset"]}function x(Z){var Y=Z.nativeSelection;Z.anchorNode=Y.anchorNode;Z.anchorOffset=Y.anchorOffset;Z.focusNode=Y.focusNode;Z.focusOffset=Y.focusOffset}function I(Y){Y.anchorNode=Y.focusNode=null;Y.anchorOffset=Y.focusOffset=0;Y.rangeCount=0;Y.isCollapsed=true;Y._ranges.length=0}function K(Y){var Z;if(Y instanceof S){Z=Y._selectionNativeRange;if(!Z){Z=g.createNativeRange(c.getDocument(Y.startContainer));Z.setEnd(Y.endContainer,Y.endOffset);Z.setStart(Y.startContainer,Y.startOffset);Y._selectionNativeRange=Z;Y.attachListener("detach",function(){this._selectionNativeRange=null})}}else{if(Y instanceof e){Z=Y.nativeRange}else{if(g.features.implementsDomRange&&(Y instanceof c.getWindow(Y.startContainer).Range)){Z=Y}}}return Z}function m(aa){if(!aa.length||aa[0].nodeType!=1){return false}for(var Z=1,Y=aa.length;Z<Y;++Z){if(!c.isAncestorOf(aa[0],aa[Z])){return false}}return true}function M(Z){var Y=Z.getNodes();if(!m(Y)){throw new Error("getSingleElementFromRange: range "+Z.inspect()+" did not consist of a single element")}return Y[0]}function H(Y){return !!Y&&typeof Y.text!="undefined"}function J(aa,Z){var Y=new e(Z);aa._ranges=[Y];b(aa,Y,false);aa.rangeCount=1;aa.isCollapsed=Y.collapsed}function v(ab){ab._ranges.length=0;if(ab.docSelection.type=="None"){I(ab)}else{var aa=ab.docSelection.createRange();if(H(aa)){J(ab,aa)}else{ab.rangeCount=aa.length;var Y,ac=c.getDocument(aa.item(0));for(var Z=0;Z<ab.rangeCount;++Z){Y=g.createRange(ac);Y.selectNode(aa.item(Z));ab._ranges.push(Y)}ab.isCollapsed=ab.rangeCount==1&&ab._ranges[0].collapsed;b(ab,ab._ranges[ab.rangeCount-1],false)}}}function z(Z,ac){var aa=Z.docSelection.createRange();var Y=M(ac);var ag=c.getDocument(aa.item(0));var ad=c.getBody(ag).createControlRange();for(var ab=0,ae=aa.length;ab<ae;++ab){ad.add(aa.item(ab))}try{ad.add(Y)}catch(af){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}ad.select();v(Z)}var q;if(n.isHostMethod(N,"getRangeAt")){q=function(aa,Y){try{return aa.getRangeAt(Y)}catch(Z){return null}}}else{if(L){q=function(Z){var aa=c.getDocument(Z.anchorNode);var Y=g.createRange(aa);Y.setStart(Z.anchorNode,Z.anchorOffset);Y.setEnd(Z.focusNode,Z.focusOffset);if(Y.collapsed!==this.isCollapsed){Y.setStart(Z.focusNode,Z.focusOffset);Y.setEnd(Z.anchorNode,Z.anchorOffset)}return Y}}}function C(Y,aa,Z){this.nativeSelection=Y;this.docSelection=aa;this._ranges=[];this.win=Z;this.refresh()}g.getSelection=function(aa){aa=aa||window;var Z=aa[V];var Y=y(aa),ab=O?s(aa):null;if(Z){Z.nativeSelection=Y;Z.docSelection=ab;Z.refresh(aa)}else{Z=new C(Y,ab,aa);aa[V]=Z}return Z};g.getIframeSelection=function(Y){return g.getSelection(c.getIframeWindow(Y))};var a=C.prototype;function k(ad,Y){var ae=c.getDocument(Y[0].startContainer);var ab=c.getBody(ae).createControlRange();for(var aa=0,ac;aa<rangeCount;++aa){ac=M(Y[aa]);try{ab.add(ac)}catch(Z){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}ab.select();v(ad)}if(!w&&L&&n.areHostMethods(N,["removeAllRanges","addRange"])){a.removeAllRanges=function(){this.nativeSelection.removeAllRanges();I(this)};var h=function(aa,Y){var ab=S.getRangeDocument(Y);var Z=g.createRange(ab);Z.collapseToPoint(Y.endContainer,Y.endOffset);aa.nativeSelection.addRange(K(Z));aa.nativeSelection.extend(Y.startContainer,Y.startOffset);aa.refresh()};if(X){a.addRange=function(Z,Y){if(f&&O&&this.docSelection.type==W){z(this,Z)}else{if(Y&&r){h(this,Z)}else{var aa;if(R){aa=this.rangeCount}else{this.removeAllRanges();aa=0}this.nativeSelection.addRange(K(Z));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==aa+1){if(g.config.checkSelectionRanges){var ab=q(this.nativeSelection,this.rangeCount-1);if(ab&&!S.rangesEqual(ab,Z)){Z=new e(ab)}}this._ranges[this.rangeCount-1]=Z;b(this,Z,t(this.nativeSelection));this.isCollapsed=p(this)}else{this.refresh()}}}}}else{a.addRange=function(Z,Y){if(Y&&r){h(this,Z)}else{this.nativeSelection.addRange(K(Z));this.refresh()}}}a.setRanges=function(Z){if(f&&Z.length>1){k(this,Z)}else{this.removeAllRanges();for(var aa=0,Y=Z.length;aa<Y;++aa){this.addRange(Z[aa])}}}}else{if(n.isHostMethod(N,"empty")&&n.isHostMethod(D,"select")&&f&&w){a.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var ab;if(this.anchorNode){ab=c.getDocument(this.anchorNode)}else{if(this.docSelection.type==W){var Z=this.docSelection.createRange();if(Z.length){ab=c.getDocument(Z.item(0)).body.createTextRange()}}}if(ab){var aa=ab.body.createTextRange();aa.select();this.docSelection.empty()}}}catch(Y){}I(this)};a.addRange=function(Y){if(this.docSelection.type==W){z(this,Y)}else{e.rangeToTextRange(Y).select();this._ranges[0]=Y;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;b(this,Y,false)}};a.setRanges=function(Y){this.removeAllRanges();var Z=Y.length;if(Z>1){k(this,Y)}else{if(Z){this.addRange(Y[0])}}}}else{d.fail("No means of selecting a Range or TextRange was found");return false}}a.getRangeAt=function(Y){if(Y<0||Y>=this.rangeCount){throw new P("INDEX_SIZE_ERR")}else{return this._ranges[Y]}};var G;if(w){G=function(Z){var Y;if(g.isSelectionValid(Z.win)){Y=Z.docSelection.createRange()}else{Y=c.getBody(Z.win.document).createTextRange();Y.collapse(true)}if(Z.docSelection.type==W){v(Z)}else{if(H(Y)){J(Z,Y)}else{I(Z)}}}}else{if(n.isHostMethod(N,"getRangeAt")&&typeof N.rangeCount=="number"){G=function(aa){if(f&&O&&aa.docSelection.type==W){v(aa)}else{aa._ranges.length=aa.rangeCount=aa.nativeSelection.rangeCount;if(aa.rangeCount){for(var Z=0,Y=aa.rangeCount;Z<Y;++Z){aa._ranges[Z]=new g.WrappedRange(aa.nativeSelection.getRangeAt(Z))}b(aa,aa._ranges[aa.rangeCount-1],t(aa.nativeSelection));aa.isCollapsed=p(aa)}else{I(aa)}}}}else{if(L&&typeof N.isCollapsed==F&&typeof D.collapsed==F&&g.features.implementsDomRange){G=function(aa){var Y,Z=aa.nativeSelection;if(Z.anchorNode){Y=q(Z,0);aa._ranges=[Y];aa.rangeCount=1;x(aa);aa.isCollapsed=p(aa)}else{I(aa)}}}else{d.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}}}a.refresh=function(Z){var Y=Z?this._ranges.slice(0):null;G(this);if(Z){var aa=Y.length;if(aa!=this._ranges.length){return false}while(aa--){if(!S.rangesEqual(Y[aa],this._ranges[aa])){return false}}return true}};var B=function(ac,aa){var Z=ac.getAllRanges(),ad=false;ac.removeAllRanges();for(var ab=0,Y=Z.length;ab<Y;++ab){if(ad||aa!==Z[ab]){ac.addRange(Z[ab])}else{ad=true}}if(!ac.rangeCount){I(ac)}};if(f){a.removeRange=function(ac){if(this.docSelection.type==W){var aa=this.docSelection.createRange();var Y=M(ac);var ag=c.getDocument(aa.item(0));var ae=c.getBody(ag).createControlRange();var Z,af=false;for(var ab=0,ad=aa.length;ab<ad;++ab){Z=aa.item(ab);if(Z!==Y||af){ae.add(aa.item(ab))}else{af=true}}ae.select();v(this)}else{B(this,ac)}}}else{a.removeRange=function(Y){B(this,Y)}}var t;if(!w&&L&&g.features.implementsDomRange){t=function(Z){var Y=false;if(Z.anchorNode){Y=(c.comparePoints(Z.anchorNode,Z.anchorOffset,Z.focusNode,Z.focusOffset)==1)}return Y};a.isBackwards=function(){return t(this)}}else{t=a.isBackwards=function(){return false}}a.toString=function(){var aa=[];for(var Z=0,Y=this.rangeCount;Z<Y;++Z){aa[Z]=""+this._ranges[Z]}return aa.join("")};function T(Z,Y){if(Z.anchorNode&&(c.getDocument(Z.anchorNode)!==c.getDocument(Y))){throw new P("WRONG_DOCUMENT_ERR")}}a.collapse=function(Z,aa){T(this,Z);var Y=g.createRange(c.getDocument(Z));Y.collapseToPoint(Z,aa);this.removeAllRanges();this.addRange(Y);this.isCollapsed=true};a.collapseToStart=function(){if(this.rangeCount){var Y=this._ranges[0];this.collapse(Y.startContainer,Y.startOffset)}else{throw new P("INVALID_STATE_ERR")}};a.collapseToEnd=function(){if(this.rangeCount){var Y=this._ranges[this.rangeCount-1];this.collapse(Y.endContainer,Y.endOffset)}else{throw new P("INVALID_STATE_ERR")}};a.selectAllChildren=function(Z){T(this,Z);var Y=g.createRange(c.getDocument(Z));Y.selectNodeContents(Z);this.removeAllRanges();this.addRange(Y)};a.deleteFromDocument=function(){if(f&&O&&this.docSelection.type==W){var ac=this.docSelection.createRange();var ab;while(ac.length){ab=ac.item(0);ac.remove(ab);ab.parentNode.removeChild(ab)}this.refresh()}else{if(this.rangeCount){var Z=this.getAllRanges();this.removeAllRanges();for(var aa=0,Y=Z.length;aa<Y;++aa){Z[aa].deleteContents()}this.addRange(Z[Y-1])}}};a.getAllRanges=function(){return this._ranges.slice(0)};a.setSingleRange=function(Y){this.setRanges([Y])};a.containsNode=function(ab,Z){for(var aa=0,Y=this._ranges.length;aa<Y;++aa){if(this._ranges[aa].containsNode(ab,Z)){return true}}return false};a.toHtml=function(){var ab="";if(this.rangeCount){var Z=S.getRangeDocument(this._ranges[0]).createElement("div");for(var aa=0,Y=this._ranges.length;aa<Y;++aa){Z.appendChild(this._ranges[aa].cloneContents())}ab=Z.innerHTML}return ab};function u(ae){var ad=[];var ab=new A(ae.anchorNode,ae.anchorOffset);var Z=new A(ae.focusNode,ae.focusOffset);var aa=(typeof ae.getName=="function")?ae.getName():"Selection";if(typeof ae.rangeCount!="undefined"){for(var ac=0,Y=ae.rangeCount;ac<Y;++ac){ad[ac]=S.inspect(ae.getRangeAt(ac))}}return"["+aa+"(Ranges: "+ad.join(", ")+")(anchor: "+ab.inspect()+", focus: "+Z.inspect()+"]"}a.getName=function(){return"WrappedSelection"};a.inspect=function(){return u(this)};a.detach=function(){this.win[V]=null;this.win=this.anchorNode=this.focusNode=null};C.inspect=u;g.Selection=C;g.selectionPrototype=a;g.addCreateMissingNativeApiListener(function(Y){if(typeof Y.getSelection=="undefined"){Y.getSelection=function(){return g.getSelection(this)}}Y=null})});var Base=function(){};Base.extend=function(b,e){var f=Base.prototype.extend;Base._prototyping=true;var d=new this;f.call(d,b);d.base=function(){};delete Base._prototyping;var c=d.constructor;var a=d.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==a){this._constructing=true;c.apply(this,arguments);delete this._constructing}else{if(arguments[0]!=null){return(arguments[0].extend||f).call(arguments[0],d)}}}};a.ancestor=this;a.extend=this.extend;a.forEach=this.forEach;a.implement=this.implement;a.prototype=d;a.toString=this.toString;a.valueOf=function(g){return(g=="object")?a:c.valueOf()};f.call(a,e);if(typeof a.init=="function"){a.init()}return a};Base.prototype={extend:function(b,h){if(arguments.length>1){var e=this[b];if(e&&(typeof h=="function")&&(!e.valueOf||e.valueOf()!=h.valueOf())&&/\bbase\b/.test(h)){var a=h.valueOf();h=function(){var m=this.base||Base.prototype.base;this.base=e;var l=a.apply(this,arguments);this.base=m;return l};h.valueOf=function(l){return(l=="object")?h:a};h.toString=Base.toString}this[b]=h}else{if(b){var g=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){g=this.extend||g}var d={toSource:null};var f=["constructor","toString","valueOf"];var c=Base._prototyping?0:1;while(k=f[c++]){if(b[k]!=d[k]){g.call(this,k,b[k])}}for(var k in b){if(!d[k]){g.call(this,k,b[k])}}}}return this}};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(a,d,c){for(var b in a){if(this.prototype[b]===undefined){d.call(c,a[b],b,a)}}},implement:function(){for(var a=0;a<arguments.length;a++){if(typeof arguments[a]=="function"){arguments[a](this.prototype)}else{this.prototype.extend(arguments[a])}}return this},toString:function(){return String(this.valueOf())}});wysihtml5.browser=(function(){var f=navigator.userAgent,e=document.createElement("div"),c=f.indexOf("MSIE")!==-1&&f.indexOf("Opera")===-1,a=f.indexOf("Gecko")!==-1&&f.indexOf("KHTML")===-1,d=f.indexOf("AppleWebKit/")!==-1,g=f.indexOf("Chrome/")!==-1,b=f.indexOf("Opera/")!==-1;function h(k){return((/ipad|iphone|ipod/.test(k)&&k.match(/ os (\d+).+? like mac os x/))||[,0])[1]}return{USER_AGENT:f,supported:function(){var m=this.USER_AGENT.toLowerCase(),o="contentEditable" in e,k=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,l=document.querySelector&&document.querySelectorAll,n=(this.isIos()&&h(m)<5)||m.indexOf("opera mobi")!==-1||m.indexOf("hpwos/")!==-1;return o&&k&&l&&!n},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){var k=this.USER_AGENT.toLowerCase();return k.indexOf("webkit")!==-1&&k.indexOf("mobile")!==-1},supportsSandboxedIframes:function(){return c},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return !("querySelector" in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return !a},hasCurrentStyleProperty:function(){return"currentStyle" in e},insertsLineBreaksOnReturn:function(){return a},supportsPlaceholderAttributeOn:function(k){return"placeholder" in k},supportsEvent:function(k){return"on"+k in e||(function(){e.setAttribute("on"+k,"return;");return typeof(e["on"+k])==="function"})()},supportsEventsInIframeCorrectly:function(){return !b},firesOnDropOnlyWhenOnDragOverIsCancelled:function(){return d||a},supportsDataTransfer:function(){try{return d&&(window.Clipboard||window.DataTransfer).prototype.getData}catch(k){return false}},supportsHTML5Tags:function(m){var l=m.createElement("div"),k="<article>foo</article>";l.innerHTML=k;return l.innerHTML.toLowerCase()===k},supportsCommand:(function(){var l={formatBlock:c,insertUnorderedList:c||b||d,insertOrderedList:c||b||d};var k={insertHTML:a};return function(n,p){var q=l[p];if(!q){try{return n.queryCommandSupported(p)}catch(o){}try{return n.queryCommandEnabled(p)}catch(m){return !!k[p]}}return false}})(),doesAutoLinkingInContentEditable:function(){return c},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return a||b||d},supportsGetAttributeCorrectly:function(){var k=document.createElement("td");return k.getAttribute("rowspan")!="1"},canSelectImagesInContentEditable:function(){return a||c||b},clearsListsInContentEditableCorrectly:function(){return a||c||d},autoScrollsToCaret:function(){return !d},autoClosesUnclosedTags:function(){var m=e.cloneNode(false),k,l;m.innerHTML="<p><div></div>";l=m.innerHTML.toLowerCase();k=l==="<p></p><div></div>"||l==="<p><div></div></p>";this.autoClosesUnclosedTags=function(){return k};return k},supportsNativeGetElementsByClassName:function(){return String(document.getElementsByClassName).indexOf("[native code]")!==-1},supportsSelectionModify:function(){return"getSelection" in window&&"modify" in window.getSelection()},supportsClassList:function(){return"classList" in e},needsSpaceAfterLineBreak:function(){return b},supportsSpeechApiOn:function(k){var l=f.match(/Chrome\/(\d+)/)||[,0];return l[1]>=11&&("onwebkitspeechchange" in k||"speech" in k)},crashesWhenDefineProperty:function(k){return c&&(k==="XMLHttpRequest"||k==="XDomainRequest")},doesAsyncFocus:function(){return c},hasProblemsSettingCaretAfterImg:function(){return c},hasUndoInContextMenu:function(){return a||g||b}}})();wysihtml5.lang.array=function(a){return{contains:function(d){if(a.indexOf){return a.indexOf(d)!==-1}else{for(var b=0,c=a.length;b<c;b++){if(a[b]===d){return true}}return false}},without:function(b){b=wysihtml5.lang.array(b);var d=[],c=0,e=a.length;for(;c<e;c++){if(!b.contains(a[c])){d.push(a[c])}}return d},get:function(){var c=0,d=a.length,b=[];for(;c<d;c++){b.push(a[c])}return b}}};wysihtml5.lang.Dispatcher=Base.extend({observe:function(a,b){this.events=this.events||{};this.events[a]=this.events[a]||[];this.events[a].push(b);return this},on:function(){return this.observe.apply(this,wysihtml5.lang.array(arguments).get())},fire:function(b,d){this.events=this.events||{};var a=this.events[b]||[],c=0;for(;c<a.length;c++){a[c].call(this,d)}return this},stopObserving:function(b,d){this.events=this.events||{};var c=0,a,e;if(b){a=this.events[b]||[],e=[];for(;c<a.length;c++){if(a[c]!==d&&d){e.push(a[c])}}this.events[b]=e}else{this.events={}}return this}});wysihtml5.lang.object=function(a){return{merge:function(b){for(var c in b){a[c]=b[c]}return this},get:function(){return a},clone:function(){var b={},c;for(c in a){b[c]=a[c]}return b},isArray:function(){return Object.prototype.toString.call(a)==="[object Array]"}}};(function(){var b=/^\s+/,a=/\s+$/;wysihtml5.lang.string=function(c){c=String(c);return{trim:function(){return c.replace(b,"").replace(a,"")},interpolate:function(e){for(var d in e){c=this.replace("#{"+d+"}").by(e[d])}return c},replace:function(d){return{by:function(e){return c.split(d).join(e)}}}}}})();(function(n){var l=n.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),m=/((https?:\/\/|www\.)[^\s<]{3,})/gi,e=/([^\w\/\-](,?))$/i,c=100,f={")":"(","]":"[","}":"{"};function b(o){if(k(o)){return o}if(o===o.ownerDocument.documentElement){o=o.ownerDocument.body}return a(o)}function g(o){return o.replace(m,function(r,q){var t=(q.match(e)||[])[1]||"",p=f[t];q=q.replace(e,"");if(q.split(p).length>q.split(t).length){q=q+t;t=""}var s=q,u=q;if(q.length>c){u=u.substr(0,c)+"..."}if(s.substr(0,4)==="www."){s="http://"+s}return'<a href="'+s+'">'+u+"</a>"+t})}function d(p){var o=p._wysihtml5_tempElement;if(!o){o=p._wysihtml5_tempElement=p.createElement("div")}return o}function h(q){var p=q.parentNode,o=d(p.ownerDocument);o.innerHTML="<span></span>"+g(q.data);o.removeChild(o.firstChild);while(o.firstChild){p.insertBefore(o.firstChild,q)}p.removeChild(q)}function k(o){var p;while(o.parentNode){o=o.parentNode;p=o.nodeName;if(l.contains(p)){return true}else{if(p==="body"){return false}}}return false}function a(p){if(l.contains(p.nodeName)){return}if(p.nodeType===n.TEXT_NODE&&p.data.match(m)){h(p);return}var r=n.lang.array(p.childNodes).get(),q=r.length,o=0;for(;o<q;o++){a(r[o])}return p}n.dom.autoLink=b;n.dom.autoLink.URL_REG_EXP=m})(wysihtml5);(function(c){var b=c.browser.supportsClassList(),a=c.dom;a.addClass=function(d,e){if(b){return d.classList.add(e)}if(a.hasClass(d,e)){return}d.className+=" "+e};a.removeClass=function(d,e){if(b){return d.classList.remove(e)}d.className=d.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ")};a.hasClass=function(d,e){if(b){return d.classList.contains(e)}var f=d.className;return(f.length>0&&(f==e||new RegExp("(^|\\s)"+e+"(\\s|$)").test(f)))}})(wysihtml5);wysihtml5.dom.contains=(function(){var a=document.documentElement;if(a.contains){return function(b,c){if(c.nodeType!==wysihtml5.ELEMENT_NODE){c=c.parentNode}return b!==c&&b.contains(c)}}else{if(a.compareDocumentPosition){return function(b,c){return !!(b.compareDocumentPosition(c)&16)}}}})();wysihtml5.dom.convertToList=(function(){function b(f,e){var d=f.createElement("li");e.appendChild(d);return d}function c(e,d){return e.createElement(d)}function a(f,o){if(f.nodeName==="UL"||f.nodeName==="OL"||f.nodeName==="MENU"){return f}var q=f.ownerDocument,l=c(q,o),m=f.querySelectorAll("br"),k=m.length,s,r,d,n,h,t,g,p,e;for(e=0;e<k;e++){n=m[e];while((h=n.parentNode)&&h!==f&&h.lastChild===n){if(wysihtml5.dom.getStyle("display").from(h)==="block"){h.removeChild(n);break}wysihtml5.dom.insert(n).after(n.parentNode)}}s=wysihtml5.lang.array(f.childNodes).get();r=s.length;for(e=0;e<r;e++){p=p||b(q,l);d=s[e];t=wysihtml5.dom.getStyle("display").from(d)==="block";g=d.nodeName==="BR";if(t){p=p.firstChild?b(q,l):p;p.appendChild(d);p=null;continue}if(g){p=p.firstChild?null:p;continue}p.appendChild(d)}f.parentNode.replaceChild(l,f);return l}return a})();wysihtml5.dom.copyAttributes=function(a){return{from:function(b){return{to:function(c){var f,d=0,e=a.length;for(;d<e;d++){f=a[d];if(typeof(b[f])!=="undefined"&&b[f]!==""){c[f]=b[f]}}return{andTo:arguments.callee}}}}}};(function(b){var d=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"];var c=function(e){if(a(e)){return parseInt(b.getStyle("width").from(e),10)<e.offsetWidth}return false};var a=function(f){var e=0,g=d.length;for(;e<g;e++){if(b.getStyle(d[e]).from(f)==="border-box"){return d[e]}}};b.copyStyles=function(e){return{from:function(g){if(c(g)){e=wysihtml5.lang.array(e).without(d)}var h="",k=e.length,f=0,l;for(;f<k;f++){l=e[f];h+=l+":"+b.getStyle(l).from(g)+";"}return{to:function(m){b.setStyles(h).on(m);return{andTo:arguments.callee}}}}}}})(wysihtml5.dom);(function(a){a.dom.delegate=function(c,b,d,e){return a.dom.observe(c,d,function(g){var h=g.target,f=a.lang.array(c.querySelectorAll(b));while(h&&h!==c){if(f.contains(h)){e.call(h,g);break}h=h.parentNode}})}})(wysihtml5);wysihtml5.dom.getAsDom=(function(){var a=function(g,f){var d=f.createElement("div");d.style.display="none";f.body.appendChild(d);try{d.innerHTML=g}catch(h){}f.body.removeChild(d);return d};var c=function(e){if(e._wysihtml5_supportsHTML5Tags){return}for(var d=0,f=b.length;d<f;d++){e.createElement(b[d])}e._wysihtml5_supportsHTML5Tags=true};var b=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(f,e){e=e||document;var d;if(typeof(f)==="object"&&f.nodeType){d=e.createElement("div");d.appendChild(f)}else{if(wysihtml5.browser.supportsHTML5Tags(e)){d=e.createElement("div");d.innerHTML=f}else{c(e);d=a(f,e)}}return d}})();wysihtml5.dom.getParentElement=(function(){function a(g,f){if(!f||!f.length){return true}if(typeof(f)==="string"){return g===f}else{return wysihtml5.lang.array(f).contains(g)}}function c(f){return f.nodeType===wysihtml5.ELEMENT_NODE}function b(f,g,h){var k=(f.className||"").match(h)||[];if(!g){return !!k.length}return k[k.length-1]===g}function e(f,h,g){while(g--&&f&&f.nodeName!=="BODY"){if(a(f.nodeName,h)){return f}f=f.parentNode}return null}function d(g,l,f,k,h){while(h--&&g&&g.nodeName!=="BODY"){if(c(g)&&a(g.nodeName,l)&&b(g,f,k)){return g}g=g.parentNode}return null}return function(g,f,h){h=h||50;if(f.className||f.classRegExp){return d(g,f.nodeName,f.className,f.classRegExp,h)}else{return e(g,f.nodeName,h)}}})();wysihtml5.dom.getStyle=(function(){var b={"float":("styleFloat" in document.createElement("div").style)?"styleFloat":"cssFloat"},c=/\-[a-z]/g;function a(d){return d.replace(c,function(e){return e.charAt(1).toUpperCase()})}return function(d){return{from:function(l){if(l.nodeType!==wysihtml5.ELEMENT_NODE){return}var q=l.ownerDocument,m=b[d]||a(d),g=l.style,h=l.currentStyle,r=g[m];if(r){return r}if(h){try{return h[m]}catch(o){}}var n=q.defaultView||q.parentWindow,p=(d==="height"||d==="width")&&l.nodeName==="TEXTAREA",k,f;if(n.getComputedStyle){if(p){k=g.overflow;g.overflow="hidden"}f=n.getComputedStyle(l,null).getPropertyValue(d);if(p){g.overflow=k||""}return f}}}}})();wysihtml5.dom.hasElementWithTagName=(function(){var c={},b=1;function a(d){return d._wysihtml5_identifier||(d._wysihtml5_identifier=b++)}return function(f,e){var d=a(f)+":"+e,g=c[d];if(!g){g=c[d]=f.getElementsByTagName(e)}return g.length>0}})();(function(d){var c={},b=1;function a(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=b++)}d.dom.hasElementWithClassName=function(g,f){if(!d.browser.supportsNativeGetElementsByClassName()){return !!g.querySelector("."+f)}var e=a(g)+":"+f,h=c[e];if(!h){h=c[e]=g.getElementsByClassName(f)}return h.length>0}})(wysihtml5);wysihtml5.dom.insert=function(a){return{after:function(b){b.parentNode.insertBefore(a,b.nextSibling)},before:function(b){b.parentNode.insertBefore(a,b)},into:function(b){b.appendChild(a)}}};wysihtml5.dom.insertCSS=function(a){a=a.join("\n");return{into:function(d){var c=d.head||d.getElementsByTagName("head")[0],b=d.createElement("style");b.type="text/css";if(b.styleSheet){b.styleSheet.cssText=a}else{b.appendChild(d.createTextNode(a))}if(c){c.appendChild(b)}}}};wysihtml5.dom.observe=function(c,g,d){g=typeof(g)==="string"?[g]:g;var f,a,b=0,e=g.length;for(;b<e;b++){a=g[b];if(c.addEventListener){c.addEventListener(a,d,false)}else{f=function(h){if(!("target" in h)){h.target=h.srcElement}h.preventDefault=h.preventDefault||function(){this.returnValue=false};h.stopPropagation=h.stopPropagation||function(){this.cancelBubble=true};d.call(c,h)};c.attachEvent("on"+a,f)}}return{stop:function(){var h,k=0,l=g.length;for(;k<l;k++){h=g[k];if(c.removeEventListener){c.removeEventListener(h,d,false)}else{c.detachEvent("on"+h,f)}}}}};wysihtml5.dom.parse=(function(){var a={"1":e,"3":n},q="span",g=/\s+/,l={tags:{},classes:{}},p={};function d(w,z,r,t){wysihtml5.lang.object(p).merge(l).merge(z).get();r=r||w.ownerDocument||document;var v=r.createDocumentFragment(),s=typeof(w)==="string",u,y,x;if(s){u=wysihtml5.dom.getAsDom(w,r)}else{u=w}while(u.firstChild){x=u.firstChild;u.removeChild(x);y=f(x,t);if(y){v.appendChild(y)}}u.innerHTML="";u.appendChild(v);return s?wysihtml5.quirks.getCorrectInnerHTML(u):u}function f(x,w){var v=x.nodeType,u=x.childNodes,t=u.length,s,y=a[v],r=0;s=y&&y(x);if(!s){return null}for(r=0;r<t;r++){newChild=f(u[r],w);if(newChild){s.appendChild(newChild)}}if(w&&s.childNodes.length<=1&&s.nodeName.toLowerCase()===q&&!s.attributes.length){return s.firstChild}return s}function e(w){var v,u,t,s=p.tags,x=w.nodeName.toLowerCase(),r=w.scopeName;if(w._wysihtml5){return null}w._wysihtml5=1;if(w.className==="wysihtml5-temp"){return null}if(r&&r!="HTML"){x=r+":"+x}if("outerHTML" in w){if(!wysihtml5.browser.autoClosesUnclosedTags()&&w.nodeName==="P"&&w.outerHTML.slice(-4).toLowerCase()!=="</p>"){x="div"}}if(x in s){v=s[x];if(!v||v.remove){return null}v=typeof(v)==="string"?{rename_tag:v}:v}else{if(w.firstChild){v={rename_tag:q}}else{return null}}u=w.ownerDocument.createElement(v.rename_tag||x);b(w,u,v);w=null;return u}function b(E,r,x){var A={},L=x.set_class,C=x.add_class,H=x.set_attributes,w=x.check_attributes,v=p.classes,G=0,J=[],M=[],u=[],F=[],y,B,t,z,D,K,s;if(H){A=wysihtml5.lang.object(H).clone()}if(w){for(D in w){s=h[w[D]];if(!s){continue}K=s(k(E,D));if(typeof(K)==="string"){A[D]=K}}}if(L){J.push(L)}if(C){for(D in C){s=m[C[D]];if(!s){continue}z=s(k(E,D));if(typeof(z)==="string"){J.push(z)}}}v["_wysihtml5-temp-placeholder"]=1;F=E.getAttribute("class");if(F){J=J.concat(F.split(g))}y=J.length;for(;G<y;G++){t=J[G];if(v[t]){M.push(t)}}B=M.length;while(B--){t=M[B];if(!wysihtml5.lang.array(u).contains(t)){u.unshift(t)}}if(u.length){A["class"]=u.join(" ")}for(D in A){try{r.setAttribute(D,A[D])}catch(I){}}if(A.src){if(typeof(A.width)!=="undefined"){r.setAttribute("width",A.width)}if(typeof(A.height)!=="undefined"){r.setAttribute("height",A.height)}}}var o=!wysihtml5.browser.supportsGetAttributeCorrectly();function k(t,s){s=s.toLowerCase();var v=t.nodeName;if(v=="IMG"&&s=="src"&&c(t)===true){return t.src}else{if(o&&"outerHTML" in t){var u=t.outerHTML.toLowerCase(),r=u.indexOf(" "+s+"=")!=-1;return r?t.getAttribute(s):null}else{return t.getAttribute(s)}}}function c(r){try{return r.complete&&!r.mozMatchesSelector(":-moz-broken")}catch(s){if(r.complete&&r.readyState==="complete"){return true}}}function n(r){return r.ownerDocument.createTextNode(r.data)}var h={url:(function(){var r=/^https?:\/\//i;return function(s){if(!s||!s.match(r)){return null}return s.replace(r,function(t){return t.toLowerCase()})}})(),alt:(function(){var r=/[^ a-z0-9_\-]/gi;return function(s){if(!s){return""}return s.replace(r,"")}})(),numbers:(function(){var r=/\D/g;return function(s){s=(s||"").replace(r,"");return s||null}})()};var m={align_img:(function(){var r={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(s){return r[String(s).toLowerCase()]}})(),align_text:(function(){var r={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(s){return r[String(s).toLowerCase()]}})(),clear_br:(function(){var r={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(s){return r[String(s).toLowerCase()]}})(),size_font:(function(){var r={"1":"wysiwyg-font-size-xx-small","2":"wysiwyg-font-size-small","3":"wysiwyg-font-size-medium","4":"wysiwyg-font-size-large","5":"wysiwyg-font-size-x-large","6":"wysiwyg-font-size-xx-large","7":"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(s){return r[String(s).charAt(0)]}})()};return d})();wysihtml5.dom.removeEmptyTextNodes=function(c){var b,e=wysihtml5.lang.array(c.childNodes).get(),d=e.length,a=0;for(;a<d;a++){b=e[a];if(b.nodeType===wysihtml5.TEXT_NODE&&b.data===""){b.parentNode.removeChild(b)}}};wysihtml5.dom.renameElement=function(a,b){var d=a.ownerDocument.createElement(b),c;while(c=a.firstChild){d.appendChild(c)}wysihtml5.dom.copyAttributes(["align","className"]).from(a).to(d);a.parentNode.replaceChild(d,a);return d};wysihtml5.dom.replaceWithChildNodes=function(b){if(!b.parentNode){return}if(!b.firstChild){b.parentNode.removeChild(b);return}var a=b.ownerDocument.createDocumentFragment();while(b.firstChild){a.appendChild(b.firstChild)}b.parentNode.replaceChild(a,b);b=a=null};(function(e){function c(f){return e.getStyle("display").from(f)==="block"}function d(f){return f.nodeName==="BR"}function b(g){var f=g.ownerDocument.createElement("br");g.appendChild(f)}function a(m){if(m.nodeName!=="MENU"&&m.nodeName!=="UL"&&m.nodeName!=="OL"){return}var p=m.ownerDocument,n=p.createDocumentFragment(),g=m.previousElementSibling||m.previousSibling,o,h,k,l,f;if(g&&!c(g)){b(n)}while(f=m.firstChild){h=f.lastChild;while(o=f.firstChild){k=o===h;l=k&&!c(o)&&!d(o);n.appendChild(o);if(l){b(n)}}f.parentNode.removeChild(f)}m.parentNode.replaceChild(n,m)}e.resolveList=a})(wysihtml5.dom);(function(e){var d=document,c=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],b=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],a=["referrer","write","open","close"];e.dom.Sandbox=Base.extend({constructor:function(g,f){this.callback=g||e.EMPTY_FUNCTION;this.config=e.lang.object({}).merge(f).get();this.iframe=this._createIframe()},insertInto:function(f){if(typeof(f)==="string"){f=d.getElementById(f)}f.appendChild(this.iframe)},getIframe:function(){return this.iframe},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var f=this.getIframe();f.parentNode.removeChild(f)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var g=this,f=d.createElement("iframe");f.className="wysihtml5-sandbox";e.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(f);if(e.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()){f.src="javascript:'<html></html>'"}f.onload=function(){f.onreadystatechange=f.onload=null;g._onLoadIframe(f)};f.onreadystatechange=function(){if(/loaded|complete/.test(f.readyState)){f.onreadystatechange=f.onload=null;g._onLoadIframe(f)}};return f},_onLoadIframe:function(h){if(!e.dom.contains(d.documentElement,h)){return}var m=this,f=h.contentWindow,n=h.contentWindow.document,o=d.characterSet||d.charset||"utf-8",l=this._getHtml({charset:o,stylesheets:this.config.stylesheets});n.open("text/html","replace");n.write(l);n.close();this.getWindow=function(){return h.contentWindow};this.getDocument=function(){return h.contentWindow.document};f.onerror=function(q,r,p){throw new Error("wysihtml5.Sandbox: "+q,r,p)};if(!e.browser.supportsSandboxedIframes()){var g,k;for(g=0,k=c.length;g<k;g++){this._unset(f,c[g])}for(g=0,k=b.length;g<k;g++){this._unset(f,b[g],e.EMPTY_FUNCTION)}for(g=0,k=a.length;g<k;g++){this._unset(n,a[g])}this._unset(n,"cookie","",true)}this.loaded=true;setTimeout(function(){m.callback(m)},0)},_getHtml:function(k){var l=k.stylesheets,g="",f=0,h;l=typeof(l)==="string"?[l]:l;if(l){h=l.length;for(;f<h;f++){g+='<link rel="stylesheet" href="'+l[f]+'">'}}k.stylesheets=g;return e.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(k)},_unset:function(g,k,h,m){try{g[k]=h}catch(l){}try{g.__defineGetter__(k,function(){return h})}catch(l){}if(m){try{g.__defineSetter__(k,function(){})}catch(l){}}if(!e.browser.crashesWhenDefineProperty(k)){try{var f={get:function(){return h}};if(m){f.set=function(){}}Object.defineProperty(g,k,f)}catch(l){}}}})})(wysihtml5);(function(){var a={className:"class"};wysihtml5.dom.setAttributes=function(b){return{on:function(d){for(var c in b){d.setAttribute(a[c]||c,b[c])}}}}})();wysihtml5.dom.setStyles=function(a){return{on:function(c){var d=c.style;if(typeof(a)==="string"){d.cssText+=";"+a;return}for(var b in a){if(b==="float"){d.cssFloat=a[b];d.styleFloat=a[b]}else{d[b]=a[b]}}}}};(function(a){a.simulatePlaceholder=function(d,b,c){var e="placeholder",f=function(){if(b.hasPlaceholderSet()){b.clear()}a.removeClass(b.element,e)},g=function(){if(b.isEmpty()){b.setValue(c);a.addClass(b.element,e)}};d.observe("set_placeholder",g).observe("unset_placeholder",f).observe("focus:composer",f).observe("paste:composer",f).observe("blur:composer",g);g()}})(wysihtml5.dom);(function(b){var a=document.documentElement;if("textContent" in a){b.setTextContent=function(c,d){c.textContent=d};b.getTextContent=function(c){return c.textContent}}else{if("innerText" in a){b.setTextContent=function(c,d){c.innerText=d};b.getTextContent=function(c){return c.innerText}}else{b.setTextContent=function(c,d){c.nodeValue=d};b.getTextContent=function(c){return c.nodeValue}}}})(wysihtml5.dom);wysihtml5.quirks.cleanPastedHTML=(function(){var a={"a u":wysihtml5.dom.replaceWithChildNodes};function b(l,m,d){m=m||a;d=d||l.ownerDocument||document;var h,e=typeof(l)==="string",c,k,n,g,f=0;if(e){h=wysihtml5.dom.getAsDom(l,d)}else{h=l}for(g in m){k=h.querySelectorAll(g);c=m[g];n=k.length;for(;f<n;f++){c(k[f])}}k=l=m=null;return e?h.innerHTML:h}return b})();(function(b){var a=b.dom;b.quirks.ensureProperClearing=(function(){var c=function(e){var d=this;setTimeout(function(){var f=d.innerHTML.toLowerCase();if(f=="<p>&nbsp;</p>"||f=="<p>&nbsp;</p><p>&nbsp;</p>"){d.innerHTML=""}},0)};return function(d){a.observe(d.element,["cut","keydown"],c)}})();b.quirks.ensureProperClearingOfLists=(function(){var d=["OL","UL","MENU"];var c=function(g,e){if(!e.firstChild||!b.lang.array(d).contains(e.firstChild.nodeName)){return}var k=a.getParentElement(g,{nodeName:d});if(!k){return}var h=k==e.firstChild;if(!h){return}var l=k.childNodes.length<=1;if(!l){return}var f=k.firstChild?k.firstChild.innerHTML==="":true;if(!f){return}k.parentNode.removeChild(k)};return function(e){a.observe(e.element,"keydown",function(g){if(g.keyCode!==b.BACKSPACE_KEY){return}var f=e.selection.getSelectedNode();c(f,e.element)})}})()})(wysihtml5);(function(b){var a="%7E";b.quirks.getCorrectInnerHTML=function(e){var k=e.innerHTML;if(k.indexOf(a)===-1){return k}var g=e.querySelectorAll("[href*='~'], [src*='~']"),c,h,f,d;for(d=0,f=g.length;d<f;d++){c=g[d].href||g[d].src;h=b.lang.string(c).replace("~").by(a);k=b.lang.string(k).replace(h).by(c)}return k}})(wysihtml5);(function(d){var c=d.dom,b=["LI","P","H1","H2","H3","H4","H5","H6"],a=["UL","OL","MENU"];d.quirks.insertLineBreakOnReturn=function(g){function e(l){var h=c.getParentElement(l,{nodeName:["P","DIV"]},2);if(!h){return}var k=document.createTextNode(d.INVISIBLE_SPACE);c.insert(k).before(h);c.replaceWithChildNodes(h);g.selection.selectNode(k)}function f(k){var m=k.keyCode;if(k.shiftKey||(m!==d.ENTER_KEY&&m!==d.BACKSPACE_KEY)){return}var h=k.target,l=g.selection.getSelectedNode(),n=c.getParentElement(l,{nodeName:b},4);if(n){if(n.nodeName==="LI"&&(m===d.ENTER_KEY||m===d.BACKSPACE_KEY)){setTimeout(function(){var p=g.selection.getSelectedNode(),o,q;if(!p){return}o=c.getParentElement(p,{nodeName:a},2);if(o){return}e(p)},0)}else{if(n.nodeName.match(/H[1-6]/)&&m===d.ENTER_KEY){setTimeout(function(){e(g.selection.getSelectedNode())},0)}}return}if(m===d.ENTER_KEY&&!d.browser.insertsLineBreaksOnReturn()){g.commands.exec("insertLineBreak");k.preventDefault()}}c.observe(g.element.ownerDocument,"keydown",f)}})(wysihtml5);(function(b){var a="wysihtml5-quirks-redraw";b.quirks.redraw=function(c){b.dom.addClass(c,a);b.dom.removeClass(c,a);try{var f=c.ownerDocument;f.execCommand("italic",false,null);f.execCommand("italic",false,null)}catch(d){}}})(wysihtml5);(function(c){var b=c.dom;function a(d){var e=0;if(d.parentNode){do{e+=d.offsetTop||0;d=d.offsetParent}while(d)}return e}c.Selection=Base.extend({constructor:function(d){window.rangy.init();this.editor=d;this.composer=d.composer;this.doc=this.composer.doc},getBookmark:function(){var d=this.getRange();return d&&d.cloneRange()},setBookmark:function(d){if(!d){return}this.setSelection(d)},setBefore:function(e){var d=rangy.createRange(this.doc);d.setStartBefore(e);d.setEndBefore(e);return this.setSelection(d)},setAfter:function(e){var d=rangy.createRange(this.doc);d.setStartAfter(e);d.setEndAfter(e);return this.setSelection(d)},selectNode:function(d){var g=rangy.createRange(this.doc),l=d.nodeType===c.ELEMENT_NODE,n="canHaveHTML" in d?d.canHaveHTML:(d.nodeName!=="IMG"),k=l?d.innerHTML:d.data,f=(k===""||k===c.INVISIBLE_SPACE),m=b.getStyle("display").from(d),o=(m==="block"||m==="list-item");if(f&&l&&n){try{d.innerHTML=c.INVISIBLE_SPACE}catch(h){}}if(n){g.selectNodeContents(d)}else{g.selectNode(d)}if(n&&f&&l){g.collapse(o)}else{if(n&&f){g.setStartAfter(d);g.setEndAfter(d)}}this.setSelection(g)},getSelectedNode:function(e){var f,d;if(e&&this.doc.selection&&this.doc.selection.type==="Control"){d=this.doc.selection.createRange();if(d&&d.length){return d.item(0)}}f=this.getSelection(this.doc);if(f.focusNode===f.anchorNode){return f.focusNode}else{d=this.getRange(this.doc);return d?d.commonAncestorContainer:this.doc.body}},executeAndRestore:function(d,p){var h=this.doc.body,f=p&&h.scrollTop,k=p&&h.scrollLeft,n="_wysihtml5-temp-placeholder",q='<span class="'+n+'">'+c.INVISIBLE_SPACE+"</span>",g=this.getRange(this.doc),o;if(!g){d(h,h);return}var e=g.createContextualFragment(q);g.insertNode(e);try{d(g.startContainer,g.endContainer)}catch(m){setTimeout(function(){throw m},0)}caretPlaceholder=this.doc.querySelector("."+n);if(caretPlaceholder){o=rangy.createRange(this.doc);o.selectNode(caretPlaceholder);o.deleteContents();this.setSelection(o)}else{h.focus()}if(p){h.scrollTop=f;h.scrollLeft=k}try{caretPlaceholder.parentNode.removeChild(caretPlaceholder)}catch(l){}},executeAndRestoreSimple:function(d){var h=this.getRange(),k=this.doc.body,r,f,g,n,l;if(!h){d(k,k);return}n=h.getNodes([3]);f=n[0]||h.startContainer;g=n[n.length-1]||h.endContainer;l={collapsed:h.collapsed,startContainer:f,startOffset:f===h.startContainer?h.startOffset:0,endContainer:g,endOffset:g===h.endContainer?h.endOffset:g.length};try{d(h.startContainer,h.endContainer)}catch(m){setTimeout(function(){throw m},0)}r=rangy.createRange(this.doc);try{r.setStart(l.startContainer,l.startOffset)}catch(q){}try{r.setEnd(l.endContainer,l.endOffset)}catch(p){}try{this.setSelection(r)}catch(o){}},insertHTML:function(e){var d=rangy.createRange(this.doc),g=d.createContextualFragment(e),f=g.lastChild;this.insertNode(g);if(f){this.setAfter(f)}},insertNode:function(e){var d=this.getRange();if(d){d.insertNode(e)}},surround:function(f){var d=this.getRange();if(!d){return}try{d.surroundContents(f);this.selectNode(f)}catch(g){f.appendChild(d.extractContents());d.insertNode(f)}},scrollIntoView:function(){var g=this.doc,f=g.documentElement.scrollHeight>g.documentElement.offsetHeight,d=g._wysihtml5ScrollIntoViewElement=g._wysihtml5ScrollIntoViewElement||(function(){var h=g.createElement("span");h.innerHTML=c.INVISIBLE_SPACE;return h})(),e;if(f){this.insertNode(d);e=a(d);d.parentNode.removeChild(d);if(e>g.body.scrollTop){g.body.scrollTop=e}}},selectLine:function(){if(c.browser.supportsSelectionModify()){this._selectLine_W3C()}else{if(this.doc.selection){this._selectLine_MSIE()}}},_selectLine_W3C:function(){var e=this.doc.defaultView,d=e.getSelection();d.modify("extend","left","lineboundary");d.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var l=this.doc.selection.createRange(),h=l.boundingTop,p=l.boundingHeight,k=this.doc.body.scrollWidth,e,d,m,g,f;if(!l.moveToPoint){return}if(h===0){m=this.doc.createElement("span");this.insertNode(m);h=m.offsetTop;m.parentNode.removeChild(m)}h+=1;for(g=-10;g<k;g+=2){try{l.moveToPoint(g,h);break}catch(o){}}e=h;d=this.doc.selection.createRange();for(f=k;f>=0;f--){try{d.moveToPoint(f,e);break}catch(n){}}l.setEndPoint("EndToEnd",d);l.select()},getText:function(){var d=this.getSelection();return d?d.toString():""},getNodes:function(d,f){var e=this.getRange();if(e){return e.getNodes([d],f)}else{return[]}},getRange:function(){var d=this.getSelection();return d&&d.rangeCount&&d.getRangeAt(0)},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(d){var f=this.doc.defaultView||this.doc.parentWindow,e=rangy.getSelection(f);return e.setSingleRange(d)}})})(wysihtml5);(function(p,l){var h="span";var f=/\s+/g;function d(s,q,r){if(!s.className){return false}var t=s.className.match(r)||[];return t[t.length-1]===q}function k(s,q,r){if(s.className){n(s,r);s.className+=" "+q}else{s.className=q}}function n(r,q){if(r.className){r.className=r.className.replace(q,"")}}function o(r,q){return r.className.replace(f," ")==q.className.replace(f," ")}function a(r){var q=r.parentNode;while(r.firstChild){q.insertBefore(r.firstChild,r)}q.removeChild(r)}function e(w,u){if(w.attributes.length!=u.attributes.length){return false}for(var v=0,q=w.attributes.length,t,r,s;v<q;++v){t=w.attributes[v];s=t.name;if(s!="class"){r=u.attributes.getNamedItem(s);if(t.specified!=r.specified){return false}if(t.specified&&t.nodeValue!==r.nodeValue){return false}}}return true}function c(q,r){if(l.dom.isCharacterDataNode(q)){if(r==0){return !!q.previousSibling}else{if(r==q.length){return !!q.nextSibling}else{return true}}}return r>0&&r<q.childNodes.length}function b(t,r,s){var q;if(l.dom.isCharacterDataNode(r)){if(s==0){s=l.dom.getNodeIndex(r);r=r.parentNode}else{if(s==r.length){s=l.dom.getNodeIndex(r)+1;r=r.parentNode}else{q=l.dom.splitDataNode(r,s)}}}if(!q){q=r.cloneNode(false);if(q.id){q.removeAttribute("id")}var u;while((u=r.childNodes[s])){q.appendChild(u)}l.dom.insertAfter(q,r)}return(r==t)?q:b(t,q.parentNode,l.dom.getNodeIndex(q))}function g(q){this.isElementMerge=(q.nodeType==p.ELEMENT_NODE);this.firstTextNode=this.isElementMerge?q.lastChild:q;this.textNodes=[this.firstTextNode]}g.prototype={doMerge:function(){var v=[],u,s,t;for(var r=0,q=this.textNodes.length;r<q;++r){u=this.textNodes[r];s=u.parentNode;v[r]=u.data;if(r){s.removeChild(u);if(!s.hasChildNodes()){s.parentNode.removeChild(s)}}}this.firstTextNode.data=t=v.join("");return t},getLength:function(){var r=this.textNodes.length,q=0;while(r--){q+=this.textNodes[r].length}return q},toString:function(){var s=[];for(var r=0,q=this.textNodes.length;r<q;++r){s[r]="'"+this.textNodes[r].data+"'"}return"[Merge("+s.join(",")+")]"}};function m(q,s,r,t){this.tagNames=q||[h];this.cssClass=s||"";this.similarClassRegExp=r;this.normalize=t;this.applyToAnyTagName=false}m.prototype={getAncestorWithClass:function(r){var q;while(r){q=this.cssClass?d(r,this.cssClass,this.similarClassRegExp):true;if(r.nodeType==p.ELEMENT_NODE&&l.dom.arrayContains(this.tagNames,r.tagName.toLowerCase())&&q){return r}r=r.parentNode}return false},postApply:function(C,y){var q=C[0],r=C[C.length-1];var t=[],D;var v=q,s=r;var A=0,E=r.length;var u,x;for(var w=0,z=C.length;w<z;++w){u=C[w];x=this.getAdjacentMergeableTextNode(u.parentNode,false);if(x){if(!D){D=new g(x);t.push(D)}D.textNodes.push(u);if(u===q){v=D.firstTextNode;A=v.length}if(u===r){s=D.firstTextNode;E=D.getLength()}}else{D=null}}var B=this.getAdjacentMergeableTextNode(r.parentNode,true);if(B){if(!D){D=new g(r);t.push(D)}D.textNodes.push(B)}if(t.length){for(w=0,z=t.length;w<z;++w){t[w].doMerge()}y.setStart(v,A);y.setEnd(s,E)}},getAdjacentMergeableTextNode:function(s,q){var u=(s.nodeType==p.TEXT_NODE);var r=u?s.parentNode:s;var v;var t=q?"nextSibling":"previousSibling";if(u){v=s[t];if(v&&v.nodeType==p.TEXT_NODE){return v}}else{v=r[t];if(v&&this.areElementsMergeable(s,v)){return v[q?"firstChild":"lastChild"]}}return null},areElementsMergeable:function(r,q){return l.dom.arrayContains(this.tagNames,(r.tagName||"").toLowerCase())&&l.dom.arrayContains(this.tagNames,(q.tagName||"").toLowerCase())&&o(r,q)&&e(r,q)},createContainer:function(r){var q=r.createElement(this.tagNames[0]);if(this.cssClass){q.className=this.cssClass}return q},applyToTextNode:function(s){var r=s.parentNode;if(r.childNodes.length==1&&l.dom.arrayContains(this.tagNames,r.tagName.toLowerCase())){if(this.cssClass){k(r,this.cssClass,this.similarClassRegExp)}}else{var q=this.createContainer(l.dom.getDocument(s));s.parentNode.insertBefore(q,s);q.appendChild(s)}},isRemovable:function(q){return l.dom.arrayContains(this.tagNames,q.tagName.toLowerCase())&&p.lang.string(q.className).trim()==this.cssClass},undoToTextNode:function(t,r,s){if(!r.containsNode(s)){var q=r.cloneRange();q.selectNode(s);if(q.isPointInRange(r.endContainer,r.endOffset)&&c(r.endContainer,r.endOffset)){b(s,r.endContainer,r.endOffset);r.setEndAfter(s)}if(q.isPointInRange(r.startContainer,r.startOffset)&&c(r.startContainer,r.startOffset)){s=b(s,r.startContainer,r.startOffset)}}if(this.similarClassRegExp){n(s,this.similarClassRegExp)}if(this.isRemovable(s)){a(s)}},applyToRange:function(r){var u=r.getNodes([p.TEXT_NODE]);if(!u.length){try{var t=this.createContainer(r.endContainer.ownerDocument);r.surroundContents(t);this.selectNode(r,t);return}catch(v){}}r.splitBoundaries();u=r.getNodes([p.TEXT_NODE]);if(u.length){var w;for(var s=0,q=u.length;s<q;++s){w=u[s];if(!this.getAncestorWithClass(w)){this.applyToTextNode(w)}}r.setStart(u[0],0);w=u[u.length-1];r.setEnd(w,w.length);if(this.normalize){this.postApply(u,r)}}},undoToRange:function(r){var u=r.getNodes([p.TEXT_NODE]),x,v;if(u.length){r.splitBoundaries();u=r.getNodes([p.TEXT_NODE])}else{var w=r.endContainer.ownerDocument,t=w.createTextNode(p.INVISIBLE_SPACE);r.insertNode(t);r.selectNode(t);u=[t]}for(var s=0,q=u.length;s<q;++s){x=u[s];v=this.getAncestorWithClass(x);if(v){this.undoToTextNode(x,r,v)}}if(q==1){this.selectNode(r,u[0])}else{r.setStart(u[0],0);x=u[u.length-1];r.setEnd(x,x.length);if(this.normalize){this.postApply(u,r)}}},selectNode:function(r,u){var t=u.nodeType===p.ELEMENT_NODE,q="canHaveHTML" in u?u.canHaveHTML:true,s=t?u.innerHTML:u.data,w=(s===""||s===p.INVISIBLE_SPACE);if(w&&t&&q){try{u.innerHTML=p.INVISIBLE_SPACE}catch(v){}}r.selectNodeContents(u);if(w&&t){r.collapse(false)}else{if(w){r.setStartAfter(u);r.setEndAfter(u)}}},getTextSelectedByRange:function(u,q){var r=q.cloneRange();r.selectNodeContents(u);var s=r.intersection(q);var t=s?s.toString():"";r.detach();return t},isAppliedToRange:function(r){var u=[],t,v=r.getNodes([p.TEXT_NODE]);if(!v.length){t=this.getAncestorWithClass(r.startContainer);return t?[t]:false}for(var s=0,q=v.length,w;s<q;++s){w=this.getTextSelectedByRange(v[s],r);t=this.getAncestorWithClass(v[s]);if(w!=""&&!t){return false}else{u.push(t)}}return u},toggleRange:function(q){if(this.isAppliedToRange(q)){this.undoToRange(q)}else{this.applyToRange(q)}}};p.selection.HTMLApplier=m})(wysihtml5,rangy);wysihtml5.Commands=Base.extend({constructor:function(a){this.editor=a;this.composer=a.composer;this.doc=this.composer.doc},support:function(a){return wysihtml5.browser.supportsCommand(this.doc,a)},exec:function(g,c){var f=wysihtml5.commands[g],b=wysihtml5.lang.array(arguments).get(),h=f&&f.exec,a=null;this.editor.fire("beforecommand:composer");if(h){b.unshift(this.composer);a=h.apply(f,b)}else{try{a=this.doc.execCommand(g,false,c)}catch(d){}}this.editor.fire("aftercommand:composer");return a},state:function(f,a){var d=wysihtml5.commands[f],b=wysihtml5.lang.array(arguments).get(),g=d&&d.state;if(g){b.unshift(this.composer);return g.apply(d,b)}else{try{return this.doc.queryCommandState(f)}catch(c){return false}}},value:function(c){var b=wysihtml5.commands[c],d=b&&b.value;if(d){return d.call(b,this.composer,c)}else{try{return this.doc.queryCommandValue(c)}catch(a){return null}}}});(function(b){var a;b.commands.bold={exec:function(c,d){return b.commands.formatInline.exec(c,d,"b")},state:function(d,e,c){return b.commands.formatInline.state(d,e,"b")},value:function(){return a}}})(wysihtml5);(function(f){var d,c="A",e=f.dom;function a(h,o){var n=o.length,k=0,g,m,l;for(;k<n;k++){g=o[k];m=e.getParentElement(g,{nodeName:"code"});l=e.getTextContent(g);if(l.match(e.autoLink.URL_REG_EXP)&&!m){m=e.renameElement(g,"code")}else{e.replaceWithChildNodes(g)}}}function b(g,m){var u=g.doc,r="_wysihtml5-temp-"+(+new Date()),w=/non-matching-class/g,q=0,k,h,p,t,o,n,s,v,l;f.commands.formatInline.exec(g,d,c,r,w);h=u.querySelectorAll(c+"."+r);k=h.length;for(;q<k;q++){p=h[q];p.removeAttribute("class");for(l in m){p.setAttribute(l,m[l])}}n=p;if(k===1){s=e.getTextContent(p);t=!!p.querySelector("*");o=s===""||s===f.INVISIBLE_SPACE;if(!t&&o){e.setTextContent(p,m.text||p.href);v=u.createTextNode(" ");g.selection.setAfter(p);g.selection.insertNode(v);n=v}}g.selection.setAfter(n)}f.commands.createLink={exec:function(g,l,k){var h=this.state(g,l);if(h){g.selection.executeAndRestore(function(){a(g,h)})}else{k=typeof(k)==="object"?k:{href:k};b(g,k)}},state:function(g,h){return f.commands.formatInline.state(g,h,"A")},value:function(){return d}}})(wysihtml5);(function(c){var b,a=/wysiwyg-font-size-[a-z\-]+/g;c.commands.fontSize={exec:function(d,f,e){return c.commands.formatInline.exec(d,f,"span","wysiwyg-font-size-"+e,a)},state:function(d,f,e){return c.commands.formatInline.state(d,f,"span","wysiwyg-font-size-"+e,a)},value:function(){return b}}})(wysihtml5);(function(c){var b,a=/wysiwyg-color-[a-z]+/g;c.commands.foreColor={exec:function(e,f,d){return c.commands.formatInline.exec(e,f,"span","wysiwyg-color-"+d,a)},state:function(e,f,d){return c.commands.formatInline.state(e,f,"span","wysiwyg-color-"+d,a)},value:function(){return b}}})(wysihtml5);(function(h){var b,q=h.dom,a="DIV",r=["H1","H2","H3","H4","H5","H6","P","BLOCKQUOTE",a];function o(u,v,w){if(u.className){g(u,w);u.className+=" "+v}else{u.className=v}}function g(u,v){u.className=u.className.replace(v,"")}function k(u){return u.nodeType===h.TEXT_NODE&&!h.lang.string(u.data).trim()}function l(v){var u=v.previousSibling;while(u&&k(u)){u=u.previousSibling}return u}function m(u){var v=u.nextSibling;while(v&&k(v)){v=v.nextSibling}return v}function f(v){var x=v.ownerDocument,w=m(v),u=l(v);if(w&&!e(w)){v.parentNode.insertBefore(x.createElement("br"),w)}if(u&&!e(u)){v.parentNode.insertBefore(x.createElement("br"),v)}}function c(v){var w=m(v),u=l(v);if(w&&n(w)){w.parentNode.removeChild(w)}if(u&&n(u)){u.parentNode.removeChild(u)}}function p(v){var u=v.lastChild;if(u&&n(u)){u.parentNode.removeChild(u)}}function n(u){return u.nodeName==="BR"}function e(u){if(n(u)){return true}if(q.getStyle("display").from(u)==="block"){return true}return false}function d(w,x,y,v){if(v){var u=q.observe(w,"DOMNodeInserted",function(A){var B=A.target,z;if(B.nodeType!==h.ELEMENT_NODE){return}z=q.getStyle("display").from(B);if(z.substr(0,6)!=="inline"){B.className+=" "+v}})}w.execCommand(x,false,y);if(u){u.stop()}}function s(u,v){u.selection.selectLine();u.selection.surround(v);c(v);p(v);u.selection.selectNode(v)}function t(u){return !!h.lang.string(u.className).trim()}h.commands.formatBlock={exec:function(u,A,B,v,x){var y=u.doc,z=this.state(u,A,B,v,x),w;B=typeof(B)==="string"?B.toUpperCase():B;if(z){u.selection.executeAndRestoreSimple(function(){if(x){g(z,x)}var C=t(z);if(!C&&z.nodeName===(B||a)){f(z);q.replaceWithChildNodes(z)}else{if(C){q.renameElement(z,a)}}});return}if(B===null||h.lang.array(r).contains(B)){w=u.selection.getSelectedNode();z=q.getParentElement(w,{nodeName:r});if(z){u.selection.executeAndRestoreSimple(function(){if(B){z=q.renameElement(z,B)}if(v){o(z,v,x)}});return}}if(u.commands.support(A)){d(y,A,B||a,v);return}z=y.createElement(B||a);if(v){z.className=v}s(u,z)},state:function(u,y,z,v,x){z=typeof(z)==="string"?z.toUpperCase():z;var w=u.selection.getSelectedNode();return q.getParentElement(w,{nodeName:z,className:v,classRegExp:x})},value:function(){return b}}})(wysihtml5);(function(f){var c,d={strong:"b",em:"i",b:"strong",i:"em"},e={};function b(h){var g=d[h];return g?[h.toLowerCase(),g.toLowerCase()]:[h.toLowerCase()]}function a(h,k,l){var g=h+":"+k;if(!e[g]){e[g]=new f.selection.HTMLApplier(b(h),k,l,true)}return e[g]}f.commands.formatInline={exec:function(h,n,k,l,m){var g=h.selection.getRange();if(!g){return false}a(k,l,m).toggleRange(g);h.selection.setSelection(g)},state:function(h,o,k,l,m){var n=h.doc,p=d[k]||k,g;if(!f.dom.hasElementWithTagName(n,k)&&!f.dom.hasElementWithTagName(n,p)){return false}if(l&&!f.dom.hasElementWithClassName(n,l)){return false}g=h.selection.getRange();if(!g){return false}return a(k,l,m).isAppliedToRange(g)},value:function(){return c}}})(wysihtml5);(function(b){var a;b.commands.insertHTML={exec:function(c,e,d){if(c.commands.support(e)){c.doc.execCommand(e,false,d)}else{c.selection.insertHTML(d)}},state:function(){return false},value:function(){return a}}})(wysihtml5);(function(b){var a="IMG";b.commands.insertImage={exec:function(c,l,f){f=typeof(f)==="object"?f:{src:f};var h=c.doc,g=this.state(c),k,d,e;if(g){c.selection.setBefore(g);e=g.parentNode;e.removeChild(g);b.dom.removeEmptyTextNodes(e);if(e.nodeName==="A"&&!e.firstChild){c.selection.setAfter(e);e.parentNode.removeChild(e)}b.quirks.redraw(c.element);return}g=h.createElement(a);for(d in f){g[d]=f[d]}c.selection.insertNode(g);if(b.browser.hasProblemsSettingCaretAfterImg()){k=h.createTextNode(b.INVISIBLE_SPACE);c.selection.insertNode(k);c.selection.setAfter(k)}else{c.selection.setAfter(g)}},state:function(d){var f=d.doc,e,g,c;if(!b.dom.hasElementWithTagName(f,a)){return false}e=d.selection.getSelectedNode();if(!e){return false}if(e.nodeName===a){return e}if(e.nodeType!==b.ELEMENT_NODE){return false}g=d.selection.getText();g=b.lang.string(g).trim();if(g){return false}c=d.selection.getNodes(b.ELEMENT_NODE,function(h){return h.nodeName==="IMG"});if(c.length!==1){return false}return c[0]},value:function(c){var d=this.state(c);return d&&d.src}}})(wysihtml5);(function(c){var b,a="<br>"+(c.browser.needsSpaceAfterLineBreak()?" ":"");c.commands.insertLineBreak={exec:function(d,e){if(d.commands.support(e)){d.doc.execCommand(e,false,null);if(!c.browser.autoScrollsToCaret()){d.selection.scrollIntoView()}}else{d.commands.exec("insertHTML",a)}},state:function(){return false},value:function(){return b}}})(wysihtml5);(function(b){var a;b.commands.insertOrderedList={exec:function(c,f){var m=c.doc,h=c.selection.getSelectedNode(),k=b.dom.getParentElement(h,{nodeName:"OL"}),l=b.dom.getParentElement(h,{nodeName:"UL"}),e="_wysihtml5-temp-"+new Date().getTime(),g,d;if(c.commands.support(f)){m.execCommand(f,false,null);return}if(k){c.selection.executeAndRestoreSimple(function(){b.dom.resolveList(k)})}else{if(l){c.selection.executeAndRestoreSimple(function(){b.dom.renameElement(l,"ol")})}else{c.commands.exec("formatBlock","div",e);d=m.querySelector("."+e);g=d.innerHTML===""||d.innerHTML===b.INVISIBLE_SPACE;c.selection.executeAndRestoreSimple(function(){k=b.dom.convertToList(d,"ol")});if(g){c.selection.selectNode(k.querySelector("li"))}}}},state:function(c){var d=c.selection.getSelectedNode();return b.dom.getParentElement(d,{nodeName:"OL"})},value:function(){return a}}})(wysihtml5);(function(b){var a;b.commands.insertUnorderedList={exec:function(c,f){var m=c.doc,h=c.selection.getSelectedNode(),k=b.dom.getParentElement(h,{nodeName:"UL"}),l=b.dom.getParentElement(h,{nodeName:"OL"}),e="_wysihtml5-temp-"+new Date().getTime(),g,d;if(c.commands.support(f)){m.execCommand(f,false,null);return}if(k){c.selection.executeAndRestoreSimple(function(){b.dom.resolveList(k)})}else{if(l){c.selection.executeAndRestoreSimple(function(){b.dom.renameElement(l,"ul")})}else{c.commands.exec("formatBlock","div",e);d=m.querySelector("."+e);g=d.innerHTML===""||d.innerHTML===b.INVISIBLE_SPACE;c.selection.executeAndRestoreSimple(function(){k=b.dom.convertToList(d,"ul")});if(g){c.selection.selectNode(k.querySelector("li"))}}}},state:function(c){var d=c.selection.getSelectedNode();return b.dom.getParentElement(d,{nodeName:"UL"})},value:function(){return a}}})(wysihtml5);(function(b){var a;b.commands.italic={exec:function(c,d){return b.commands.formatInline.exec(c,d,"i")},state:function(d,e,c){return b.commands.formatInline.state(d,e,"i")},value:function(){return a}}})(wysihtml5);(function(d){var b,c="wysiwyg-text-align-center",a=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyCenter={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,c,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,c,a)},value:function(){return b}}})(wysihtml5);(function(d){var b,c="wysiwyg-text-align-left",a=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyLeft={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,c,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,c,a)},value:function(){return b}}})(wysihtml5);(function(d){var b,c="wysiwyg-text-align-right",a=/wysiwyg-text-align-[a-z]+/g;d.commands.justifyRight={exec:function(e,f){return d.commands.formatBlock.exec(e,"formatBlock",null,c,a)},state:function(e,f){return d.commands.formatBlock.state(e,"formatBlock",null,c,a)},value:function(){return b}}})(wysihtml5);(function(b){var a;b.commands.underline={exec:function(c,d){return b.commands.formatInline.exec(c,d,"u")},state:function(c,d){return b.commands.formatInline.state(c,d,"u")},value:function(){return a}}})(wysihtml5);(function(l){var f=90,h=89,k=8,b=46,a=40,g='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+l.INVISIBLE_SPACE+"</span>",e='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+l.INVISIBLE_SPACE+"</span>",d=l.dom;function c(n){var m;while(m=n.querySelector("._wysihtml5-temp")){m.parentNode.removeChild(m)}}l.UndoManager=l.lang.Dispatcher.extend({constructor:function(m){this.editor=m;this.composer=m.composer;this.element=this.composer.element;this.history=[this.composer.getValue()];this.position=1;if(this.composer.commands.support("insertHTML")){this._observe()}},_observe:function(){var p=this,r=this.composer.sandbox.getDocument(),m;d.observe(this.element,"keydown",function(u){if(u.altKey||(!u.ctrlKey&&!u.metaKey)){return}var v=u.keyCode,s=v===f&&!u.shiftKey,t=(v===f&&u.shiftKey)||(v===h);if(s){p.undo();u.preventDefault()}else{if(t){p.redo();u.preventDefault()}}});d.observe(this.element,"keydown",function(s){var t=s.keyCode;if(t===m){return}m=t;if(t===k||t===b){p.transact()}});if(l.browser.hasUndoInContextMenu()){var n,o,q=function(){c(r);clearInterval(n)};d.observe(this.element,"contextmenu",function(){q();p.composer.selection.executeAndRestoreSimple(function(){if(p.element.lastChild){p.composer.selection.setAfter(p.element.lastChild)}r.execCommand("insertHTML",false,g);r.execCommand("insertHTML",false,e);r.execCommand("undo",false,null)});n=setInterval(function(){if(r.getElementById("_wysihtml5-redo")){q();p.redo()}else{if(!r.getElementById("_wysihtml5-undo")){q();p.undo()}}},400);if(!o){o=true;d.observe(document,"mousedown",q);d.observe(r,["mousedown","paste","cut","copy"],q)}})}this.editor.observe("newword:composer",function(){p.transact()}).observe("beforecommand:composer",function(){p.transact()})},transact:function(){var o=this.history[this.position-1],m=this.composer.getValue();if(m==o){return}var n=this.history.length=this.position;if(n>a){this.history.shift();this.position--}this.position++;this.history.push(m)},undo:function(){this.transact();if(this.position<=1){return}this.set(this.history[--this.position-1]);this.editor.fire("undo:composer")},redo:function(){if(this.position>=this.history.length){return}this.set(this.history[++this.position-1]);this.editor.fire("redo:composer")},set:function(m){this.composer.setValue(m);this.editor.focus(true)}})})(wysihtml5);wysihtml5.views.View=Base.extend({constructor:function(b,c,a){this.parent=b;this.element=c;this.config=a;this._observeViewChange()},_observeViewChange:function(){var a=this;this.parent.observe("beforeload",function(){a.parent.observe("change_view",function(b){if(b===a.name){a.parent.currentView=a;a.show();setTimeout(function(){a.focus()},0)}else{a.hide()}})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")===this.element){return}try{this.element.focus()}catch(a){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}});(function(c){var b=c.dom,a=c.browser;c.views.Composer=c.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,f,d){this.base(e,f,d);this.textarea=this.parent.textarea;this._initSandbox()},clear:function(){this.element.innerHTML=a.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(e){var d=this.isEmpty()?"":c.quirks.getCorrectInnerHTML(this.element);if(e){d=this.parent.parse(d)}d=c.lang.string(d).replace(c.INVISIBLE_SPACE).by("");return d},setValue:function(d,e){if(e){d=this.parent.parse(d)}this.element.innerHTML=d},show:function(){this.iframe.style.display=this._displayStyle||"";this.disable();this.enable()},hide:function(){this._displayStyle=b.getStyle("display").from(this.iframe);if(this._displayStyle==="none"){this._displayStyle=null}this.iframe.style.display="none"},disable:function(){this.element.removeAttribute("contentEditable");this.base()},enable:function(){this.element.setAttribute("contentEditable","true");this.base()},focus:function(e){if(c.browser.doesAsyncFocus()&&this.hasPlaceholderSet()){this.clear()}this.base();var d=this.element.lastChild;if(e&&d){if(d.nodeName==="BR"){this.selection.setBefore(this.element.lastChild)}else{this.selection.setAfter(this.element.lastChild)}}},getTextContent:function(){return b.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==this.textarea.element.getAttribute("placeholder")},isEmpty:function(){var e=this.element.innerHTML,d="blockquote, ul, ol, img, embed, object, table, iframe, svg, video, audio, button, input, select, textarea";return e===""||e===this.CARET_HACK||this.hasPlaceholderSet()||(this.getTextContent()===""&&!this.element.querySelector(d))},_initSandbox:function(){var e=this;this.sandbox=new b.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets});this.iframe=this.sandbox.getIframe();var d=document.createElement("input");d.type="hidden";d.name="_wysihtml5_mode";d.value=1;var f=this.textarea.element;b.insert(this.iframe).after(f);b.insert(d).after(f)},_create:function(){var f=this;this.doc=this.sandbox.getDocument();this.element=this.doc.body;this.textarea=this.parent.textarea;this.element.innerHTML=this.textarea.getValue(true);this.enable();this.selection=new c.Selection(this.parent);this.commands=new c.Commands(this.parent);b.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element);b.addClass(this.element,this.config.composerClassName);if(this.config.style){this.style()}this.observe();var e=this.config.name;if(e){b.addClass(this.element,e);b.addClass(this.iframe,e)}var d=typeof(this.config.placeholder)==="string"?this.config.placeholder:this.textarea.element.getAttribute("placeholder");if(d){b.simulatePlaceholder(this.parent,this,d)}this.commands.exec("styleWithCSS",false);this._initAutoLinking();this._initObjectResizing();this._initUndoManager();if(this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element){setTimeout(function(){f.focus()},100)}c.quirks.insertLineBreakOnReturn(this);if(!a.clearsContentEditableCorrectly()){c.quirks.ensureProperClearing(this)}if(!a.clearsListsInContentEditableCorrectly()){c.quirks.ensureProperClearingOfLists(this)}if(this.initSync&&this.config.sync){this.initSync()}this.textarea.hide();this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var h=this,e=a.canDisableAutoLinking(),f=a.doesAutoLinkingInContentEditable();if(e){this.commands.exec("autoUrlDetect",false)}if(!this.config.autoLink){return}if(!f||(f&&e)){this.parent.observe("newword:composer",function(){h.selection.executeAndRestore(function(l,m){b.autoLink(m.parentNode)})})}var d=this.sandbox.getDocument().getElementsByTagName("a"),k=b.autoLink.URL_REG_EXP,g=function(l){var m=c.lang.string(b.getTextContent(l)).trim();if(m.substr(0,4)==="www."){m="http://"+m}return m};b.observe(this.element,"keydown",function(n){if(!d.length){return}var o=h.selection.getSelectedNode(n.target.ownerDocument),m=b.getParentElement(o,{nodeName:"A"},4),l;if(!m){return}l=g(m);setTimeout(function(){var p=g(m);if(p===l){return}if(p.match(k)){m.setAttribute("href",p)}},0)})},_initObjectResizing:function(){var f=["width","height"],e=f.length,d=this.element;this.commands.exec("enableObjectResizing",this.config.allowObjectResizing);if(this.config.allowObjectResizing){if(a.supportsEvent("resizeend")){b.observe(d,"resizeend",function(k){var m=k.target||k.srcElement,h=m.style,g=0,l;for(;g<e;g++){l=f[g];if(h[l]){m.setAttribute(l,parseInt(h[l],10));h[l]=""}}c.quirks.redraw(d)})}}else{if(a.supportsEvent("resizestart")){b.observe(d,"resizestart",function(g){g.preventDefault()})}}},_initUndoManager:function(){new c.UndoManager(this.parent)}})})(wysihtml5);(function(l){var a=l.dom,g=document,d=window,e=g.createElement("div"),b=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],h=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],c=["width","height","top","left","right","bottom"],f=["html             { height: 100%; }","body             { min-height: 100%; padding: 0; margin: 0; margin-top: -1px; padding-top: 1px; }","._wysihtml5-temp { display: none; }",l.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","body[disabled]   { background-color: #eee !important; color: #999 !important; cursor: default !important; }","img:-moz-broken  { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"];var k=function(o){if(o.setActive){try{o.setActive()}catch(q){}}else{var p=o.style,r=g.documentElement.scrollTop||g.body.scrollTop,n=g.documentElement.scrollLeft||g.body.scrollLeft,m={position:p.position,top:p.top,left:p.left,WebkitUserSelect:p.WebkitUserSelect};a.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(o);o.focus();a.setStyles(m).on(o);if(d.scrollTo){d.scrollTo(n,r)}}};l.views.Composer.prototype.style=function(){var q=this,p=g.querySelector(":focus"),s=this.textarea.element,m=s.hasAttribute("placeholder"),r=m&&s.getAttribute("placeholder");this.focusStylesHost=this.focusStylesHost||e.cloneNode(false);this.blurStylesHost=this.blurStylesHost||e.cloneNode(false);if(m){s.removeAttribute("placeholder")}if(s===p){s.blur()}a.copyStyles(h).from(s).to(this.iframe).andTo(this.blurStylesHost);a.copyStyles(b).from(s).to(this.element).andTo(this.blurStylesHost);a.insertCSS(f).into(this.element.ownerDocument);k(s);a.copyStyles(h).from(s).to(this.focusStylesHost);a.copyStyles(b).from(s).to(this.focusStylesHost);var o=l.lang.array(h).without(["display"]);if(p){p.focus()}else{s.blur()}if(m){s.setAttribute("placeholder",r)}if(!l.browser.hasCurrentStyleProperty()){var n=a.observe(d,"resize",function(){if(!a.contains(document.documentElement,q.iframe)){n.stop();return}var u=a.getStyle("display").from(s),t=a.getStyle("display").from(q.iframe);s.style.display="";q.iframe.style.display="none";a.copyStyles(c).from(s).to(q.iframe).andTo(q.focusStylesHost).andTo(q.blurStylesHost);q.iframe.style.display=t;s.style.display=u})}this.parent.observe("focus:composer",function(){a.copyStyles(o).from(q.focusStylesHost).to(q.iframe);a.copyStyles(b).from(q.focusStylesHost).to(q.element)});this.parent.observe("blur:composer",function(){a.copyStyles(o).from(q.blurStylesHost).to(q.iframe);a.copyStyles(b).from(q.blurStylesHost).to(q.element)});return this}})(wysihtml5);(function(d){var c=d.dom,b=d.browser,a={"66":"bold","73":"italic","85":"underline"};d.views.Composer.prototype.observe=function(){var k=this,m=this.getValue(),h=this.sandbox.getIframe(),g=this.element,f=b.supportsEventsInIframeCorrectly()?g:this.sandbox.getWindow(),e=b.supportsEvent("drop")?["drop","paste"]:["dragdrop","paste"];c.observe(h,"DOMNodeRemoved",function(){clearInterval(l);k.parent.fire("destroy:composer")});var l=setInterval(function(){if(!c.contains(document.documentElement,h)){clearInterval(l);k.parent.fire("destroy:composer")}},250);c.observe(f,"focus",function(){k.parent.fire("focus").fire("focus:composer");setTimeout(function(){m=k.getValue()},0)});c.observe(f,"blur",function(){if(m!==k.getValue()){k.parent.fire("change").fire("change:composer")}k.parent.fire("blur").fire("blur:composer")});if(d.browser.isIos()){c.observe(g,"blur",function(){var p=g.ownerDocument.createElement("input"),r=document.documentElement.scrollTop||document.body.scrollTop,o=document.documentElement.scrollLeft||document.body.scrollLeft;try{k.selection.insertNode(p)}catch(q){g.appendChild(p)}p.focus();p.parentNode.removeChild(p);window.scrollTo(o,r)})}c.observe(g,"dragenter",function(){k.parent.fire("unset_placeholder")});if(b.firesOnDropOnlyWhenOnDragOverIsCancelled()){c.observe(g,["dragover","dragenter"],function(o){o.preventDefault()})}c.observe(g,e,function(o){var q=o.dataTransfer,p;console.log("PASTED",o);if(q&&b.supportsDataTransfer()){p=q.getData("text/html")||q.getData("text/plain")}if(p){g.focus();k.commands.exec("insertHTML",p);k.parent.fire("paste").fire("paste:composer");o.stopPropagation();o.preventDefault()}else{setTimeout(function(){k.parent.fire("paste").fire("paste:composer")},0)}});c.observe(g,"keyup",function(o){var p=o.keyCode;if(p===d.SPACE_KEY||p===d.ENTER_KEY){k.parent.fire("newword:composer")}});this.parent.observe("paste:composer",function(){setTimeout(function(){k.parent.fire("newword:composer")},0)});if(!b.canSelectImagesInContentEditable()){c.observe(g,"mousedown",function(o){var p=o.target;if(p.nodeName==="IMG"){k.selection.selectNode(p);o.preventDefault()}})}c.observe(g,"keydown",function(o){var p=o.keyCode,q=a[p];if((o.ctrlKey||o.metaKey)&&!o.altKey&&q){k.commands.exec(q);o.preventDefault()}});c.observe(g,"keydown",function(p){var r=k.selection.getSelectedNode(true),q=p.keyCode,o;if(r&&r.nodeName==="IMG"&&(q===d.BACKSPACE_KEY||q===d.DELETE_KEY)){o=r.parentNode;o.removeChild(r);if(o.nodeName==="A"&&!o.firstChild){o.parentNode.removeChild(o)}setTimeout(function(){d.quirks.redraw(g)},0);p.preventDefault()}});var n={IMG:"Image: ",A:"Link: "};c.observe(g,"mouseover",function(p){var q=p.target,s=q.nodeName,r;if(s!=="A"&&s!=="IMG"){return}var o=q.hasAttribute("title");if(!o){r=n[s]+(q.getAttribute("href")||q.getAttribute("src"));q.setAttribute("title",r)}})}})(wysihtml5);(function(b){var a=400;b.views.Synchronizer=Base.extend({constructor:function(e,c,d){this.editor=e;this.textarea=c;this.composer=d;this._observe()},fromComposerToTextarea:function(c){this.textarea.setValue(b.lang.string(this.composer.getValue()).trim(),c)},fromTextareaToComposer:function(d){var c=this.textarea.getValue();if(c){this.composer.setValue(c,d)}else{this.composer.clear();this.editor.fire("set_placeholder")}},sync:function(c){if(this.editor.currentView.name==="textarea"){this.fromTextareaToComposer(c)}else{this.fromComposerToTextarea(c)}},_observe:function(){var c,e=this,d=this.textarea.element.form,g=function(){c=setInterval(function(){e.fromComposerToTextarea()},a)},f=function(){clearInterval(c);c=null};g();if(d){b.dom.observe(d,"submit",function(){e.sync(true)});b.dom.observe(d,"reset",function(){setTimeout(function(){e.fromTextareaToComposer()},0)})}this.editor.observe("change_view",function(h){if(h==="composer"&&!c){e.fromTextareaToComposer(true);g()}else{if(h==="textarea"){e.fromComposerToTextarea(true);f()}}});this.editor.observe("destroy:composer",f)}})})(wysihtml5);wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(b,c,a){this.base(b,c,a);this._observe()},clear:function(){this.element.value=""},getValue:function(b){var a=this.isEmpty()?"":this.element.value;if(b){a=this.parent.parse(a)}return a},setValue:function(a,b){if(b){a=this.parent.parse(a)}this.element.value=a},hasPlaceholderSet:function(){var d=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),a=this.element.getAttribute("placeholder")||null,b=this.element.value,c=!b;return(d&&c)||(b===a)},isEmpty:function(){return !wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var c=this.element,d=this.parent,a={focusin:"focus",focusout:"blur"},b=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];d.observe("beforeload",function(){wysihtml5.dom.observe(c,b,function(f){var e=a[f.type]||f.type;d.fire(e).fire(e+":textarea")});wysihtml5.dom.observe(c,["paste","drop"],function(){setTimeout(function(){d.fire("paste").fire("paste:textarea")},0)})})}});(function(f){var e=f.dom,a="wysihtml5-command-dialog-opened",d="input, select, textarea",b="[data-wysihtml5-dialog-field]",c="data-wysihtml5-dialog-field";f.toolbar.Dialog=f.lang.Dispatcher.extend({constructor:function(h,g){this.link=h;this.container=g},_observe:function(){if(this._observed){return}var l=this,m=function(p){var o=l._serialize();if(o==l.elementToChange){l.fire("edit",o)}else{l.fire("save",o)}l.hide();p.preventDefault();p.stopPropagation()};e.observe(l.link,"click",function(o){if(e.hasClass(l.link,a)){setTimeout(function(){l.hide()},0)}});e.observe(this.container,"keydown",function(o){var p=o.keyCode;if(p===f.ENTER_KEY){m(o)}if(p===f.ESCAPE_KEY){l.hide()}});e.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",m);e.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(o){l.fire("cancel");l.hide();o.preventDefault();o.stopPropagation()});var h=this.container.querySelectorAll(d),g=0,k=h.length,n=function(){clearInterval(l.interval)};for(;g<k;g++){e.observe(h[g],"change",n)}this._observed=true},_serialize:function(){var l=this.elementToChange||{},g=this.container.querySelectorAll(b),k=g.length,h=0;for(;h<k;h++){l[g[h].getAttribute(c)]=g[h].value}return l},_interpolate:function(n){var m,p,l,o=document.querySelector(":focus"),g=this.container.querySelectorAll(b),k=g.length,h=0;for(;h<k;h++){m=g[h];if(m===o){continue}if(n&&m.type==="hidden"){continue}p=m.getAttribute(c);l=this.elementToChange?(this.elementToChange[p]||""):m.defaultValue;m.value=l}},show:function(l){var h=this,g=this.container.querySelector(d);this.elementToChange=l;this._observe();this._interpolate();if(l){this.interval=setInterval(function(){h._interpolate(true)},500)}e.addClass(this.link,a);this.container.style.display="";this.fire("show");if(g&&!l){try{g.focus()}catch(k){}}},hide:function(){clearInterval(this.interval);this.elementToChange=null;e.removeClass(this.link,a);this.container.style.display="none";this.fire("hide")}})})(wysihtml5);(function(f){var e=f.dom;var d={position:"relative"};var c={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1};var b={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"};var a={"x-webkit-speech":"",speech:""};f.toolbar.Speech=function(k,l){var h=document.createElement("input");if(!f.browser.supportsSpeechApiOn(h)){l.style.display="none";return}var m=document.createElement("div");f.lang.object(c).merge({width:l.offsetWidth+"px",height:l.offsetHeight+"px"});e.insert(h).into(m);e.insert(m).into(l);e.setStyles(b).on(h);e.setAttributes(a).on(h);e.setStyles(c).on(m);e.setStyles(d).on(l);var g="onwebkitspeechchange" in h?"webkitspeechchange":"speechchange";e.observe(h,g,function(){k.execCommand("insertText",h.value);h.value=""});e.observe(h,"click",function(n){if(e.hasClass(l,"wysihtml5-command-disabled")){n.preventDefault()}n.stopPropagation()})}})(wysihtml5);(function(f){var a="wysihtml5-command-disabled",b="wysihtml5-commands-disabled",c="wysihtml5-command-active",d="wysihtml5-action-active",e=f.dom;f.toolbar.Toolbar=Base.extend({constructor:function(l,g){this.editor=l;this.container=typeof(g)==="string"?document.getElementById(g):g;this.composer=l.composer;this._getLinks("command");this._getLinks("action");this._observe();this.show();var h=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),m=h.length,k=0;for(;k<m;k++){new f.toolbar.Speech(this,h[k])}},_getLinks:function(n){var r=this[n+"Links"]=f.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+n+"]")).get(),k=r.length,l=0,g=this[n+"Mapping"]={},o,q,h,p,m;for(;l<k;l++){o=r[l];h=o.getAttribute("data-wysihtml5-"+n);p=o.getAttribute("data-wysihtml5-"+n+"-value");q=this.container.querySelector("[data-wysihtml5-"+n+"-group='"+h+"']");m=this._getDialog(o,h);g[h+":"+p]={link:o,group:q,name:h,value:p,dialog:m,state:false}}},_getDialog:function(m,n){var l=this,k=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']"),h,g;if(k){h=new f.toolbar.Dialog(m,k);h.observe("show",function(){g=l.composer.selection.getBookmark();l.editor.fire("show:dialog",{command:n,dialogContainer:k,commandLink:m})});h.observe("save",function(o){if(g){l.composer.selection.setBookmark(g)}l._execCommand(n,o);l.editor.fire("save:dialog",{command:n,dialogContainer:k,commandLink:m})});h.observe("cancel",function(){l.editor.focus(false);l.editor.fire("cancel:dialog",{command:n,dialogContainer:k,commandLink:m})})}return h},execCommand:function(k,g){if(this.commandsDisabled){return}var h=this.commandMapping[k+":"+g];if(h&&h.dialog&&!h.state){h.dialog.show()}else{this._execCommand(k,g)}},_execCommand:function(h,g){this.editor.focus(false);this.composer.commands.exec(h,g);this._updateLinkStates()},execAction:function(h){var g=this.editor;switch(h){case"change_view":if(g.currentView===g.textarea){g.fire("change_view","composer")}else{g.fire("change_view","textarea")}break}},_observe:function(){var n=this,l=this.editor,g=this.container,h=this.commandLinks.concat(this.actionLinks),m=h.length,k=0;for(;k<m;k++){e.setAttributes({href:"javascript:;",unselectable:"on"}).on(h[k])}e.delegate(g,"[data-wysihtml5-command]","mousedown",function(o){o.preventDefault()});e.delegate(g,"[data-wysihtml5-command]","click",function(q){var p=this,r=p.getAttribute("data-wysihtml5-command"),o=p.getAttribute("data-wysihtml5-command-value");n.execCommand(r,o);q.preventDefault()});e.delegate(g,"[data-wysihtml5-action]","click",function(o){var p=this.getAttribute("data-wysihtml5-action");n.execAction(p);o.preventDefault()});l.observe("focus:composer",function(){n.bookmark=null;clearInterval(n.interval);n.interval=setInterval(function(){n._updateLinkStates()},500)});l.observe("blur:composer",function(){clearInterval(n.interval)});l.observe("destroy:composer",function(){clearInterval(n.interval)});l.observe("change_view",function(o){setTimeout(function(){n.commandsDisabled=(o!=="composer");n._updateLinkStates();if(n.commandsDisabled){e.addClass(g,b)}else{e.removeClass(g,b)}},0)})},_updateLinkStates:function(){var k=this.composer.element,h=this.commandMapping,n=this.actionMapping,g,m,l,o;for(g in h){o=h[g];if(this.commandsDisabled){m=false;e.removeClass(o.link,c);if(o.group){e.removeClass(o.group,c)}if(o.dialog){o.dialog.hide()}}else{m=this.composer.commands.state(o.name,o.value);if(f.lang.object(m).isArray()){m=m.length===1?m[0]:true}e.removeClass(o.link,a);if(o.group){e.removeClass(o.group,a)}}if(o.state===m){continue}o.state=m;if(m){e.addClass(o.link,c);if(o.group){e.addClass(o.group,c)}if(o.dialog){if(typeof(m)==="object"){o.dialog.show(m)}else{o.dialog.hide()}}}else{e.removeClass(o.link,c);if(o.group){e.removeClass(o.group,c)}if(o.dialog){o.dialog.hide()}}}for(g in n){l=n[g];if(l.name==="change_view"){l.state=this.editor.currentView===this.editor.textarea;if(l.state){e.addClass(l.link,d)}else{e.removeClass(l.link,d)}}}},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})})(wysihtml5);(function(c){var b;var a={name:b,style:true,toolbar:b,autoLink:true,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:c.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",stylesheets:[],placeholderText:b,allowObjectResizing:true,supportTouchDevices:true};c.Editor=c.lang.Dispatcher.extend({constructor:function(f,d){this.textareaElement=typeof(f)==="string"?document.getElementById(f):f;this.config=c.lang.object({}).merge(a).merge(d).get();this.textarea=new c.views.Textarea(this,this.textareaElement,this.config);this.currentView=this.textarea;this._isCompatible=c.browser.supported();if(!this._isCompatible||(!this.config.supportTouchDevices&&c.browser.isTouchDevice())){var e=this;setTimeout(function(){e.fire("beforeload").fire("load")},0);return}c.dom.addClass(document.body,this.config.bodyClassName);this.composer=new c.views.Composer(this,this.textareaElement,this.config);this.currentView=this.composer;if(typeof(this.config.parser)==="function"){this._initParser()}this.observe("beforeload",function(){this.synchronizer=new c.views.Synchronizer(this,this.textarea,this.composer);if(this.config.toolbar){this.toolbar=new c.toolbar.Toolbar(this,this.config.toolbar)}})},isCompatible:function(){return this._isCompatible},clear:function(){this.currentView.clear();return this},getValue:function(d){return this.currentView.getValue(d)},setValue:function(d,e){if(!d){return this.clear()}this.currentView.setValue(d,e);return this},focus:function(d){this.currentView.focus(d);return this},disable:function(){this.currentView.disable();return this},enable:function(){this.currentView.enable();return this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(d){var e=this.config.parser(d,this.config.parserRules,this.composer.sandbox.getDocument(),true);if(typeof(d)==="object"){c.quirks.redraw(d)}return e},_initParser:function(){this.observe("paste:composer",function(){var d=true,e=this;e.composer.selection.executeAndRestore(function(){c.quirks.cleanPastedHTML(e.composer.element);e.parse(e.composer.element)},d)});this.observe("paste:textarea",function(){var d=this.textarea.getValue(),e;e=this.parse(d);this.textarea.setValue(e)})}})})(wysihtml5);!function(f,h){var d={"font-styles":function(k,l){var m=(l&&l.size)?" btn-"+l.size:"";return"<li class='dropdown'><a class='btn dropdown-toggle"+m+"' data-toggle='dropdown' href='#'><i class='icon-font'></i>&nbsp;<span class='current-font'>"+k.font_styles.normal+"</span>&nbsp;<b class='caret'></b></a><ul class='dropdown-menu'><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='div' tabindex='-1'>"+k.font_styles.normal+"</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h1' tabindex='-1'>"+k.font_styles.h1+"</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h2' tabindex='-1'>"+k.font_styles.h2+"</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h3' tabindex='-1'>"+k.font_styles.h3+"</a></li></ul></li>"},emphasis:function(k,l){var m=(l&&l.size)?" btn-"+l.size:"";return"<li><div class='btn-group'><a class='btn"+m+"' data-wysihtml5-command='bold' title='CTRL+B' tabindex='-1'>"+k.emphasis.bold+"</a><a class='btn"+m+"' data-wysihtml5-command='italic' title='CTRL+I' tabindex='-1'>"+k.emphasis.italic+"</a><a class='btn"+m+"' data-wysihtml5-command='underline' title='CTRL+U' tabindex='-1'>"+k.emphasis.underline+"</a></div></li>"},lists:function(k,l){var m=(l&&l.size)?" btn-"+l.size:"";return"<li><div class='btn-group'><a class='btn"+m+"' data-wysihtml5-command='insertUnorderedList' title='"+k.lists.unordered+"' tabindex='-1'><i class='icon-list'></i></a><a class='btn"+m+"' data-wysihtml5-command='insertOrderedList' title='"+k.lists.ordered+"' tabindex='-1'><i class='icon-th-list'></i></a><a class='btn"+m+"' data-wysihtml5-command='Outdent' title='"+k.lists.outdent+"' tabindex='-1'><i class='icon-indent-right'></i></a><a class='btn"+m+"' data-wysihtml5-command='Indent' title='"+k.lists.indent+"' tabindex='-1'><i class='icon-indent-left'></i></a></div></li>"},link:function(k,l){var m=(l&&l.size)?" btn-"+l.size:"";return"<li><div class='bootstrap-wysihtml5-insert-link-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>"+k.link.insert+"</h3></div><div class='modal-body'><input value='http://' class='bootstrap-wysihtml5-insert-link-url input-xlarge'></div><div class='modal-footer'><a href='#' class='btn' data-dismiss='modal'>"+k.link.cancel+"</a><a href='#' class='btn btn-primary' data-dismiss='modal'>"+k.link.insert+"</a></div></div><a class='btn"+m+"' data-wysihtml5-command='createLink' title='"+k.link.insert+"' tabindex='-1'><i class='icon-share'></i></a></li>"},image:function(k,l){var m=(l&&l.size)?" btn-"+l.size:"";return"<li><div class='bootstrap-wysihtml5-insert-image-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>"+k.image.insert+"</h3></div><div class='modal-body'><input value='http://' class='bootstrap-wysihtml5-insert-image-url input-xlarge'></div><div class='modal-footer'><a href='#' class='btn' data-dismiss='modal'>"+k.image.cancel+"</a><a href='#' class='btn btn-primary' data-dismiss='modal'>"+k.image.insert+"</a></div></div><a class='btn"+m+"' data-wysihtml5-command='insertImage' title='"+k.image.insert+"' tabindex='-1'><i class='icon-picture'></i></a></li>"},html:function(k,l){var m=(l&&l.size)?" btn-"+l.size:"";return"<li><div class='btn-group'><a class='btn"+m+"' data-wysihtml5-action='change_view' title='"+k.html.edit+"' tabindex='-1'><i class='icon-pencil'></i></a></div></li>"},color:function(k,l){var m=(l&&l.size)?" btn-"+l.size:"";return"<li class='dropdown'><a class='btn dropdown-toggle"+m+"' data-toggle='dropdown' href='#' tabindex='-1'><span class='current-color'>"+k.colours.black+"</span>&nbsp;<b class='caret'></b></a><ul class='dropdown-menu'><li><div class='wysihtml5-colors' data-wysihtml5-command-value='black'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='black'>"+k.colours.black+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='silver'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='silver'>"+k.colours.silver+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='gray'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='gray'>"+k.colours.gray+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='maroon'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='maroon'>"+k.colours.maroon+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='red'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='red'>"+k.colours.red+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='purple'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='purple'>"+k.colours.purple+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='green'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='green'>"+k.colours.green+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='olive'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='olive'>"+k.colours.olive+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='navy'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='navy'>"+k.colours.navy+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='blue'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='blue'>"+k.colours.blue+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='orange'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='orange'>"+k.colours.orange+"</a></li></ul></li>"}};var e=function(m,k,l){return d[m](k,l)};var g=function(m,k){this.el=m;var n=k||b;for(var l in n.customTemplates){d[l]=n.customTemplates[l]}this.toolbar=this.createToolbar(m,n);this.editor=this.createEditor(k);window.editor=this.editor;f("iframe.wysihtml5-sandbox").each(function(o,p){f(p.contentWindow).off("focus.wysihtml5").on({"focus.wysihtml5":function(){f("li.dropdown").removeClass("open")}})})};g.prototype={constructor:g,createEditor:function(l){l=l||{};l=f.extend(true,{},l);l.toolbar=this.toolbar[0];var m=new h.Editor(this.el[0],l);if(l&&l.events){for(var k in l.events){m.on(k,l.events[k])}}return m},createToolbar:function(o,m){var l=this;var p=f("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"});var k=m.locale||b.locale||"en";for(var n in b){var q=false;if(m[n]!==undefined){if(m[n]===true){q=true}}else{q=b[n]}if(q===true){p.append(e(n,a[k],m));if(n==="html"){this.initHtml(p)}if(n==="link"){this.initInsertLink(p)}if(n==="image"){this.initInsertImage(p)}}}if(m.toolbar){for(n in m.toolbar){p.append(m.toolbar[n])}}p.find("a[data-wysihtml5-command='formatBlock']").click(function(t){var s=t.target||t.srcElement;var r=f(s);l.toolbar.find(".current-font").text(r.html())});p.find("a[data-wysihtml5-command='foreColor']").click(function(t){var s=t.target||t.srcElement;var r=f(s);l.toolbar.find(".current-color").text(r.html())});this.el.before(p);return p},initHtml:function(k){var l="a[data-wysihtml5-action='change_view']";k.find(l).click(function(m){k.find("a.btn").not(l).toggleClass("disabled")})},initInsertImage:function(r){var m=this;var q=r.find(".bootstrap-wysihtml5-insert-image-modal");var o=q.find(".bootstrap-wysihtml5-insert-image-url");var l=q.find("a.btn-primary");var k=o.val();var n;var p=function(){var s=o.val();o.val(k);m.editor.currentView.element.focus();if(n){m.editor.composer.selection.setBookmark(n);n=null}m.editor.composer.commands.exec("insertImage",s)};o.keypress(function(s){if(s.which==13){p();q.modal("hide")}});l.click(p);q.on("shown",function(){o.focus()});q.on("hide",function(){m.editor.currentView.element.focus()});r.find("a[data-wysihtml5-command=insertImage]").click(function(){var s=f(this).hasClass("wysihtml5-command-active");if(!s){m.editor.currentView.element.focus(false);n=m.editor.composer.selection.getBookmark();q.appendTo("body").modal("show");q.on("click.dismiss.modal",'[data-dismiss="modal"]',function(t){t.stopPropagation()});return false}else{return true}})},initInsertLink:function(p){var s=this;var l=p.find(".bootstrap-wysihtml5-insert-link-modal");var n=l.find(".bootstrap-wysihtml5-insert-link-url");var m=l.find("a.btn-primary");var r=n.val();var k;var q=function(){var t=n.val();n.val(r);s.editor.currentView.element.focus();if(k){s.editor.composer.selection.setBookmark(k);k=null}s.editor.composer.commands.exec("createLink",{href:t,target:"_blank",rel:"nofollow"})};var o=false;n.keypress(function(t){if(t.which==13){q();l.modal("hide")}});m.click(q);l.on("shown",function(){n.focus()});l.on("hide",function(){s.editor.currentView.element.focus()});p.find("a[data-wysihtml5-command=createLink]").click(function(){var t=f(this).hasClass("wysihtml5-command-active");if(!t){s.editor.currentView.element.focus(false);k=s.editor.composer.selection.getBookmark();l.appendTo("body").modal("show");l.on("click.dismiss.modal",'[data-dismiss="modal"]',function(u){u.stopPropagation()});return false}else{return true}})}};var c={resetDefaults:function(){f.fn.wysihtml5.defaultOptions=f.extend(true,{},f.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(k){return this.each(function(){var l=f(this);l.data("wysihtml5",new g(l,k))})},shallowExtend:function(k){var l=f.extend({},f.fn.wysihtml5.defaultOptions,k||{});var m=this;return c.bypassDefaults.apply(m,[l])},deepExtend:function(k){var l=f.extend(true,{},f.fn.wysihtml5.defaultOptions,k||{});var m=this;return c.bypassDefaults.apply(m,[l])},init:function(k){var l=this;return c.shallowExtend.apply(l,[k])}};f.fn.wysihtml5=function(k){if(c[k]){return c[k].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof k==="object"||!k){return c.init.apply(this,arguments)}else{f.error("Method "+k+" does not exist on jQuery.wysihtml5")}}};f.fn.wysihtml5.Constructor=g;var b=f.fn.wysihtml5.defaultOptions={"font-styles":true,color:false,emphasis:true,lists:true,html:false,link:true,image:true,events:{},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{set_attributes:{target:"_blank",rel:"nofollow"},check_attributes:{href:"url"}},span:1,div:1,code:1,pre:1}},stylesheets:["./lib/css/wysiwyg-color.css"],locale:"en"};if(typeof f.fn.wysihtml5.defaultOptionsCache==="undefined"){f.fn.wysihtml5.defaultOptionsCache=f.extend(true,{},f.fn.wysihtml5.defaultOptions)}var a=f.fn.wysihtml5.locale={en:{font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}}(window.jQuery,window.wysihtml5);var delayClock=500;var delayRefresh=15000;var delayPower=20000;var alertTimeout=null;$("#messageModal input").keypress(function(a){if(a.which==13){$("#btnSendMessage").click()}});$("#btnSendMessage").click(function(a){a.preventDefault();if($("#btnSendMessage").attr("disabled")!="disabled"){$("#btnSendMessage").attr("disabled","disabled").addClass("disable");$.ajax({type:"POST",url:pathname+"/plugin/message",data:{message:$("#the_message").val()},success:function(b){setTimeout(function(){$("#btnToggleClock i").toggleClass("active");$("#btnSendMessage").removeAttr("disabled")},1000);$("#messageModal").modal("hide");$("#btnSendMessage").removeAttr("disabled").removeClass("disable")}})}});$("#btnToggleClock").click(function(a){a.preventDefault();if($("#btnToggleClock").attr("disabled")!="disabled"){$("#btnToggleClock").attr("disabled","disabled").addClass("disable");$.ajax({type:"POST",url:pathname+"/plugin/clock",data:{action:(($("#btnToggleClock i").hasClass("active"))?"off":"on")},success:function(b){setTimeout(function(){$("#btnToggleClock i").toggleClass("active");$("#btnToggleClock").removeAttr("disabled")},delayClock)}})}});$("#btnToggleScreen").click(function(a){a.preventDefault();if($("#btnToggleScreen").attr("disabled")!="disabled"){$("#btnToggleScreen").attr("disabled","disabled").addClass("disable");showAlert(lang.screen_message_power,delayPower);$.ajax({type:"POST",url:pathname+"/plugin/screen_power",data:{action:(($("#btnToggleScreen i").hasClass("active"))?"off":"on")},success:function(b){setTimeout(function(){$("#btnToggleScreen i").toggleClass("active").removeClass("icon-eye-close").removeClass("icon-eye-open");var c="close";if($("#btnToggleScreen i").hasClass("active")){c="open"}$("#btnToggleScreen i").addClass("icon-eye-"+c);$("#btnToggleScreen").removeAttr("disabled");if($("#btnToggleScreen i").hasClass("active")){$(".screen").removeClass("disabled")}else{$(".screen").addClass("disabled")}},delayPower)}})}});$("#btnRefreshScreen").click(function(a){a.preventDefault();if($("#btnRefreshScreen").attr("disabled")!="disabled"){$("#btnRefreshScreen").attr("disabled","disabled").addClass("disable");showAlert(lang.screen_message_refresh,delayPower);$.ajax({type:"POST",url:pathname+"/plugin/screen_reload",success:function(b){setTimeout(function(){$("#btnRefreshScreen").removeAttr("disabled")},delayRefresh)}})}});function showAlert(b,a){if(alertTimeout){clearTimeout(alertTimeout)}$(".alert-message").html("<i class='icon-info-sign'></i>&nbsp;&nbsp;&nbsp;"+b);$(".alert-message").css("display","block").slideDown(0).fadeIn(300);alertTimeout=setTimeout(function(){$(".alert-message").fadeTo(500,0).slideUp(500,function(){$(this).remove()})},a)}var pathname=window.location.pathname;String.prototype.camelcase=function(){return this.replace(/(\w)(\w*)/g,function(c,b,a){return b.toUpperCase()+a.toLowerCase()})};if($("#inputColor")[0]){$("#inputColor").spectrum({showInput:true})}$("input.better-file-upload").change(function(){$("input.file-value",$(this).next()).val($(this).val())});$(".file-value").on("click",function(){$(this).parent().prev("input.better-file-upload").click()});$(".file-button").on("click",function(){$(this).parent().prev("input.better-file-upload").click()});$(".niceselect").selectpicker();$("#inputFooterMessage").hide();$("#inputFooterUpdates").hide();$("#footerType").on("change",function(){$(".footer-line").removeClass("single");$("#inputFooterMessage").hide();$("#inputFooterUpdates").hide();$("#inputFooter"+$(this).val().charAt(0).toUpperCase()+$(this).val().slice(1)).show();if($(this).val()=="none"){$(".footer-line").addClass("single")}});$(".shown").show();$(document).ready(function(){$(".wysihtml5").wysihtml5({"font-styles":true,emphasis:true,lists:true,html:false,link:false,image:false,color:false})});$(".infoscreens .more").on("click",function(b){b.preventDefault();var a=$(".infoscreens.inactive");if(a.hasClass("hide")){a.removeClass("hide");$("span",this).html(lang.term_less)}else{a.addClass("hide");$("span",this).html(lang.term_more)}});$(".navbar .search-query").bind("input",function(){var b=$(this).val().trim().toLowerCase();var e=$(".infoscreens");var c=$(".infoscreens.inactive");if(c.hasClass("hide")){c.removeClass("hide").addClass("washidden")}$(".search-message",e).html(lang.warn_no_screens_found).show();$(".more",e).hide();if(b.length>0){var d=new RegExp(".*"+b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+".*");$(".screen-link",e).hide();var a=false;$(".screen-link",e).filter(function(){var f=$(this).data("title").match(d);if(f){a=true}return f}).show();if(a){$(".search-message",e).html(lang.term_searching_for+": <strong>"+b+"</strong>")}}else{$(".search-message",e).hide();$(".screen-link",e).show();$(".more",e).show();if(c.hasClass("washidden")){c.removeClass("washidden");c.addClass("hide")}}});function getNormalizedUrl(){var b=pathname;var a=pathname.split("right");if(a.length>1){b=a[0]}else{a=pathname.split("left");b=a[0]}return b}if($("*[data-intro]").length>0){$("#help").removeClass("hide")}$("#help").on("click",function(a){a.preventDefault();introJs().start()});$(window).resize(function(){introJs().exit()});